

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NSphere Core (nsphere.c) &mdash; NSphere  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="NSphere Sort (nsphere_sort.h)" href="nsphere_sort.html" />
    <link rel="prev" title="C API Reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NSphere
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../command_line/index.html">Command-Line Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_flow/index.html">Data and Results Flow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_flow/index.html#output-file-reference">Output File Reference</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">C API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">NSphere Core (nsphere.c)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.CLEAN_EXIT"><code class="docutils literal notranslate"><span class="pre">CLEAN_EXIT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CLEAN_LOCAL_EXIT"><code class="docutils literal notranslate"><span class="pre">CLEAN_LOCAL_EXIT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.cube"><code class="docutils literal notranslate"><span class="pre">cube</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CUTOFF_FACTOR_CORED_DEFAULT"><code class="docutils literal notranslate"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CUTOFF_FACTOR_NFW_DEFAULT"><code class="docutils literal notranslate"><span class="pre">CUTOFF_FACTOR_NFW_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.DEBUG_MAX_STEPS"><code class="docutils literal notranslate"><span class="pre">DEBUG_MAX_STEPS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.DEBUG_PARTICLE_ID"><code class="docutils literal notranslate"><span class="pre">DEBUG_PARTICLE_ID</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.FALLOFF_FACTOR_NFW_DEFAULT"><code class="docutils literal notranslate"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.G_CONST"><code class="docutils literal notranslate"><span class="pre">G_CONST</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HALO_MASS"><code class="docutils literal notranslate"><span class="pre">HALO_MASS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HALO_MASS_NFW"><code class="docutils literal notranslate"><span class="pre">HALO_MASS_NFW</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HIST_NBINS"><code class="docutils literal notranslate"><span class="pre">HIST_NBINS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_ALL_PART"><code class="docutils literal notranslate"><span class="pre">IF_ALL_PART</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DEBUG"><code class="docutils literal notranslate"><span class="pre">IF_DEBUG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DYNPSI"><code class="docutils literal notranslate"><span class="pre">IF_DYNPSI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DYNRANK"><code class="docutils literal notranslate"><span class="pre">IF_DYNRANK</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.imin"><code class="docutils literal notranslate"><span class="pre">imin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.kmsec_to_kpcmyr"><code class="docutils literal notranslate"><span class="pre">kmsec_to_kpcmyr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.MYBINIO_H"><code class="docutils literal notranslate"><span class="pre">MYBINIO_H</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.NUM_MINI_SUBSTEPS_BOOTSTRAP"><code class="docutils literal notranslate"><span class="pre">NUM_MINI_SUBSTEPS_BOOTSTRAP</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PI"><code class="docutils literal notranslate"><span class="pre">PI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RADIX_BITS"><code class="docutils literal notranslate"><span class="pre">RADIX_BITS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RADIX_MASK"><code class="docutils literal notranslate"><span class="pre">RADIX_MASK</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RADIX_SIZE"><code class="docutils literal notranslate"><span class="pre">RADIX_SIZE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RC"><code class="docutils literal notranslate"><span class="pre">RC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RC_NFW_DEFAULT"><code class="docutils literal notranslate"><span class="pre">RC_NFW_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.sqr"><code class="docutils literal notranslate"><span class="pre">sqr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.VEL_CONV_SQ"><code class="docutils literal notranslate"><span class="pre">VEL_CONV_SQ</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413drhodr_func_t"><code class="docutils literal notranslate"><span class="pre">drhodr_func_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417drhodr_nfw_func_t"><code class="docutils literal notranslate"><span class="pre">drhodr_nfw_func_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420potential_function_t"><code class="docutils literal notranslate"><span class="pre">potential_function_t</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429add_snapshot_to_double_bufferPPdPdPii"><code class="docutils literal notranslate"><span class="pre">add_snapshot_to_double_buffer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417adjust_ntimestepsiii"><code class="docutils literal notranslate"><span class="pre">adjust_ntimesteps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433allocate_double_precision_buffersi"><code class="docutils literal notranslate"><span class="pre">allocate_double_precision_buffers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427allocate_trajectory_buffersiiii"><code class="docutils literal notranslate"><span class="pre">allocate_trajectory_buffers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf"><code class="docutils literal notranslate"><span class="pre">append_all_particle_data_chunk_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv431append_all_particle_ids_to_filePKciiPi"><code class="docutils literal notranslate"><span class="pre">append_all_particle_ids_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv442append_all_particle_phi_data_chunk_to_filePKciiPf"><code class="docutils literal notranslate"><span class="pre">append_all_particle_phi_data_chunk_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv442append_all_particle_scatter_counts_to_filePKciiPi"><code class="docutils literal notranslate"><span class="pre">append_all_particle_scatter_counts_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425calculate_system_energiesPPdidPdPd"><code class="docutils literal notranslate"><span class="pre">calculate_system_energies()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426check_and_warn_negative_fQPP10gsl_interpPP16gsl_interp_accelPdPdPiPKcPKci"><code class="docutils literal notranslate"><span class="pre">check_and_warn_negative_fQ()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425check_strict_monotonicityPKdiPKc"><code class="docutils literal notranslate"><span class="pre">check_strict_monotonicity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425cleanup_all_particle_datav"><code class="docutils literal notranslate"><span class="pre">cleanup_all_particle_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426cleanup_trajectory_buffersii"><code class="docutils literal notranslate"><span class="pre">cleanup_trajectory_buffers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47cmp_LAIPKvPKv"><code class="docutils literal notranslate"><span class="pre">cmp_LAI()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429compare_pair_by_first_elementPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_pair_by_first_element()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423compare_partdata_by_radPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_partdata_by_rad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417compare_particlesPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423cored_potential_wrapperdPv"><code class="docutils literal notranslate"><span class="pre">cored_potential_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv434correct_negative_fE_and_rebuild_IEPdPiPdPdiPKc"><code class="docutils literal notranslate"><span class="pre">correct_negative_fE_and_rebuild_IE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418create_backup_filePKc"><code class="docutils literal notranslate"><span class="pre">create_backup_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412crossproduct11threevector11threevector"><code class="docutils literal notranslate"><span class="pre">crossproduct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427density_derivative_om_coredd"><code class="docutils literal notranslate"><span class="pre">density_derivative_om_cored()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425density_derivative_om_nfwdddd"><code class="docutils literal notranslate"><span class="pre">density_derivative_om_nfw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417density_hernquistddd"><code class="docutils literal notranslate"><span class="pre">density_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418df_hernquist_anisodddd"><code class="docutils literal notranslate"><span class="pre">df_hernquist_aniso()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427direct_gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418doAdaptiveFullLeapiiddddddidiPdPd"><code class="docutils literal notranslate"><span class="pre">doAdaptiveFullLeap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd"><code class="docutils literal notranslate"><span class="pre">doAdaptiveFullLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420doLeviCivitaLeapfrogiiddddidPdPd"><code class="docutils literal notranslate"><span class="pre">doLeviCivitaLeapfrog()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415doMicroLeapfrogiiddddiidPdPd"><code class="docutils literal notranslate"><span class="pre">doMicroLeapfrog()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417doMicroLeviCivitaiidddidddPdPdPd"><code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd"><code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410dotproduct11threevector11threevector"><code class="docutils literal notranslate"><span class="pre">dotproduct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410double_cmpPKvPKv"><code class="docutils literal notranslate"><span class="pre">double_cmp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46drhodrd"><code class="docutils literal notranslate"><span class="pre">drhodr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416drhodr_hernquistddd"><code class="docutils literal notranslate"><span class="pre">drhodr_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419drhodr_om_hernquistddd"><code class="docutils literal notranslate"><span class="pre">drhodr_om_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424drhodr_profile_nfwcutoffdddd"><code class="docutils literal notranslate"><span class="pre">drhodr_profile_nfwcutoff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411dRhoDtaufundd"><code class="docutils literal notranslate"><span class="pre">dRhoDtaufun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423effective_angular_forcedd"><code class="docutils literal notranslate"><span class="pre">effective_angular_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429effective_angular_force_rho_vdd"><code class="docutils literal notranslate"><span class="pre">effective_angular_force_rho_v()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412errorAndExitPKcPKcPKc"><code class="docutils literal notranslate"><span class="pre">errorAndExit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld"><code class="docutils literal notranslate"><span class="pre">evaluatespline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428evaluatespline_with_boundaryP10gsl_splineP16gsl_interp_accelddddd"><code class="docutils literal notranslate"><span class="pre">evaluatespline_with_boundary()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411fEintegranddPv"><code class="docutils literal notranslate"><span class="pre">fEintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421fEintegrand_hernquistdPv"><code class="docutils literal notranslate"><span class="pre">fEintegrand_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415fEintegrand_nfwdPv"><code class="docutils literal notranslate"><span class="pre">fEintegrand_nfw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424fft_gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428finalize_debug_energy_outputv"><code class="docutils literal notranslate"><span class="pre">finalize_debug_energy_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427finalize_energy_diagnosticsi"><code class="docutils literal notranslate"><span class="pre">finalize_energy_diagnostics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv434find_last_common_complete_snapshotiiiiPKc"><code class="docutils literal notranslate"><span class="pre">find_last_common_complete_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428find_last_processed_snapshotPii"><code class="docutils literal notranslate"><span class="pre">find_last_processed_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426find_minimum_useful_radiusPFddPvEPvdd"><code class="docutils literal notranslate"><span class="pre">find_minimum_useful_radius()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427flush_double_buffer_to_diskPKc"><code class="docutils literal notranslate"><span class="pre">flush_double_buffer_to_disk()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424flush_trajectory_buffersiii"><code class="docutils literal notranslate"><span class="pre">flush_trajectory_buffers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410forceLCfuniidddd"><code class="docutils literal notranslate"><span class="pre">forceLCfun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416format_file_sizelPc6size_t"><code class="docutils literal notranslate"><span class="pre">format_file_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411fprintf_binP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fprintf_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415fprintf_bin_dblP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fprintf_bin_dbl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410fscanf_binP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fscanf_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414fscanf_bin_dblP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fscanf_bin_dbl()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv434generate_ics_hernquist_anisotropicPPdiP7gsl_rngddPP10gsl_splinePP16gsl_interp_accelPP10gsl_splinePP16gsl_interp_accelPP10gsl_splinePP16gsl_interp_accelPP10gsl_interpPP16gsl_interp_accelPPdPPdPPdPPdPii"><code class="docutils literal notranslate"><span class="pre">generate_ics_hernquist_anisotropic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424get_available_disk_spacePKc"><code class="docutils literal notranslate"><span class="pre">get_available_disk_space()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420get_sort_descriptionPKc"><code class="docutils literal notranslate"><span class="pre">get_sort_description()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421get_suffixed_filenamePKciPc6size_t"><code class="docutils literal notranslate"><span class="pre">get_suffixed_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419gravitational_forcediidd"><code class="docutils literal notranslate"><span class="pre">gravitational_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425gravitational_force_rho_vdiidd"><code class="docutils literal notranslate"><span class="pre">gravitational_force_rho_v()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416handle_sidm_stepPPdidddiiPi"><code class="docutils literal notranslate"><span class="pre">handle_sidm_step()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427hernquist_potential_wrapperdPv"><code class="docutils literal notranslate"><span class="pre">hernquist_potential_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415hyperg_2F1_safedd"><code class="docutils literal notranslate"><span class="pre">hyperg_2F1_safe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423insertion_parallel_sortPPdi"><code class="docutils literal notranslate"><span class="pre">insertion_parallel_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414insertion_sortPPdi"><code class="docutils literal notranslate"><span class="pre">insertion_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418insertion_sort_subPPdii"><code class="docutils literal notranslate"><span class="pre">insertion_sort_sub()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47isFloatPKc"><code class="docutils literal notranslate"><span class="pre">isFloat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49isIntegerPKc"><code class="docutils literal notranslate"><span class="pre">isInteger()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421load_chosen_particlesPKcPPiPiPPiPi"><code class="docutils literal notranslate"><span class="pre">load_chosen_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv432load_existing_energy_diagnosticsPKci"><code class="docutils literal notranslate"><span class="pre">load_existing_energy_diagnostics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423load_from_double_bufferPKciiPPdiPi"><code class="docutils literal notranslate"><span class="pre">load_from_double_buffer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427load_particles_from_restartPKciPPdiiPi"><code class="docutils literal notranslate"><span class="pre">load_particles_from_restart()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411log_messagePKcPKcz"><code class="docutils literal notranslate"><span class="pre">log_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416make_threevectorddd"><code class="docutils literal notranslate"><span class="pre">make_threevector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424mass_integrand_hernquistdPv"><code class="docutils literal notranslate"><span class="pre">mass_integrand_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413massintegranddPv"><code class="docutils literal notranslate"><span class="pre">massintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423massintegrand_hernquistdPv"><code class="docutils literal notranslate"><span class="pre">massintegrand_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv431massintegrand_profile_nfwcutoffdPv"><code class="docutils literal notranslate"><span class="pre">massintegrand_profile_nfwcutoff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421nfw_potential_wrapperdPv"><code class="docutils literal notranslate"><span class="pre">nfw_potential_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415om_mu_integranddPv"><code class="docutils literal notranslate"><span class="pre">om_mu_integrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419parallel_radix_sortPPdi"><code class="docutils literal notranslate"><span class="pre">parallel_radix_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422parse_nsphere_filenamePKcPiPiPd"><code class="docutils literal notranslate"><span class="pre">parse_nsphere_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413parseSaveArgsiA_PcPi"><code class="docutils literal notranslate"><span class="pre">parseSaveArgs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422perform_scatter_updatePPdiiP7gsl_rng"><code class="docutils literal notranslate"><span class="pre">perform_scatter_update()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv443perform_sidm_scattering_parallel_graphcolorPPdiddPP7gsl_rngiPxddPi"><code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_parallel_graphcolor()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430perform_sidm_scattering_serialPPdiddP7gsl_rngPxddPi"><code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_serial()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419potential_hernquistddd"><code class="docutils literal notranslate"><span class="pre">potential_hernquist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410printUsagePKc"><code class="docutils literal notranslate"><span class="pre">printUsage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413prompt_yes_noPKc"><code class="docutils literal notranslate"><span class="pre">prompt_yes_no()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412PsiintegranddPv"><code class="docutils literal notranslate"><span class="pre">Psiintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422quadsort_parallel_sortPPdi"><code class="docutils literal notranslate"><span class="pre">quadsort_parallel_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416quadsort_wrapperPPdi"><code class="docutils literal notranslate"><span class="pre">quadsort_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423read_initial_conditionsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">read_initial_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427reassign_orig_ids_with_rankPdi"><code class="docutils literal notranslate"><span class="pre">reassign_orig_ids_with_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv434retrieve_all_particle_phi_snapshotPKciiiPf"><code class="docutils literal notranslate"><span class="pre">retrieve_all_particle_phi_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf"><code class="docutils literal notranslate"><span class="pre">retrieve_all_particle_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421save_chosen_particlesPKcPiiPii"><code class="docutils literal notranslate"><span class="pre">save_chosen_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410sigmatotaldidd"><code class="docutils literal notranslate"><span class="pre">sigmatotal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411sort_by_radP8PartDatai"><code class="docutils literal notranslate"><span class="pre">sort_by_rad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414sort_particlesPPdi"><code class="docutils literal notranslate"><span class="pre">sort_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423sort_particles_with_algPPdiPKc"><code class="docutils literal notranslate"><span class="pre">sort_particles_with_alg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418sort_rr_psi_arraysPdPdi"><code class="docutils literal notranslate"><span class="pre">sort_rr_psi_arrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420stdlib_qsort_wrapperPPdi"><code class="docutils literal notranslate"><span class="pre">stdlib_qsort_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419store_debug_approxEidd"><code class="docutils literal notranslate"><span class="pre">store_debug_approxE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427store_debug_dynE_componentsiddddd"><code class="docutils literal notranslate"><span class="pre">store_debug_dynE_components()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426truncate_files_to_snapshotiiiiiPKc"><code class="docutils literal notranslate"><span class="pre">truncate_files_to_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419verify_sort_resultsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">verify_sort_results()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424write_initial_conditionsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">write_initial_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46chosen"><code class="docutils literal notranslate"><span class="pre">chosen</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411dbg_approxE"><code class="docutils literal notranslate"><span class="pre">dbg_approxE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49dbg_count"><code class="docutils literal notranslate"><span class="pre">dbg_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_dynE"><code class="docutils literal notranslate"><span class="pre">dbg_dynE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_kinE"><code class="docutils literal notranslate"><span class="pre">dbg_kinE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_potE"><code class="docutils literal notranslate"><span class="pre">dbg_potE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410dbg_radius"><code class="docutils literal notranslate"><span class="pre">dbg_radius</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_time"><code class="docutils literal notranslate"><span class="pre">dbg_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424debug_direct_convolution"><code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410doReadInit"><code class="docutils literal notranslate"><span class="pre">doReadInit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411doWriteInit"><code class="docutils literal notranslate"><span class="pre">doWriteInit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_active_halo_mass"><code class="docutils literal notranslate"><span class="pre">g_active_halo_mass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_anisotropy_beta"><code class="docutils literal notranslate"><span class="pre">g_anisotropy_beta</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_anisotropy_beta_provided"><code class="docutils literal notranslate"><span class="pre">g_anisotropy_beta_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_attempt_load_seeds"><code class="docutils literal notranslate"><span class="pre">g_attempt_load_seeds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_benchmark_count"><code class="docutils literal notranslate"><span class="pre">g_benchmark_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_cored_profile_halo_mass"><code class="docutils literal notranslate"><span class="pre">g_cored_profile_halo_mass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_cored_profile_rc"><code class="docutils literal notranslate"><span class="pre">g_cored_profile_rc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427g_cored_profile_rmax_factor"><code class="docutils literal notranslate"><span class="pre">g_cored_profile_rmax_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419g_current_best_sort"><code class="docutils literal notranslate"><span class="pre">g_current_best_sort</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433g_current_timestep_scatter_counts"><code class="docutils literal notranslate"><span class="pre">g_current_timestep_scatter_counts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_cutoff_factor_param"><code class="docutils literal notranslate"><span class="pre">g_cutoff_factor_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430g_cutoff_factor_param_provided"><code class="docutils literal notranslate"><span class="pre">g_cutoff_factor_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415g_dbl_buf_count"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_dbl_buf_current_slot"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_current_slot</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_dbl_buf_L"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_L</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414g_dbl_buf_npts"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_npts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_dbl_buf_phi"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_phi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_dbl_buf_R"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_R</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414g_dbl_buf_Rank"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_Rank</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414g_dbl_buf_Vrad"><code class="docutils literal notranslate"><span class="pre">g_dbl_buf_Vrad</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_default_max_threads"><code class="docutils literal notranslate"><span class="pre">g_default_max_threads</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_defaultSortAlg"><code class="docutils literal notranslate"><span class="pre">g_defaultSortAlg</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_density_derivative_func"><code class="docutils literal notranslate"><span class="pre">g_density_derivative_func</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429g_density_derivative_nfw_func"><code class="docutils literal notranslate"><span class="pre">g_density_derivative_nfw_func</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419g_doAllParticleData"><code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49g_doDebug"><code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410g_doDynPsi"><code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_doDynRank"><code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_doRestart"><code class="docutils literal notranslate"><span class="pre">g_doRestart</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_doRestartForce"><code class="docutils literal notranslate"><span class="pre">g_doRestartForce</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_doSimExtend"><code class="docutils literal notranslate"><span class="pre">g_doSimExtend</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414g_doSimRestart"><code class="docutils literal notranslate"><span class="pre">g_doSimRestart</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423g_doSimRestartCheckOnly"><code class="docutils literal notranslate"><span class="pre">g_doSimRestartCheckOnly</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47g_E_buf"><code class="docutils literal notranslate"><span class="pre">g_E_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_E_init_vals"><code class="docutils literal notranslate"><span class="pre">g_E_init_vals</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_enable_logging"><code class="docutils literal notranslate"><span class="pre">g_enable_logging</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424g_enable_sidm_scattering"><code class="docutils literal notranslate"><span class="pre">g_enable_sidm_scattering</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_energy_file"><code class="docutils literal notranslate"><span class="pre">g_energy_file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_energy_snapshots_loaded"><code class="docutils literal notranslate"><span class="pre">g_energy_snapshots_loaded</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_extend_file_source"><code class="docutils literal notranslate"><span class="pre">g_extend_file_source</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_falloff_factor_param"><code class="docutils literal notranslate"><span class="pre">g_falloff_factor_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv431g_falloff_factor_param_provided"><code class="docutils literal notranslate"><span class="pre">g_falloff_factor_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_file_suffix"><code class="docutils literal notranslate"><span class="pre">g_file_suffix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_halo_mass_param"><code class="docutils literal notranslate"><span class="pre">g_halo_mass_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_halo_mass_param_provided"><code class="docutils literal notranslate"><span class="pre">g_halo_mass_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_hybrid_p_cores"><code class="docutils literal notranslate"><span class="pre">g_hybrid_p_cores</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419g_initial_cond_seed"><code class="docutils literal notranslate"><span class="pre">g_initial_cond_seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433g_initial_cond_seed_filename_base"><code class="docutils literal notranslate"><span class="pre">g_initial_cond_seed_filename_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428g_initial_cond_seed_provided"><code class="docutils literal notranslate"><span class="pre">g_initial_cond_seed_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_insertion_wins"><code class="docutils literal notranslate"><span class="pre">g_insertion_wins</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47g_L_buf"><code class="docutils literal notranslate"><span class="pre">g_L_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_L_init_vals"><code class="docutils literal notranslate"><span class="pre">g_L_init_vals</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_l_target_value"><code class="docutils literal notranslate"><span class="pre">g_l_target_value</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415g_lowestL_E_buf"><code class="docutils literal notranslate"><span class="pre">g_lowestL_E_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414g_lowestL_file"><code class="docutils literal notranslate"><span class="pre">g_lowestL_file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415g_lowestL_L_buf"><code class="docutils literal notranslate"><span class="pre">g_lowestL_L_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415g_lowestL_r_buf"><code class="docutils literal notranslate"><span class="pre">g_lowestL_r_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_master_seed"><code class="docutils literal notranslate"><span class="pre">g_master_seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_master_seed_provided"><code class="docutils literal notranslate"><span class="pre">g_master_seed_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_max_omp_threads_for_rng"><code class="docutils literal notranslate"><span class="pre">g_max_omp_threads_for_rng</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48g_mu_buf"><code class="docutils literal notranslate"><span class="pre">g_mu_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428g_nfw_profile_falloff_factor"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_falloff_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423g_nfw_profile_halo_mass"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_halo_mass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_nfw_profile_rc"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_rc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430g_nfw_profile_rmax_norm_factor"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_rmax_norm_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_om_aniso_factor_provided"><code class="docutils literal notranslate"><span class="pre">g_om_aniso_factor_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_om_anisotropy_radius"><code class="docutils literal notranslate"><span class="pre">g_om_anisotropy_radius</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_om_ra_scale_factor"><code class="docutils literal notranslate"><span class="pre">g_om_ra_scale_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424g_particle_scatter_state"><code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_profile_type_str"><code class="docutils literal notranslate"><span class="pre">g_profile_type_str</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427g_profile_type_str_provided"><code class="docutils literal notranslate"><span class="pre">g_profile_type_str_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415g_quadsort_wins"><code class="docutils literal notranslate"><span class="pre">g_quadsort_wins</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412g_radix_wins"><code class="docutils literal notranslate"><span class="pre">g_radix_wins</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423g_restart_file_override"><code class="docutils literal notranslate"><span class="pre">g_restart_file_override</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_restart_initial_timestep"><code class="docutils literal notranslate"><span class="pre">g_restart_initial_timestep</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_restart_mode_active"><code class="docutils literal notranslate"><span class="pre">g_restart_mode_active</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428g_restart_snapshots_is_count"><code class="docutils literal notranslate"><span class="pre">g_restart_snapshots_is_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv45g_rng"><code class="docutils literal notranslate"><span class="pre">g_rng</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_rng_per_thread"><code class="docutils literal notranslate"><span class="pre">g_rng_per_thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_scale_radius_param"><code class="docutils literal notranslate"><span class="pre">g_scale_radius_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429g_scale_radius_param_provided"><code class="docutils literal notranslate"><span class="pre">g_scale_radius_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_sidm_execution_mode"><code class="docutils literal notranslate"><span class="pre">g_sidm_execution_mode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412g_sidm_kappa"><code class="docutils literal notranslate"><span class="pre">g_sidm_kappa</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_sidm_kappa_provided"><code class="docutils literal notranslate"><span class="pre">g_sidm_kappa_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428g_sidm_max_interaction_range"><code class="docutils literal notranslate"><span class="pre">g_sidm_max_interaction_range</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_sidm_seed"><code class="docutils literal notranslate"><span class="pre">g_sidm_seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_sidm_seed_filename_base"><code class="docutils literal notranslate"><span class="pre">g_sidm_seed_filename_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_sidm_seed_provided"><code class="docutils literal notranslate"><span class="pre">g_sidm_seed_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_single_traj_file"><code class="docutils literal notranslate"><span class="pre">g_single_traj_file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_sort_call_count"><code class="docutils literal notranslate"><span class="pre">g_sort_call_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_sort_columns_buffer"><code class="docutils literal notranslate"><span class="pre">g_sort_columns_buffer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_sort_columns_buffer_npts"><code class="docutils literal notranslate"><span class="pre">g_sort_columns_buffer_npts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410g_time_buf"><code class="docutils literal notranslate"><span class="pre">g_time_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_time_snapshots"><code class="docutils literal notranslate"><span class="pre">g_time_snapshots</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49g_total_E"><code class="docutils literal notranslate"><span class="pre">g_total_E</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_total_insertion_time"><code class="docutils literal notranslate"><span class="pre">g_total_insertion_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410g_total_KE"><code class="docutils literal notranslate"><span class="pre">g_total_KE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410g_total_PE"><code class="docutils literal notranslate"><span class="pre">g_total_PE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_total_quadsort_time"><code class="docutils literal notranslate"><span class="pre">g_total_quadsort_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_total_radix_time"><code class="docutils literal notranslate"><span class="pre">g_total_radix_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_total_sidm_scatters"><code class="docutils literal notranslate"><span class="pre">g_total_sidm_scatters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_traj_file"><code class="docutils literal notranslate"><span class="pre">g_traj_file</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_trajectories_buf"><code class="docutils literal notranslate"><span class="pre">g_trajectories_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_trajectory_buffer_index"><code class="docutils literal notranslate"><span class="pre">g_trajectory_buffer_index</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424g_trajectory_buffer_size"><code class="docutils literal notranslate"><span class="pre">g_trajectory_buffer_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_use_graph_coloring_sidm"><code class="docutils literal notranslate"><span class="pre">g_use_graph_coloring_sidm</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429g_use_hernquist_aniso_profile"><code class="docutils literal notranslate"><span class="pre">g_use_hernquist_aniso_profile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_use_hernquist_numerical"><code class="docutils literal notranslate"><span class="pre">g_use_hernquist_numerical</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_use_nfw_profile"><code class="docutils literal notranslate"><span class="pre">g_use_nfw_profile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_use_numerical_isotropic"><code class="docutils literal notranslate"><span class="pre">g_use_numerical_isotropic</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_use_om_profile"><code class="docutils literal notranslate"><span class="pre">g_use_om_profile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_velocities_buf"><code class="docutils literal notranslate"><span class="pre">g_velocities_buf</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48ID_block"><code class="docutils literal notranslate"><span class="pre">ID_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47L_block"><code class="docutils literal notranslate"><span class="pre">L_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48Lcompare"><code class="docutils literal notranslate"><span class="pre">Lcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47nlowest"><code class="docutils literal notranslate"><span class="pre">nlowest</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413normalization"><code class="docutils literal notranslate"><span class="pre">normalization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418num_traj_particles"><code class="docutils literal notranslate"><span class="pre">num_traj_particles</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430PARALLEL_SORT_DEFAULT_SECTIONS"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_DEFAULT_SECTIONS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv438PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv437PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429PARALLEL_SORT_OVERLAP_DIVISOR"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_OVERLAP_DIVISOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433PARALLEL_SORT_SECTIONS_PER_THREAD"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_SECTIONS_PER_THREAD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49phi_block"><code class="docutils literal notranslate"><span class="pre">phi_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47R_block"><code class="docutils literal notranslate"><span class="pre">R_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410Rank_block"><code class="docutils literal notranslate"><span class="pre">Rank_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416readInitFilename"><code class="docutils literal notranslate"><span class="pre">readInitFilename</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419scatter_count_block"><code class="docutils literal notranslate"><span class="pre">scatter_count_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416skip_file_writes"><code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423use_closest_to_Lcompare"><code class="docutils literal notranslate"><span class="pre">use_closest_to_Lcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420use_identity_gravity"><code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410Vrad_block"><code class="docutils literal notranslate"><span class="pre">Vrad_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417writeInitFilename"><code class="docutils literal notranslate"><span class="pre">writeInitFilename</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422cored_potential_params"><code class="docutils literal notranslate"><span class="pre">cored_potential_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N22cored_potential_params1ME"><code class="docutils literal notranslate"><span class="pre">M</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N22cored_potential_params2rcE"><code class="docutils literal notranslate"><span class="pre">rc</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv431fE_integrand_params_hernquist_t"><code class="docutils literal notranslate"><span class="pre">fE_integrand_params_hernquist_t</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t12accel_M_of_rE"><code class="docutils literal notranslate"><span class="pre">accel_M_of_r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t14accel_r_of_PsiE"><code class="docutils literal notranslate"><span class="pre">accel_r_of_Psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t17const_G_universalE"><code class="docutils literal notranslate"><span class="pre">const_G_universal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t15E_current_shellE"><code class="docutils literal notranslate"><span class="pre">E_current_shell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t17hernquist_a_scaleE"><code class="docutils literal notranslate"><span class="pre">hernquist_a_scale</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t23hernquist_normalizationE"><code class="docutils literal notranslate"><span class="pre">hernquist_normalization</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t13Psimax_globalE"><code class="docutils literal notranslate"><span class="pre">Psimax_global</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t13Psimin_globalE"><code class="docutils literal notranslate"><span class="pre">Psimin_global</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t13spline_M_of_rE"><code class="docutils literal notranslate"><span class="pre">spline_M_of_r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t15spline_r_of_PsiE"><code class="docutils literal notranslate"><span class="pre">spline_r_of_Psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N31fE_integrand_params_hernquist_t6use_omE"><code class="docutils literal notranslate"><span class="pre">use_om</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425fE_integrand_params_NFW_t"><code class="docutils literal notranslate"><span class="pre">fE_integrand_params_NFW_t</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t12accel_M_of_rE"><code class="docutils literal notranslate"><span class="pre">accel_M_of_r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t14accel_r_of_PsiE"><code class="docutils literal notranslate"><span class="pre">accel_r_of_Psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t17const_G_universalE"><code class="docutils literal notranslate"><span class="pre">const_G_universal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t15E_current_shellE"><code class="docutils literal notranslate"><span class="pre">E_current_shell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t23profile_falloff_C_constE"><code class="docutils literal notranslate"><span class="pre">profile_falloff_C_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t21profile_nt_norm_constE"><code class="docutils literal notranslate"><span class="pre">profile_nt_norm_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t16profile_rc_constE"><code class="docutils literal notranslate"><span class="pre">profile_rc_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimax_globalE"><code class="docutils literal notranslate"><span class="pre">Psimax_global</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimin_globalE"><code class="docutils literal notranslate"><span class="pre">Psimin_global</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t13spline_M_of_rE"><code class="docutils literal notranslate"><span class="pre">spline_M_of_r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t15spline_r_of_PsiE"><code class="docutils literal notranslate"><span class="pre">spline_r_of_Psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t6use_omE"><code class="docutils literal notranslate"><span class="pre">use_om</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418fEintegrand_params"><code class="docutils literal notranslate"><span class="pre">fEintegrand_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params1EE"><code class="docutils literal notranslate"><span class="pre">E</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params9massarrayE"><code class="docutils literal notranslate"><span class="pre">massarray</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params11rofPsiarrayE"><code class="docutils literal notranslate"><span class="pre">rofPsiarray</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params10splinemassE"><code class="docutils literal notranslate"><span class="pre">splinemass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params9splinePsiE"><code class="docutils literal notranslate"><span class="pre">splinePsi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params6use_omE"><code class="docutils literal notranslate"><span class="pre">use_om</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416hernquist_params"><code class="docutils literal notranslate"><span class="pre">hernquist_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N16hernquist_params1aE"><code class="docutils literal notranslate"><span class="pre">a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N16hernquist_params1ME"><code class="docutils literal notranslate"><span class="pre">M</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426hernquist_potential_params"><code class="docutils literal notranslate"><span class="pre">hernquist_potential_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N26hernquist_potential_params1aE"><code class="docutils literal notranslate"><span class="pre">a</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N26hernquist_potential_params1ME"><code class="docutils literal notranslate"><span class="pre">M</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49LAndIndex"><code class="docutils literal notranslate"><span class="pre">LAndIndex</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex3idxE"><code class="docutils literal notranslate"><span class="pre">idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex1LE"><code class="docutils literal notranslate"><span class="pre">L</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex4signE"><code class="docutils literal notranslate"><span class="pre">sign</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420nfw_potential_params"><code class="docutils literal notranslate"><span class="pre">nfw_potential_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N20nfw_potential_params7falloffE"><code class="docutils literal notranslate"><span class="pre">falloff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N20nfw_potential_params1ME"><code class="docutils literal notranslate"><span class="pre">M</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N20nfw_potential_params13normalizationE"><code class="docutils literal notranslate"><span class="pre">normalization</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N20nfw_potential_params4Phi0E"><code class="docutils literal notranslate"><span class="pre">Phi0</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N20nfw_potential_params2rsE"><code class="docutils literal notranslate"><span class="pre">rs</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421om_mu_integral_params"><code class="docutils literal notranslate"><span class="pre">om_mu_integral_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params10fofQ_accelE"><code class="docutils literal notranslate"><span class="pre">fofQ_accel</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params11fofQ_interpE"><code class="docutils literal notranslate"><span class="pre">fofQ_interp</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params7I_arrayE"><code class="docutils literal notranslate"><span class="pre">I_array</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params12Psi_rf_codesE"><code class="docutils literal notranslate"><span class="pre">Psi_rf_codes</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params6PsimaxE"><code class="docutils literal notranslate"><span class="pre">Psimax</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params6PsiminE"><code class="docutils literal notranslate"><span class="pre">Psimin</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params7Q_arrayE"><code class="docutils literal notranslate"><span class="pre">Q_array</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params12r_over_ra_sqE"><code class="docutils literal notranslate"><span class="pre">r_over_ra_sq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N21om_mu_integral_params4v_sqE"><code class="docutils literal notranslate"><span class="pre">v_sq</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48PartData"><code class="docutils literal notranslate"><span class="pre">PartData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData6angmomE"><code class="docutils literal notranslate"><span class="pre">angmom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData14original_indexE"><code class="docutils literal notranslate"><span class="pre">original_index</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData3radE"><code class="docutils literal notranslate"><span class="pre">rad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData4rankE"><code class="docutils literal notranslate"><span class="pre">rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData4vradE"><code class="docutils literal notranslate"><span class="pre">vrad</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419Psiintegrand_params"><code class="docutils literal notranslate"><span class="pre">Psiintegrand_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N19Psiintegrand_params18massintegrand_funcE"><code class="docutils literal notranslate"><span class="pre">massintegrand_func</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N19Psiintegrand_params24params_for_massintegrandE"><code class="docutils literal notranslate"><span class="pre">params_for_massintegrand</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49RrPsiPair"><code class="docutils literal notranslate"><span class="pre">RrPsiPair</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9RrPsiPair3psiE"><code class="docutils literal notranslate"><span class="pre">psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9RrPsiPair2rrE"><code class="docutils literal notranslate"><span class="pre">rr</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411threevector"><code class="docutils literal notranslate"><span class="pre">threevector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11threevector1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11threevector1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11threevector1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nsphere_sort.html">NSphere Sort (nsphere_sort.h)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quadsort.html">QuadSort (<cite>quadsort.c</cite> / <cite>quadsort.h</cite>)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../python_api/index.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NSphere</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">C API Reference</a></li>
      <li class="breadcrumb-item active">NSphere Core (nsphere.c)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/c_api/nsphere_core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nsphere-core-nsphere-c">
<h1>NSphere Core (nsphere.c)<a class="headerlink" href="#nsphere-core-nsphere-c" title="Link to this heading"></a></h1>
<p>Complete API for the main NSphere simulation engine.</p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CLEAN_EXIT">
<span class="target" id="nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"></span><span class="sig-name descname"><span class="n"><span class="pre">CLEAN_EXIT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CLEAN_EXIT" title="Link to this definition"></a><br /></dt>
<dd><p>Thread-safe exit macro that properly cleans up allocated resources. </p>
<p>This macro ensures proper resource cleanup before program termination:<ul class="simple">
<li><p>Uses an OpenMP critical section to ensure only one thread performs cleanup.</p></li>
<li><p>Calls <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref"><span class="pre">cleanup_all_particle_data()</span></span></a></code> to free dynamically allocated memory.</p></li>
<li><p>Exits with the specified error code.</p></li>
</ul>
</p>
<p><dl>
<dt><strong>Example</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">error_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CLEAN_EXIT</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> -- The exit code for the program.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CLEAN_LOCAL_EXIT">
<span class="target" id="nsphere_8c_1ab44d6b36e8f42f8d0abbb57735dae501"></span><span class="sig-name descname"><span class="n"><span class="pre">CLEAN_LOCAL_EXIT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CLEAN_LOCAL_EXIT" title="Link to this definition"></a><br /></dt>
<dd><p>Non-thread-safe exit macro for cleanup and termination. </p>
<p>Performs resource cleanup and exits in single-threaded contexts. This macro calls <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref"><span class="pre">cleanup_all_particle_data()</span></span></a></code> before exiting with the specified code.</p>
<p><dl>
<dt><strong>Example</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">error_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CLEAN_LOCAL_EXIT</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This macro is not thread-safe. Use it only in single-threaded sections of the code. For thread-safe exits, use <code class="docutils literal notranslate"><span class="pre">CLEAN_EXIT</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> -- The exit code for the program.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cube">
<span class="target" id="nsphere_8c_1a8368822f21884eec2e99ce31c08b0df4"></span><span class="sig-name descname"><span class="n"><span class="pre">cube</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cube" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the cube of a value: <span class="math notranslate nohighlight">\(x^3\)</span>. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CUTOFF_FACTOR_CORED_DEFAULT">
<span class="target" id="nsphere_8c_1a5d16973bb95b421ae8100c8a4b36a8c7"></span><span class="sig-name descname"><span class="n"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></span></span><a class="headerlink" href="#c.CUTOFF_FACTOR_CORED_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default <span class="math notranslate nohighlight">\(r_{\text{max}}\)</span> factor for Cored profile ( <span class="math notranslate nohighlight">\(r_{\text{max}} = \text{factor} \times r_c\)</span>). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CUTOFF_FACTOR_NFW_DEFAULT">
<span class="target" id="nsphere_8c_1a91dd721f8691889d511b2d2d233cf884"></span><span class="sig-name descname"><span class="n"><span class="pre">CUTOFF_FACTOR_NFW_DEFAULT</span></span></span><a class="headerlink" href="#c.CUTOFF_FACTOR_NFW_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default <span class="math notranslate nohighlight">\(r_{\text{max}}\)</span> factor for NFW profile ( <span class="math notranslate nohighlight">\(r_{\text{max}} = \text{factor} \times r_c\)</span>). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.DEBUG_MAX_STEPS">
<span class="target" id="nsphere_8c_1a85a9270015b4ab8087c007d98dd57808"></span><span class="sig-name descname"><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span></span><a class="headerlink" href="#c.DEBUG_MAX_STEPS" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum number of debug energy snapshots. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.DEBUG_PARTICLE_ID">
<span class="target" id="nsphere_8c_1ad93df23038c4de269c9c6b66dc4a3f56"></span><span class="sig-name descname"><span class="n"><span class="pre">DEBUG_PARTICLE_ID</span></span></span><a class="headerlink" href="#c.DEBUG_PARTICLE_ID" title="Link to this definition"></a><br /></dt>
<dd><p>Particle ID (by rank) to track for energy debugging. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.FALLOFF_FACTOR_NFW_DEFAULT">
<span class="target" id="nsphere_8c_1a1ff1990d20151562a3598b02763b07fe"></span><span class="sig-name descname"><span class="n"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></span></span><a class="headerlink" href="#c.FALLOFF_FACTOR_NFW_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default falloff concentration parameter <span class="math notranslate nohighlight">\(C\)</span> for NFW profile. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.G_CONST">
<span class="target" id="nsphere_8c_1ac4c50d2ec5229af74ea12911980e265a"></span><span class="sig-name descname"><span class="n"><span class="pre">G_CONST</span></span></span><a class="headerlink" href="#c.G_CONST" title="Link to this definition"></a><br /></dt>
<dd><p>Newton's gravitational constant in kpc (km/sec) <span class="math notranslate nohighlight">\(^2\)</span>/ <span class="math notranslate nohighlight">\(M_{\odot}\)</span>. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HALO_MASS">
<span class="target" id="nsphere_8c_1a6dfa358045ebb8fb55bbef34f5151786"></span><span class="sig-name descname"><span class="n"><span class="pre">HALO_MASS</span></span></span><a class="headerlink" href="#c.HALO_MASS" title="Link to this definition"></a><br /></dt>
<dd><p>Default general halo mass (used for Cored profile by default) in <span class="math notranslate nohighlight">\(M_{\odot}\)</span>. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HALO_MASS_NFW">
<span class="target" id="nsphere_8c_1ab5be2218953aa22f1eda20f8a065ffde"></span><span class="sig-name descname"><span class="n"><span class="pre">HALO_MASS_NFW</span></span></span><a class="headerlink" href="#c.HALO_MASS_NFW" title="Link to this definition"></a><br /></dt>
<dd><p>Default NFW profile halo mass in solar masses ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HIST_NBINS">
<span class="target" id="nsphere_8c_1aa192737d626c2dfbf13c1078f6ce701d"></span><span class="sig-name descname"><span class="n"><span class="pre">HIST_NBINS</span></span></span><a class="headerlink" href="#c.HIST_NBINS" title="Link to this definition"></a><br /></dt>
<dd><p>Number of bins for 2D phase-space histograms (400x400 resolution). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_ALL_PART">
<span class="target" id="nsphere_8c_1ac2a7d072f22c12400574ce6ecec1b2f3"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_ALL_PART</span></span></span><a class="headerlink" href="#c.IF_ALL_PART" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DEBUG">
<span class="target" id="nsphere_8c_1a084107b11a831e4b4bf3e83327b903b5"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DEBUG</span></span></span><a class="headerlink" href="#c.IF_DEBUG" title="Link to this definition"></a><br /></dt>
<dd><p>Conditional compilation macros for feature flags. </p>
<p>These macros provide a cleaner syntax for conditional code blocks that depend on the global feature flags.</p>
<p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DYNPSI">
<span class="target" id="nsphere_8c_1a293d1823eeb32494bd8d0dfb3152b004"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DYNPSI</span></span></span><a class="headerlink" href="#c.IF_DYNPSI" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DYNRANK">
<span class="target" id="nsphere_8c_1a30d555dd887fc6c09e9d6cbb9accc0e5"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DYNRANK</span></span></span><a class="headerlink" href="#c.IF_DYNRANK" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.imin">
<span class="target" id="nsphere_8c_1a9e512761aee37544a1f18ee854407b87"></span><span class="sig-name descname"><span class="n"><span class="pre">imin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.imin" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum of two integer values. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.kmsec_to_kpcmyr">
<span class="target" id="nsphere_8c_1a27bf9b96269ee7511a077c4c908a37c0"></span><span class="sig-name descname"><span class="n"><span class="pre">kmsec_to_kpcmyr</span></span></span><a class="headerlink" href="#c.kmsec_to_kpcmyr" title="Link to this definition"></a><br /></dt>
<dd><p>Conversion factor: km/s to kpc/Myr. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.MYBINIO_H">
<span class="target" id="nsphere_8c_1a8a7cdbd9f0c6050c69cf5edb33079101"></span><span class="sig-name descname"><span class="n"><span class="pre">MYBINIO_H</span></span></span><a class="headerlink" href="#c.MYBINIO_H" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.NUM_MINI_SUBSTEPS_BOOTSTRAP">
<span class="target" id="nsphere_8c_1aae2fd93ceb16ef535f7af25b5b7ffd7d"></span><span class="sig-name descname"><span class="n"><span class="pre">NUM_MINI_SUBSTEPS_BOOTSTRAP</span></span></span><a class="headerlink" href="#c.NUM_MINI_SUBSTEPS_BOOTSTRAP" title="Link to this definition"></a><br /></dt>
<dd><p>Number of mini Euler steps per bootstrap full step. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PI">
<span class="target" id="nsphere_8c_1a598a3330b3c21701223ee0ca14316eca"></span><span class="sig-name descname"><span class="n"><span class="pre">PI</span></span></span><a class="headerlink" href="#c.PI" title="Link to this definition"></a><br /></dt>
<dd><p>Mathematical constant <span class="math notranslate nohighlight">\(\pi\)</span>. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RADIX_BITS">
<span class="target" id="nsphere_8c_1a289a40b87ccdf363552d5f2deca8590d"></span><span class="sig-name descname"><span class="n"><span class="pre">RADIX_BITS</span></span></span><a class="headerlink" href="#c.RADIX_BITS" title="Link to this definition"></a><br /></dt>
<dd><p>Number of bits processed per radix sort pass (8 bits = 256 buckets). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RADIX_MASK">
<span class="target" id="nsphere_8c_1ae11a7683764608a8a7251f1168e3e520"></span><span class="sig-name descname"><span class="n"><span class="pre">RADIX_MASK</span></span></span><a class="headerlink" href="#c.RADIX_MASK" title="Link to this definition"></a><br /></dt>
<dd><p>Bit mask for extracting radix bucket index (0xFF). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RADIX_SIZE">
<span class="target" id="nsphere_8c_1a02b72b24e61256a4fde3bcc53a2d50eb"></span><span class="sig-name descname"><span class="n"><span class="pre">RADIX_SIZE</span></span></span><a class="headerlink" href="#c.RADIX_SIZE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of buckets for radix sort ( <span class="math notranslate nohighlight">\(2^8 = 256\)</span>). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RC">
<span class="target" id="nsphere_8c_1a9de40e06982123e40c3c92b5db6d7640"></span><span class="sig-name descname"><span class="n"><span class="pre">RC</span></span></span><a class="headerlink" href="#c.RC" title="Link to this definition"></a><br /></dt>
<dd><p>Core radius in kpc. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RC_NFW_DEFAULT">
<span class="target" id="nsphere_8c_1a5feffe4681c8f5d7e6096678b2d94b9d"></span><span class="sig-name descname"><span class="n"><span class="pre">RC_NFW_DEFAULT</span></span></span><a class="headerlink" href="#c.RC_NFW_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default NFW profile scale radius (kpc). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.sqr">
<span class="target" id="nsphere_8c_1adee8c6d2fc20a1194cf64c481e7b6353"></span><span class="sig-name descname"><span class="n"><span class="pre">sqr</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sqr" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the square of a value: <span class="math notranslate nohighlight">\(x^2\)</span>. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.VEL_CONV_SQ">
<span class="target" id="nsphere_8c_1ac95cb8dbb481dff84064cae250b647ef"></span><span class="sig-name descname"><span class="n"><span class="pre">VEL_CONV_SQ</span></span></span><a class="headerlink" href="#c.VEL_CONV_SQ" title="Link to this definition"></a><br /></dt>
<dd><p>Velocity conversion squared (kpc/Myr) <span class="math notranslate nohighlight">\(^2\)</span> per (km/s) <span class="math notranslate nohighlight">\(^2\)</span>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv413drhodr_func_t">
<span class="target" id="nsphere_8c_1a8c85c164dd46b8050813496a99e14dcd"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">drhodr_func_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv413drhodr_func_t" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer types for dynamic dispatch. </p>
<p>These types enable runtime selection of profile-specific implementations without conditional branching in performance-critical loops. Function pointer for density derivative: <span class="math notranslate nohighlight">\(d\rho/dr\)</span> (Cored/Hernquist profiles). </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv417drhodr_nfw_func_t">
<span class="target" id="nsphere_8c_1a4a0c39395add3c3df8b049d60d9e9c11"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">drhodr_nfw_func_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">rc</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">nt_nfw</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">falloff_C</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv417drhodr_nfw_func_t" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer for NFW density derivative: <span class="math notranslate nohighlight">\(d\rho/dr\)</span> with profile parameters. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv420potential_function_t">
<span class="target" id="nsphere_8c_1a90f25faf7c2044f98aa8ab4ae8ab5786"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">potential_function_t</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n"><span class="pre">r</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n"><span class="pre">params</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv420potential_function_t" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer for potential evaluation: <span class="math notranslate nohighlight">\(\Psi(r)\)</span>. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1a415c6d1c558074ad329697f2c01820fc"></span><span class="sig-name descname"><span class="pre">static</span> <span class="pre">int</span> <span class="pre">__attribute__</span> <span class="pre">((unused))</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429add_snapshot_to_double_bufferPPdPdPii">
<span class="target" id="nsphere_8c_1ae487730e5c8491525a6c6597e658e525"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add_snapshot_to_double_buffer</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">phi_array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rank_array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429add_snapshot_to_double_bufferPPdPdPii" title="Link to this definition"></a><br /></dt>
<dd><p>Adds the current snapshot to the double-precision circular buffer. </p>
<p>Copies particle state (R, Vrad, L, Rank, phi) from current simulation state into the circular buffer at the current slot position. Updates buffer slot position and count. Buffer grows from 0 to 4 snapshots, then maintains rolling last 4.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- Pointer to particle state arrays [R, Vrad, L, ...] </p></li>
<li><p><strong>phi_array</strong> -- Array of particle phi angles </p></li>
<li><p><strong>rank_array</strong> -- Array of particle ranks (sorted positions) </p></li>
<li><p><strong>npts</strong> -- Number of particles </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417adjust_ntimestepsiii">
<span class="target" id="nsphere_8c_1a42bd334c6038615033c8df68f17aed7b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">adjust_ntimesteps</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Ntimes_initial</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nout</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dtwrite</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417adjust_ntimestepsiii" title="Link to this definition"></a><br /></dt>
<dd><p>Adjusts the total number of timesteps to align with desired output snapshot intervals. </p>
<p>This function calculates an adjusted number of total simulation timesteps, <span class="math notranslate nohighlight">\(N'_{times}\)</span>, such that it is greater than or equal to the initially requested <code class="docutils literal notranslate"><span class="pre">Ntimes_initial</span></code> ( <span class="math notranslate nohighlight">\(N\)</span>) and satisfies the constraint: <span class="math notranslate nohighlight">\((N'_{times} - 1)\)</span> must be an integer multiple of <span class="math notranslate nohighlight">\((M - 1) \times p\)</span>. Here, <span class="math notranslate nohighlight">\(M\)</span> is <code class="docutils literal notranslate"><span class="pre">nout</span></code> (number of desired output snapshot points, which means <span class="math notranslate nohighlight">\(M-1\)</span> intervals) and <span class="math notranslate nohighlight">\(p\)</span> is <code class="docutils literal notranslate"><span class="pre">dtwrite</span></code> (the low-level write interval in terms of simulation timesteps). This alignment ensures that exactly <code class="docutils literal notranslate"><span class="pre">nout</span></code> snapshots can be produced at intervals that are multiples of <code class="docutils literal notranslate"><span class="pre">dtwrite</span></code> and that also evenly span the total adjusted simulation duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ntimes_initial</strong> -- [in] Initially requested total number of simulation timesteps ( <span class="math notranslate nohighlight">\(N\)</span>). </p></li>
<li><p><strong>nout</strong> -- [in] Number of desired output snapshot points ( <span class="math notranslate nohighlight">\(M\)</span>). Must be &gt;= 2 for adjustment to apply. </p></li>
<li><p><strong>dtwrite</strong> -- [in] The interval (in timesteps) at which low-level data is potentially written ( <span class="math notranslate nohighlight">\(p\)</span>). Must be &gt;= 1. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int The adjusted total number of timesteps ( <span class="math notranslate nohighlight">\(N'_{times}\)</span>). Returns <code class="docutils literal notranslate"><span class="pre">Ntimes_initial</span></code> if <code class="docutils literal notranslate"><span class="pre">nout</span> <span class="pre">&lt;</span> <span class="pre">2</span></code> or <code class="docutils literal notranslate"><span class="pre">dtwrite</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> or other edge cases where the constraint cannot be met. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433allocate_double_precision_buffersi">
<span class="target" id="nsphere_8c_1afe0c5cd6d9ed56b524a63c2492a16ab8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate_double_precision_buffers</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433allocate_double_precision_buffersi" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates memory for the double-precision snapshot buffer system. </p>
<p>Allocates circular buffers to store the last 4 snapshots in full double precision. This prevents precision loss during restart/extend operations by avoiding the doublefloat32double conversion inherent in the regular all_particle_data files.</p>
<p>Buffer grows incrementally: stores [0], then [0,1], then [0,1,2], then [0,1,2,3], then rolls to maintain the last 4 snapshots.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref">CLEAN_EXIT(1)</span></a> if allocation fails. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>npts</strong> -- Number of particles in the simulation.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427allocate_trajectory_buffersiiii">
<span class="target" id="nsphere_8c_1aac0472fe68759833e39ba0cb8dc8fa3f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate_trajectory_buffers</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_traj_particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlowest</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">buffer_size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427allocate_trajectory_buffersiiii" title="Link to this definition"></a><br /></dt>
<dd><p>Allocates memory for all trajectory buffering arrays. </p>
<p>This function is called once at the start of the simulation to allocate fixed-size buffers for storing trajectory data. The buffer size is determined by the snapshot writing schedule to ensure data is flushed to disk in synchronized blocks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_traj_particles</strong> -- The number of low-ID particles to track. </p></li>
<li><p><strong>nlowest</strong> -- The number of low-L particles to track. </p></li>
<li><p><strong>buffer_size</strong> -- The total number of timesteps the buffer can hold. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf">
<span class="target" id="nsphere_8c_1acf35e9a785fb4599bd9de42d4d36b58c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">append_all_particle_data_chunk_to_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">L_block</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Rank_block</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">R_block</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Vrad_block</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf" title="Link to this definition"></a><br /></dt>
<dd><p>Appends a block of full particle data to the specified output file. </p>
<p>This function writes a chunk of particle data, corresponding to <code class="docutils literal notranslate"><span class="pre">block_size</span></code> timesteps, to the given binary file. The data for each particle (rank, radius, radial velocity, angular momentum) is written sequentially for each timestep within the block (step-major order). This means all particle data for step <code class="docutils literal notranslate"><span class="pre">s</span></code> is contiguous, followed by all data for step <code class="docutils literal notranslate"><span class="pre">s+1</span></code>, etc., within the block. The file is opened in append binary mode (&quot;ab&quot;). This is used for creating the <code class="docutils literal notranslate"><span class="pre">all_particle_data.dat</span></code> file which stores the complete evolution history when <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is enabled.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref"><span class="pre">CLEAN_EXIT(1)</span></span></a></code> if the file cannot be opened for appending. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the output binary file (e.g., &quot;data/all_particle_data&lt;suffix&gt;.dat&quot;). </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of timesteps of data contained in the provided <code class="docutils literal notranslate"><span class="pre">_block</span></code> arrays. </p></li>
<li><p><strong>L_block</strong> -- [in] Pointer to the block of angular momentum data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
<li><p><strong>Rank_block</strong> -- [in] Pointer to the block of particle rank data (int array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
<li><p><strong>R_block</strong> -- [in] Pointer to the block of radial position data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
<li><p><strong>Vrad_block</strong> -- [in] Pointer to the block of radial velocity data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv431append_all_particle_ids_to_filePKciiPi">
<span class="target" id="nsphere_8c_1a5e134fe87febbf2e82fd89fe17047bdf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">append_all_particle_ids_to_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">id_block</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv431append_all_particle_ids_to_filePKciiPi" title="Link to this definition"></a><br /></dt>
<dd><p>Appends a block of particle IDs to the specified output file. </p>
<p>This function writes a chunk of particle ID data, corresponding to <code class="docutils literal notranslate"><span class="pre">block_size</span></code> timesteps, to the given binary file. The data is written in step-major order to match the structure of all_particle_data.dat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the output binary ID data file. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of timesteps of data contained in <code class="docutils literal notranslate"><span class="pre">id_block</span></code>. </p></li>
<li><p><strong>id_block</strong> -- [in] Pointer to the block of particle ID data (int array). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv442append_all_particle_phi_data_chunk_to_filePKciiPf">
<span class="target" id="nsphere_8c_1a7ec68d4e4368908fed5e56b949a7c34e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">append_all_particle_phi_data_chunk_to_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">phi_block</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv442append_all_particle_phi_data_chunk_to_filePKciiPf" title="Link to this definition"></a><br /></dt>
<dd><p>Appends a block of phi angle data to the specified output file. </p>
<p>This function writes a chunk of phi data, corresponding to <code class="docutils literal notranslate"><span class="pre">block_size</span></code> timesteps, to the given binary file. The data is written sequentially for each timestep within the block (step-major order). The file is opened in append binary mode (&quot;ab&quot;). This is used for creating the corresponding <code class="docutils literal notranslate"><span class="pre">all_particle_data_phi.dat</span></code> file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the output binary phi data file. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of timesteps of data contained in <code class="docutils literal notranslate"><span class="pre">phi_block</span></code>. </p></li>
<li><p><strong>phi_block</strong> -- [in] Pointer to the block of phi data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv442append_all_particle_scatter_counts_to_filePKciiPi">
<span class="target" id="nsphere_8c_1a175aedaca562358022992e799e6fa6da"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">append_all_particle_scatter_counts_to_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">scat_count_block</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv442append_all_particle_scatter_counts_to_filePKciiPi" title="Link to this definition"></a><br /></dt>
<dd><p>Appends a block of particle scatter counts to the specified output file. </p>
<p>This function writes a chunk of integer data, corresponding to <code class="docutils literal notranslate"><span class="pre">block_size</span></code> timesteps, to the given binary file. Each integer represents the number of times a particle scattered in a given timestep.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the output binary scatter count data file. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of timesteps of data contained in <code class="docutils literal notranslate"><span class="pre">scat_count_block</span></code>. </p></li>
<li><p><strong>scat_count_block</strong> -- [in] Pointer to the block of scatter count data (int array). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425calculate_system_energiesPPdidPdPd">
<span class="target" id="nsphere_8c_1a8ea14f56c5809f4e4f1b6d1381672f2f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">calculate_system_energies</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">deltaM</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">total_KE_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">total_PE_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425calculate_system_energiesPPdidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the total kinetic and potential energy of the N-body system. </p>
<p>This function iterates over all particles to compute the system's total kinetic energy (KE) and potential energy (PE) at a specific snapshot in time. The <code class="docutils literal notranslate"><span class="pre">particles</span></code> array must be sorted by radius before calling this function to ensure the rank-based potential energy calculation is correct.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in] The main particle data array, sorted by radius. </p></li>
<li><p><strong>npts</strong> -- [in] The total number of particles in the simulation. </p></li>
<li><p><strong>deltaM</strong> -- [in] The mass of a single particle ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). </p></li>
<li><p><strong>total_KE_out</strong> -- [out] Pointer to store the calculated total kinetic energy. </p></li>
<li><p><strong>total_PE_out</strong> -- [out] Pointer to store the calculated total potential energy. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426check_and_warn_negative_fQPP10gsl_interpPP16gsl_interp_accelPdPdPiPKcPKci">
<span class="target" id="nsphere_8c_1a727a984554052ecd21ed53afbb7fb790"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_and_warn_negative_fQ</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_interp</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fofE_interp_ptr</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fofE_acc_ptr</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">E_array</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">I_array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">n_points_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">label</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">profile_name</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">verbose</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426check_and_warn_negative_fQPP10gsl_interpPP16gsl_interp_accelPdPdPiPKcPKci" title="Link to this definition"></a><br /></dt>
<dd><p>Checks for negative distribution function values and corrects minor artifacts. </p>
<p>Evaluates <span class="math notranslate nohighlight">\(f(E) = dI/dE\)</span> at each point in the original arrays. If negative <span class="math notranslate nohighlight">\(f(E)\)</span> values are found (where <span class="math notranslate nohighlight">\(I(E)\)</span> decreases):<ul class="simple">
<li><p>For &lt; 20 negative points: Removes them, rebuilds spline, warns (verbose mode only)</p></li>
<li><p>For <span class="math notranslate nohighlight">\(\geq 20\)</span> negative points: Prompts user to abort or continue (verbose mode only)</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fofE_interp_ptr</strong> -- Pointer to GSL interpolator (rebuilt if correction applied) </p></li>
<li><p><strong>fofE_acc_ptr</strong> -- Pointer to GSL accelerator (rebuilt if correction applied) </p></li>
<li><p><strong>E_array</strong> -- Array of energy values (modified in-place during correction) </p></li>
<li><p><strong>I_array</strong> -- Array of <span class="math notranslate nohighlight">\(I(E)\)</span> values (modified in-place during correction) </p></li>
<li><p><strong>n_points_ptr</strong> -- Pointer to number of points (updated during correction) </p></li>
<li><p><strong>label</strong> -- String label &quot;f(E)&quot; or &quot;f(Q)&quot; for display </p></li>
<li><p><strong>profile_name</strong> -- String name of profile (e.g., &quot;NFW&quot;, &quot;Cored&quot;) </p></li>
<li><p><strong>verbose</strong> -- If 1: show warnings/prompts. If 0: silent correction (diagnostic mode) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 to abort, 0 to continue </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425check_strict_monotonicityPKdiPKc">
<span class="target" id="nsphere_8c_1a6a7772eb5bcc88c4c20fca47220196ff"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_strict_monotonicity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">arr</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425check_strict_monotonicityPKdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Check if an array is strictly monotonically increasing. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> -- Array to check </p></li>
<li><p><strong>n</strong> -- Number of elements </p></li>
<li><p><strong>name</strong> -- Name of the array for debug messages </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if strictly monotonic, 0 otherwise </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425cleanup_all_particle_datav">
<span class="target" id="nsphere_8c_1a7aee25e5421122109daf373663e3735e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cleanup_all_particle_data</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425cleanup_all_particle_datav" title="Link to this definition"></a><br /></dt>
<dd><p>Frees all global arrays used for particle data processing. </p>
<p>Frees L_block, Rank_block, R_block, Vrad_block, and chosen. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426cleanup_trajectory_buffersii">
<span class="target" id="nsphere_8c_1a4ffec40ff84f3b8cfe883f4dc58a0096"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cleanup_trajectory_buffers</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_traj_particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlowest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426cleanup_trajectory_buffersii" title="Link to this definition"></a><br /></dt>
<dd><p>Frees all memory associated with the trajectory buffering system. </p>
<p>This function is called at the end of the simulation. It ensures any remaining data in the buffers is flushed, closes all open file handles, and deallocates all buffer memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_traj_particles</strong> -- Number of low-ID particles tracked. </p></li>
<li><p><strong>nlowest</strong> -- Number of low-L particles tracked. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47cmp_LAIPKvPKv">
<span class="target" id="nsphere_8c_1a131102931747b4519a71bdb613523776"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cmp_LAI</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47cmp_LAIPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structures by the <span class="math notranslate nohighlight">\(L\)</span> member. </p>
<p>Sorts <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structures in ascending order based on their 'L' (angular momentum or squared difference from a reference <span class="math notranslate nohighlight">\(L\)</span>) value. Used with qsort for ordering particles by their <span class="math notranslate nohighlight">\(L\)</span> values, typically for selecting particles with lowest <span class="math notranslate nohighlight">\(L\)</span> or <span class="math notranslate nohighlight">\(L\)</span> closest to a target.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- [in] Pointer to the first <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structure. </p></li>
<li><p><strong>b</strong> -- [in] Pointer to the second <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if a-&gt;L &lt; b-&gt;L, 1 if a-&gt;L &gt; b-&gt;L, 0 if equal. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429compare_pair_by_first_elementPKvPKv">
<span class="target" id="nsphere_8c_1afca3673ea941820b38fa2f3e4290caa6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_pair_by_first_element</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429compare_pair_by_first_elementPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for qsort to sort <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structures by the 'rr' member. </p>
<p>Used to sort an array of <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structures in ascending order based on their radial (<code class="docutils literal notranslate"><span class="pre">rr</span></code>) component. This is primarily used when preparing data for splines where the x-axis (e.g., radius or -Psi) must be strictly monotonic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- Pointer to the first <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structure. </p></li>
<li><p><strong>b</strong> -- Pointer to the second <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if pa-&gt;rr &lt; pb-&gt;rr, 1 if pa-&gt;rr &gt; pb-&gt;rr, 0 otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423compare_partdata_by_radPKvPKv">
<span class="target" id="nsphere_8c_1a894769c574fe85ecef41c7741e2a1a55"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_partdata_by_rad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423compare_partdata_by_radPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for qsort to sort <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures by radius. </p>
<p>Compares two <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures based on their <code class="docutils literal notranslate"><span class="pre">rad</span></code> (radius) member for sorting in ascending order. Handles NaN values by placing them consistently at the beginning (NaN values sorted first).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- Pointer to the first <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structure. </p></li>
<li><p><strong>b</strong> -- Pointer to the second <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if pa-&gt;rad &lt; pb-&gt;rad, 1 if pa-&gt;rad &gt; pb-&gt;rad, 0 otherwise. Specific return for NaNs ensures consistent ordering. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417compare_particlesPKvPKv">
<span class="target" id="nsphere_8c_1af2ff6db0e6e59733fd0fbc5470849b68"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_particles</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417compare_particlesPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Compares two particle entries for sorting based on the first column value. </p>
<p>Used as a comparison function for qsort, quadsort, and other sorting algorithms. Particles with smaller values in column 0 will be sorted before those with larger values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Particle data structure: <code class="docutils literal notranslate"><span class="pre">columns[particle_index][component_index]</span></code>. Comparison based on <code class="docutils literal notranslate"><span class="pre">columns[i][0]</span></code> (radial position). </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- Pointer to the first particle entry (as void pointer, expected double**). </p></li>
<li><p><strong>b</strong> -- Pointer to the second particle entry (as void pointer, expected double**). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>-1 if a&lt;b, 1 if a&gt;b, 0 if equal based on the first column value (radius).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423cored_potential_wrapperdPv">
<span class="target" id="nsphere_8c_1a82cfae817090b307b22d7ba78e0fcc83"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cored_potential_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423cored_potential_wrapperdPv" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper function for Cored Plummer-like potential calculation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- Radius (kpc). </p></li>
<li><p><strong>params</strong> -- Void pointer to <a class="reference internal" href="#structcored__potential__params"><span class="std std-ref">cored_potential_params</span></a> struct. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Potential value at radius <em>r</em>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv434correct_negative_fE_and_rebuild_IEPdPiPdPdiPKc">
<span class="target" id="nsphere_8c_1a788dd91bb4f25e21a56a93c7db159b7b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">correct_negative_fE_and_rebuild_IE</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fE_values</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">is_negative</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">E_array</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">I_array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_points</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">label</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434correct_negative_fE_and_rebuild_IEPdPiPdPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Corrects negative <span class="math notranslate nohighlight">\(f(E)\)</span> regions by linear interpolation and reconstructs <span class="math notranslate nohighlight">\(I(E)\)</span>. </p>
<p>Given <span class="math notranslate nohighlight">\(f(E)\)</span> values with some negative regions, linearly interpolates <span class="math notranslate nohighlight">\(f(E)\)</span> over consecutive negative ranges, then integrates to reconstruct <span class="math notranslate nohighlight">\(I(E)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fE_values</strong> -- Array of <span class="math notranslate nohighlight">\(f(E)\)</span> values (modified in-place) </p></li>
<li><p><strong>is_negative</strong> -- Array marking negative <span class="math notranslate nohighlight">\(f(E)\)</span> points (1 = negative, 0 = positive) </p></li>
<li><p><strong>E_array</strong> -- Array of energy values </p></li>
<li><p><strong>I_array</strong> -- Array to store reconstructed <span class="math notranslate nohighlight">\(I(E)\)</span> values (output) </p></li>
<li><p><strong>n_points</strong> -- Number of points </p></li>
<li><p><strong>label</strong> -- Label for logging (&quot;f(E)&quot; or &quot;f(Q)&quot;) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of ranges corrected </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418create_backup_filePKc">
<span class="target" id="nsphere_8c_1a6ea9ccb810fe77fc6442aa9c910c2136"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_backup_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">source_file</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418create_backup_filePKc" title="Link to this definition"></a><br /></dt>
<dd><p>Creates a backup of a file with a .backup extension. </p>
<p>Creates a byte-for-byte copy of the source file, preserving the <code class="docutils literal notranslate"><span class="pre">all_particle_data</span></code> file state before truncation during restart operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>source_file</strong> -- Path to the source file to back up. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns 0 on success, -1 on failure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412crossproduct11threevector11threevector">
<span class="target" id="nsphere_8c_1a36a6435a975f2de2667a3e78627d1459"></span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crossproduct</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">X</span></span>, <a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">Y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412crossproduct11threevector11threevector" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the vector cross product of two three-dimensional vectors. </p>
<p>Calculates <span class="math notranslate nohighlight">\(Z = X \times Y\)</span>, where <span class="math notranslate nohighlight">\(X = (X_x, X_y, X_z)\)</span> and <span class="math notranslate nohighlight">\(Y = (Y_x, Y_y, Y_z)\)</span>. The components of the resulting vector <span class="math notranslate nohighlight">\(Z\)</span> are determined by: <span class="math notranslate nohighlight">\(Z_x = X_y Y_z - X_z Y_y\)</span> <span class="math notranslate nohighlight">\(Z_y = X_z Y_x - X_x Y_z\)</span> <span class="math notranslate nohighlight">\(Z_z = X_x Y_y - X_y Y_x\)</span> This follows the standard right-hand rule for vector cross products.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> -- [in] The first threevector operand. </p></li>
<li><p><strong>Y</strong> -- [in] The second threevector operand. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>threevector The resulting vector <span class="math notranslate nohighlight">\(Z = X \times Y\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427density_derivative_om_coredd">
<span class="target" id="nsphere_8c_1a8ad97ae497aba2c60ba3ae37bfaf7339"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">density_derivative_om_cored</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427density_derivative_om_coredd" title="Link to this definition"></a><br /></dt>
<dd><p>Osipkov-Merritt augmented density functions for anisotropic models. </p>
<p>The OM model uses radially-varying anisotropy <span class="math notranslate nohighlight">\(\beta(r) = r^2/(r^2 + r_a^2)\)</span> implemented via augmented density <span class="math notranslate nohighlight">\(\rho_Q(r) = \rho(r)(1 + r^2/r_a^2)\)</span>. These functions compute derivatives of the augmented density for use in Eddington-like inversion to obtain the distribution function <span class="math notranslate nohighlight">\(f(Q)\)</span>.</p>
<p>Calculates <span class="math notranslate nohighlight">\(d\rho_Q/dr\)</span> for the Osipkov-Merritt Cored Plummer-like profile.</p>
<p>Computes the radial derivative of the OM augmented density <span class="math notranslate nohighlight">\(\rho_Q(r) = \rho(r)(1 + r^2/r_a^2)\)</span>. Uses the product rule: <span class="math notranslate nohighlight">\(d\rho_Q/dr = (d\rho/dr)(1+r^2/r_a^2) + \rho(r)(2r/r_a^2)\)</span>. This is used in the Eddington-like inversion to find <span class="math notranslate nohighlight">\(f(Q)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> -- [in] Radial coordinate (kpc). </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho_Q/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425density_derivative_om_nfwdddd">
<span class="target" id="nsphere_8c_1a294dfdb8a4d981b8b61f2be55326c8c3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">density_derivative_om_nfw</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_param</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nt_nfw_scaler</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">falloff_C_param</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425density_derivative_om_nfwdddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho_Q/dr\)</span> for the Osipkov-Merritt NFW-like profile. </p>
<p>Computes the radial derivative of the OM augmented density <span class="math notranslate nohighlight">\(\rho_Q(r) = \rho(r)(1 + r^2/r_a^2)\)</span>. Uses the product rule: <span class="math notranslate nohighlight">\(d\rho_Q/dr = (d\rho/dr)(1+r^2/r_a^2) + \rho(r)(2r/r_a^2)\)</span>. This is used in the Eddington-like inversion to find <span class="math notranslate nohighlight">\(f(Q)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate (kpc). </p></li>
<li><p><strong>rc_param</strong> -- [in] Scale radius <span class="math notranslate nohighlight">\(r_c\)</span> of the NFW-like profile (kpc). </p></li>
<li><p><strong>nt_nfw_scaler</strong> -- [in] Density normalization constant (nt_nfw) for the profile. </p></li>
<li><p><strong>falloff_C_param</strong> -- [in] Falloff transition factor C for the power-law cutoff. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho_Q/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417density_hernquistddd">
<span class="target" id="nsphere_8c_1af04cf3b36d554940bc9f96473c90747b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">density_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">M</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417density_hernquistddd" title="Link to this definition"></a><br /></dt>
<dd><p>Main entry point for the n-sphere dark matter simulation program. </p>
<p>Analytical density for the Hernquist profile.</p>
<p>Orchestrates the overall simulation workflow:<ol class="loweralpha simple">
<li><p>Parses command-line arguments.</p></li>
<li><p>Sets up global parameters and logging.</p></li>
<li><p>Initializes random number generators.</p></li>
<li><p>Generates or loads initial conditions (ICs) for NFW, Cored Plummer-like, or Hernquist profiles.<ul class="simple">
<li><p>Includes theoretical calculations for density, mass, potential, and <span class="math notranslate nohighlight">\(f(E)\)</span> splines.</p></li>
<li><p>Includes a diagnostic loop to test IC generation with varied numerical parameters.</p></li>
<li><p>Performs particle sampling based on the derived distribution function.</p></li>
</ul>
</p></li>
<li><p>Optionally performs tidal stripping and re-assigns particle IDs.</p></li>
<li><p>Converts particle velocities to physical simulation units.</p></li>
<li><p>Executes the main N-body timestepping loop using a selected integration method.<ul class="simple">
<li><p>Performs gravitational updates.</p></li>
<li><p>Optionally performs SIDM scattering via <code class="docutils literal notranslate"><span class="pre">handle_sidm_step</span></code>.</p></li>
<li><p>Tracks particle trajectories and energies.</p></li>
<li><p>Periodically writes simulation data and progress.</p></li>
</ul>
</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is enabled, processes all particle data to generate snapshot files for Rank/Mass/Radius/Velocity/Potential/Energy/Density.</p></li>
<li><p>Writes final summary plots and theoretical profiles.</p></li>
<li><p>Cleans up allocated resources. Handles restart/resume functionality by checking for existing data products.</p></li>
</ol>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This application supports OpenMP for parallelization in various sections. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Large particle counts or long simulations can be memory and CPU intensive. Disk space requirements for full data output can also be significant.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argc</strong> -- [in] Standard argument count from the command line. </p></li>
<li><p><strong>argv</strong> -- [in] Standard array of argument strings from the command line. </p></li>
<li><p><strong>r</strong> -- Radius (kpc). </p></li>
<li><p><strong>M</strong> -- Total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). </p></li>
<li><p><strong>a</strong> -- Scale radius <span class="math notranslate nohighlight">\(a\)</span> of the Hernquist profile (kpc). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int Exit code: 0 for successful execution, non-zero for errors.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Physical density ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span> / kpc <span class="math notranslate nohighlight">\(^3\)</span>). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418df_hernquist_anisodddd">
<span class="target" id="nsphere_8c_1a594a82cd5ab98813740bcc5f05f7e9f4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">df_hernquist_aniso</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_bind</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">L</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">M</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418df_hernquist_anisodddd" title="Link to this definition"></a><br /></dt>
<dd><p>Anisotropic distribution function for Hernquist profile with arbitrary beta. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>E_bind</strong> -- Binding energy, E_bind = -E_total (must be positive). Units are (kpc/Myr) <span class="math notranslate nohighlight">\(^2\)</span>. </p></li>
<li><p><strong>L</strong> -- Angular momentum magnitude (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
<li><p><strong>M</strong> -- Total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). </p></li>
<li><p><strong>a</strong> -- Scale radius <span class="math notranslate nohighlight">\(a\)</span> of the Hernquist profile (kpc). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the distribution function f(E, L). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427direct_gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">direct_gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427direct_gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Applies Gaussian smoothing using direct convolution. </p>
<p>Smooths a density field defined on a potentially non-uniform grid (<code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>) using direct spatial convolution with a Gaussian kernel of width <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code> (defined in log-space). For each point <code class="docutils literal notranslate"><span class="pre">i</span></code> in the output <code class="docutils literal notranslate"><span class="pre">result</span></code> array, it computes a weighted sum of the input <code class="docutils literal notranslate"><span class="pre">density_grid</span></code> values: <code class="docutils literal notranslate"><span class="pre">result[i]</span> <span class="pre">=</span> <span class="pre">sum(density_grid[j]</span> <span class="pre">*</span> <span class="pre">kernel(log_r_grid[i]</span> <span class="pre">-</span> <span class="pre">log_r_grid[j]))</span> <span class="pre">/</span> <span class="pre">sum(kernel(...))</span></code> where the <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is a Gaussian function <span class="math notranslate nohighlight">\(G(x) = (1/(\sigma\sqrt{2\pi})) \exp(-0.5(x/\sigma)^2)\)</span>, with <code class="docutils literal notranslate"><span class="pre">x</span></code> being the distance <code class="docutils literal notranslate"><span class="pre">log_r_grid[i]</span> <span class="pre">-</span> <span class="pre">log_r_grid[j]</span></code> and <span class="math notranslate nohighlight">\(\sigma\)</span> = <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code>. This method is generally more accurate than FFT-based convolution, especially for non-uniform grids or near boundaries, but has a higher computational cost ( <span class="math notranslate nohighlight">\(O(N^2)\)</span>) which makes it slower for large <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"><span class="std std-ref">fft_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resulting smoothed density is clamped to a minimum value of 1e-10. This function is inherently thread-safe as it only reads inputs and writes to distinct elements of the output array without shared intermediate state. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density_grid</strong> -- [in] Input density grid array (values corresponding to log_r_grid). </p></li>
<li><p><strong>grid_size</strong> -- [in] Number of points in the input grid and density arrays. </p></li>
<li><p><strong>log_r_grid</strong> -- [in] Array of logarithmic radial grid coordinates (log10(r)). Can be non-uniformly spaced. </p></li>
<li><p><strong>sigma_log</strong> -- [in] Width (standard deviation) of the Gaussian kernel in log10-space. </p></li>
<li><p><strong>result</strong> -- [out] Output array (pre-allocated, size grid_size) for the smoothed density field.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418doAdaptiveFullLeapiiddddddidiPdPd">
<span class="target" id="nsphere_8c_1aaeff56e8db1ae13e4536e2be4e53830e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doAdaptiveFullLeap</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418doAdaptiveFullLeapiiddddddidiPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs an adaptive full leapfrog step with error control over a physical timestep <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p>
<p>This function implements an adaptive leapfrog algorithm to advance a particle's state <span class="math notranslate nohighlight">\((r, v_{rad})\)</span> over a full physical timestep <code class="docutils literal notranslate"><span class="pre">h</span></code> ( <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span>). It iteratively refines the integration by comparing a &quot;coarse&quot; integration (using <span class="math notranslate nohighlight">\(2N+1\)</span> micro-steps via <code class="docutils literal notranslate"><span class="pre">doMicroLeapfrog</span></code>) with a &quot;fine&quot; integration (using <span class="math notranslate nohighlight">\(4N+1\)</span> micro-steps). The subdivision factor <span class="math notranslate nohighlight">\(N\)</span> starts at 1 and is doubled if the relative differences in final radius and velocity between coarse and fine passes exceed <code class="docutils literal notranslate"><span class="pre">radius_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity_tol</span></code>, respectively. This process repeats up to a maximum subdivision factor <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>. The final state <span class="math notranslate nohighlight">\((r_{out}, v_{out})\)</span> for the step <code class="docutils literal notranslate"><span class="pre">h</span></code> is chosen based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code> (coarse, fine, or Richardson extrapolation) once convergence is met or <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code> is reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in gravitational force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles in the simulation. </p></li>
<li><p><strong>r_in</strong> -- [in] Initial radial position (kpc) at the start of the step <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr), conserved. </p></li>
<li><p><strong>h</strong> -- [in] Full physical timestep size <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span> (Myr). </p></li>
<li><p><strong>radius_tol</strong> -- [in] Relative convergence tolerance for radius comparison. </p></li>
<li><p><strong>velocity_tol</strong> -- [in] Relative convergence tolerance for velocity comparison. </p></li>
<li><p><strong>max_subdiv</strong> -- [in] Maximum allowed subdivision factor <span class="math notranslate nohighlight">\(N\)</span> for micro-steps. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units, e.g., G_CONST). </p></li>
<li><p><strong>out_type</strong> -- [in] Result selection mode for converged integration: 0 for coarse result, 1 for fine result, 2 for Richardson extrapolation. </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the final radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd">
<span class="target" id="nsphere_8c_1a4d600bde20d7b1720839965824a8f800"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doAdaptiveFullLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N_taumin</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a full adaptive leapfrog step using Levi-Civita regularization over a physical time interval <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p>
<p>This function integrates a particle's motion over a physical timestep <code class="docutils literal notranslate"><span class="pre">dt</span></code> ( <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span>) by taking multiple adaptive steps in fictitious Levi-Civita time <span class="math notranslate nohighlight">\(\)</span>. It repeatedly calls <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> to advance the state in <span class="math notranslate nohighlight">\((, v_{rad}, t_{phys})\)</span> coordinates, where <span class="math notranslate nohighlight">\( = \sqrt{r}\)</span>. Each call to <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> takes an adaptive <span class="math notranslate nohighlight">\(\)</span> step. The loop continues until the accumulated physical time <code class="docutils literal notranslate"><span class="pre">t_cur</span></code> (from summing <span class="math notranslate nohighlight">\(t_{phys}\)</span> corresponding to each <span class="math notranslate nohighlight">\(\)</span>) reaches or exceeds the target <code class="docutils literal notranslate"><span class="pre">dt</span></code>. If a <span class="math notranslate nohighlight">\(\)</span> step overshoots <code class="docutils literal notranslate"><span class="pre">dt</span></code>, linear interpolation is used to find the state precisely at <code class="docutils literal notranslate"><span class="pre">t_cur</span> <span class="pre">=</span> <span class="pre">dt</span></code>. The final regularized state <span class="math notranslate nohighlight">\((_f, v_f)\)</span> is then transformed back to physical coordinates <span class="math notranslate nohighlight">\((r_{out}, v_{out})\)</span>. An initial guess for <span class="math notranslate nohighlight">\(\)</span> is made based on <code class="docutils literal notranslate"><span class="pre">N_taumin</span></code> and the initial radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), used for rank in gravitational force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles in the simulation. </p></li>
<li><p><strong>r_in</strong> -- [in] Initial physical radial position (kpc) at the start of the physical step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial physical radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr), conserved during integration. </p></li>
<li><p><strong>dt</strong> -- [in] The full physical timestep <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span> (Myr) to advance the particle. </p></li>
<li><p><strong>N_taumin</strong> -- [in] Target number of fictitious <span class="math notranslate nohighlight">\(\)</span>-steps within <code class="docutils literal notranslate"><span class="pre">dt</span></code>; influences the initial <span class="math notranslate nohighlight">\(\)</span> guess. </p></li>
<li><p><strong>radius_tol</strong> -- [in] Relative convergence tolerance for <span class="math notranslate nohighlight">\(\)</span> comparison within each adaptive <span class="math notranslate nohighlight">\(\)</span>-step. </p></li>
<li><p><strong>velocity_tol</strong> -- [in] Relative convergence tolerance for velocity comparison within each adaptive <span class="math notranslate nohighlight">\(\)</span>-step. </p></li>
<li><p><strong>max_subdiv</strong> -- [in] Maximum allowed subdivision factor N for micro-steps within each adaptive <span class="math notranslate nohighlight">\(\)</span>-step. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units, e.g., G_CONST). </p></li>
<li><p><strong>out_type</strong> -- [in] Result selection mode for micro-steps within <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code>: 0 for coarse, 1 for fine, 2 for Richardson extrapolation. </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the final physical radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final physical radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420doLeviCivitaLeapfrogiiddddidPdPd">
<span class="target" id="nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doLeviCivitaLeapfrog</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N_taumin</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420doLeviCivitaLeapfrogiiddddidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs integration of particle motion over a physical time <code class="docutils literal notranslate"><span class="pre">dt</span></code> using Levi-Civita regularization. </p>
<p>This function implements a leapfrog-like integration scheme in Levi-Civita regularized coordinates <span class="math notranslate nohighlight">\((, v_{rad})\)</span> and fictitious time <span class="math notranslate nohighlight">\(\)</span>. The physical coordinates are <span class="math notranslate nohighlight">\(r = ^2\)</span>, and physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> is related to <span class="math notranslate nohighlight">\(\)</span> by <span class="math notranslate nohighlight">\(dt_{phys} = ^2 d\)</span>. The integration proceeds by taking variable <span class="math notranslate nohighlight">\(\)</span> steps (estimated based on <code class="docutils literal notranslate"><span class="pre">N_taumin</span></code>) until the accumulated physical time <code class="docutils literal notranslate"><span class="pre">t_phys</span></code> reaches or exceeds the target physical timestep <code class="docutils literal notranslate"><span class="pre">dt</span></code>. If a step overshoots <code class="docutils literal notranslate"><span class="pre">dt</span></code>, linear interpolation is used to obtain the state precisely at the target physical time. This method is particularly effective for handling close encounters where <span class="math notranslate nohighlight">\(r  0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>r_in</strong> -- [in] Initial physical radial position (kpc) at the start of the physical step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial physical radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr) for the force calculation. </p></li>
<li><p><strong>dt</strong> -- [in] The full physical timestep <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span> (Myr) to advance the particle. </p></li>
<li><p><strong>N_taumin</strong> -- [in] Target number of fictitious <span class="math notranslate nohighlight">\(\)</span>-steps within the <code class="docutils literal notranslate"><span class="pre">dt</span></code> interval; influences the initial guess for <span class="math notranslate nohighlight">\(\)</span>. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the final physical radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final physical radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415doMicroLeapfrogiiddddiidPdPd">
<span class="target" id="nsphere_8c_1a31ec81f5740bfad5a550b8c27f5777f1"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doMicroLeapfrog</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subSteps</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415doMicroLeapfrogiiddddiidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a leapfrog integration step using a fixed number of micro-steps. </p>
<p>This helper function implements the leapfrog (Kick-Drift-Kick) integration over a total time interval <code class="docutils literal notranslate"><span class="pre">h</span></code> by dividing it into a sequence of micro-steps. The number of micro-steps is <code class="docutils literal notranslate"><span class="pre">subSteps</span></code> (e.g., <span class="math notranslate nohighlight">\(2N+1\)</span> for a &quot;coarse&quot; pass or <span class="math notranslate nohighlight">\(4N+1\)</span> for a &quot;fine&quot; pass in an adaptive scheme, where <span class="math notranslate nohighlight">\(N\)</span> is <code class="docutils literal notranslate"><span class="pre">N_subdivision_factor</span></code>). The micro-timestep sizes for kicks and drifts are adjusted based on <code class="docutils literal notranslate"><span class="pre">N_subdivision_factor</span></code> and whether it is a coarse or fine integration sequence. Sequence: Initial half-kick, <span class="math notranslate nohighlight">\(((\text{subSteps}-1)/2 - 1)\)</span> full Drift-Kick pairs, a final full Drift, and a final half-Kick.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in gravitational force. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>r_in</strong> -- [in] Input radial position (kpc) at the start of the total interval <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Input radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
<li><p><strong>h</strong> -- [in] Total physical time interval for this leapfrog sequence (Myr). </p></li>
<li><p><strong>N_subdivision_factor</strong> -- [in] Base subdivision factor <span class="math notranslate nohighlight">\(N\)</span> used to determine micro-timestep sizes. </p></li>
<li><p><strong>subSteps</strong> -- [in] Total number of Kicks/Drifts (e.g., <span class="math notranslate nohighlight">\(2N+1\)</span> or <span class="math notranslate nohighlight">\(4N+1\)</span>). </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the output radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the output radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417doMicroLeviCivitaiidddidddPdPdPd">
<span class="target" id="nsphere_8c_1a43b4fbd8f6dec345978f0bcc2e7d3b9d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doMicroLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_in</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subSteps</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h_tau</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rho_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417doMicroLeviCivitaiidddidddPdPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs Levi-Civita regularized integration using a fixed number of micro-steps. </p>
<p>This helper function advances the particle state in regularized coordinates <span class="math notranslate nohighlight">\((, v_{rad}, t_{phys})\)</span> over a total fictitious time interval <code class="docutils literal notranslate"><span class="pre">h_tau</span></code> ( <span class="math notranslate nohighlight">\(_{total}\)</span>) by taking a specified number of <code class="docutils literal notranslate"><span class="pre">subSteps</span></code> fixed-size micro-steps ( <span class="math notranslate nohighlight">\( = _{total} / \text{subSteps}\)</span>). Each micro-step uses a leapfrog-like scheme (Kick-Drift-Kick for <span class="math notranslate nohighlight">\(, v_{rad}\)</span>) and updates the accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> using <span class="math notranslate nohighlight">\(dt_{phys} =  \cdot _{mid}^2\)</span>. This function is called by <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> for its coarse and fine passes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>rho_in</strong> -- [in] Initial <span class="math notranslate nohighlight">\( = \sqrt{r}\)</span> at the start of the <code class="docutils literal notranslate"><span class="pre">h_tau</span></code> interval. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial radial velocity <span class="math notranslate nohighlight">\(v_{rad}\)</span> at the start of <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>t_in</strong> -- [in] Initial accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> at the start of <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>subSteps</strong> -- [in] Number of fixed micro-steps to perform over <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>h_tau</strong> -- [in] Total fictitious time interval <span class="math notranslate nohighlight">\(_{total}\)</span> for this integration sequence. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
<li><p><strong>rho_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(\)</span> after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(v_{rad}\)</span> after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>t_out</strong> -- [out] Pointer to store the final accumulated <span class="math notranslate nohighlight">\(t_{phys}\)</span> after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd">
<span class="target" id="nsphere_8c_1a5b4db770ebecaeb708ae7b16a73d3e37"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h_guess</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rho_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a single adaptive step in Levi-Civita coordinates over a proposed fictitious time <code class="docutils literal notranslate"><span class="pre">h_guess</span></code>. </p>
<p>This function integrates the equations of motion in regularized <span class="math notranslate nohighlight">\((, v_{rad}, t_{phys})\)</span> coordinates over a proposed fictitious time interval <code class="docutils literal notranslate"><span class="pre">h_guess</span></code> ( <span class="math notranslate nohighlight">\(_{guess}\)</span>). It employs an adaptive refinement strategy by comparing a &quot;coarse&quot; integration (using <span class="math notranslate nohighlight">\(2N+1\)</span> micro-steps via <code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita</span></code>) with a &quot;fine&quot; integration (using <span class="math notranslate nohighlight">\(4N+1\)</span> micro-steps). The subdivision factor <span class="math notranslate nohighlight">\(N\)</span> starts at 1 and is doubled if the relative differences in <span class="math notranslate nohighlight">\(\)</span> and <span class="math notranslate nohighlight">\(v_{rad}\)</span> between coarse and fine results exceed <code class="docutils literal notranslate"><span class="pre">radius_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity_tol</span></code>, respectively. This continues up to <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>. The final state for the <span class="math notranslate nohighlight">\(_{guess}\)</span> step is chosen based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code> (coarse, fine, or Richardson extrapolation). The function outputs the final <span class="math notranslate nohighlight">\(_{out}\)</span>, <span class="math notranslate nohighlight">\(v_{out}\)</span> (radial velocity), and accumulated physical time <span class="math notranslate nohighlight">\(t_{out}\)</span> corresponding to this adaptive <span class="math notranslate nohighlight">\(\)</span> step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>rho_in</strong> -- [in] Initial regularized radial coordinate <span class="math notranslate nohighlight">\( = \sqrt{r}\)</span> at the start of <span class="math notranslate nohighlight">\(_{guess}\)</span>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial radial velocity <span class="math notranslate nohighlight">\(v_{rad}\)</span> at the start of <span class="math notranslate nohighlight">\(_{guess}\)</span>. </p></li>
<li><p><strong>t_in</strong> -- [in] Initial accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> at the start of <span class="math notranslate nohighlight">\(_{guess}\)</span>. </p></li>
<li><p><strong>h_guess</strong> -- [in] The proposed total fictitious time step <span class="math notranslate nohighlight">\(_{guess}\)</span> for this adaptive step. </p></li>
<li><p><strong>radius_tol</strong> -- [in] Relative convergence tolerance for <span class="math notranslate nohighlight">\(\)</span> comparison. </p></li>
<li><p><strong>velocity_tol</strong> -- [in] Relative convergence tolerance for <span class="math notranslate nohighlight">\(v_{rad}\)</span> comparison. </p></li>
<li><p><strong>max_subdiv</strong> -- [in] Maximum subdivision factor <span class="math notranslate nohighlight">\(N\)</span> for micro-steps within <code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita</span></code>. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
<li><p><strong>out_type</strong> -- [in] Result selection for converged micro-integration: 0=coarse, 1=fine, 2=Richardson. </p></li>
<li><p><strong>rho_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(\)</span> after the adaptive <span class="math notranslate nohighlight">\(_{guess}\)</span> step. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(v_{rad}\)</span> after the adaptive <span class="math notranslate nohighlight">\(_{guess}\)</span> step. </p></li>
<li><p><strong>t_out</strong> -- [out] Pointer to store the final accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> after this step. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410dotproduct11threevector11threevector">
<span class="target" id="nsphere_8c_1a7bfc5a1ebba2824215129d3539ed2ed7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dotproduct</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">X</span></span>, <a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">Y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410dotproduct11threevector11threevector" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the scalar dot product of two three-dimensional vectors. </p>
<p>Calculates <span class="math notranslate nohighlight">\(X \cdot Y = X_x Y_x + X_y Y_y + X_z Y_z\)</span>. The dot product is a measure of the projection of one vector onto another and is used in various physics calculations, such as determining the magnitude squared of a vector ( <span class="math notranslate nohighlight">\(V \cdot V = |V|^2\)</span>) or the angle between vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> -- [in] The first threevector operand. </p></li>
<li><p><strong>Y</strong> -- [in] The second threevector operand. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The scalar result of the dot product <span class="math notranslate nohighlight">\(X \cdot Y\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410double_cmpPKvPKv">
<span class="target" id="nsphere_8c_1aaedb17f00b23fc8b1250f6f76611eb83"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">double_cmp</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410double_cmpPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting double values in ascending order. </p>
<p>This function is designed to be used with <code class="docutils literal notranslate"><span class="pre">qsort</span></code> or other standard library sorting functions that require a comparator. It takes two void pointers, casts them to <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">double*</span></code>, dereferences them, and compares their values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- [in] Pointer to the first double value. </p></li>
<li><p><strong>b</strong> -- [in] Pointer to the second double value. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if the first double is less than the second, 1 if the first double is greater than the second, 0 if they are equal. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46drhodrd">
<span class="target" id="nsphere_8c_1a8e43116b27062f239c75f9e228f3420b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46drhodrd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho/dr\)</span> for the Cored Plummer-like density profile. </p>
<p>The density profile is <span class="math notranslate nohighlight">\(\rho(r) \propto (1 + (r/r_c)^2)^{-3}\)</span>. This function computes its analytical derivative with respect to <span class="math notranslate nohighlight">\(r\)</span>. It directly uses the <code class="docutils literal notranslate"><span class="pre">RC</span></code> macro for the scale radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> -- [in] Radial coordinate (kpc) at which to evaluate the derivative. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416drhodr_hernquistddd">
<span class="target" id="nsphere_8c_1a2d34ba23321899551dd1f88944e78c87"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">a_scale</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">M_total</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416drhodr_hernquistddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho/dr\)</span> for the Hernquist profile. </p>
<p>Computes the radial derivative of the Hernquist density profile <span class="math notranslate nohighlight">\(\rho(r) = M_{\text{total}} a / [2\pi r (r+a)^3]\)</span>. The derivative is: <span class="math notranslate nohighlight">\(d\rho/dr = -(M a / 2\pi) (4r + a) / [r^2(r+a)^4]\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate (kpc). </p></li>
<li><p><strong>a_scale</strong> -- [in] Scale radius <span class="math notranslate nohighlight">\(a\)</span> of the Hernquist profile (kpc). </p></li>
<li><p><strong>M_total</strong> -- [in] Total mass normalization (not used in shape calculation). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419drhodr_om_hernquistddd">
<span class="target" id="nsphere_8c_1af071c962381a7ff962a1e1e760e11ca9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr_om_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">a_scale</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">M_total</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419drhodr_om_hernquistddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho_Q/dr\)</span> for the Osipkov-Merritt Hernquist profile. </p>
<p>Computes the radial derivative of the OM augmented density <span class="math notranslate nohighlight">\(\rho_Q(r) = \rho(r)(1 + r^2/r_a^2)\)</span> for the Hernquist profile. Uses the product rule: <span class="math notranslate nohighlight">\(d\rho_Q/dr = (d\rho/dr)(1+r^2/r_a^2) + \rho(r)(2r/r_a^2)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate (kpc). </p></li>
<li><p><strong>a_scale</strong> -- [in] Scale radius <span class="math notranslate nohighlight">\(a\)</span> of the Hernquist profile (kpc). </p></li>
<li><p><strong>M_total</strong> -- [in] Total mass normalization (not used in shape calculation). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho_Q/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424drhodr_profile_nfwcutoffdddd">
<span class="target" id="nsphere_8c_1a7d9dd173f38d371829f3acbc8ae9beb8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr_profile_nfwcutoff</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_param</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nt_nfw_scaler</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">falloff_C_param</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424drhodr_profile_nfwcutoffdddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho/dr\)</span> for the NFW-like profile with a power-law cutoff. </p>
<p>The NFW-like density profile used is: <span class="math notranslate nohighlight">\(\rho(r) = \text{nt_nfw_scaler} \times [ (r_s + \epsilon)(1+r_s)^2 (1 + (r_s/C)^N) ]^{-1}\)</span> where <span class="math notranslate nohighlight">\(r_s = r / \text{rc_param}\)</span>, <span class="math notranslate nohighlight">\(\epsilon\)</span> is a softening parameter (0.01), <span class="math notranslate nohighlight">\(C\)</span> is the <code class="docutils literal notranslate"><span class="pre">falloff_C_param</span></code>, and <span class="math notranslate nohighlight">\(N\)</span> is a power-law index (10.0). This function computes the analytical derivative of this <span class="math notranslate nohighlight">\(\rho(r)\)</span> with respect to <span class="math notranslate nohighlight">\(r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate (kpc) at which to evaluate the derivative. </p></li>
<li><p><strong>rc_param</strong> -- [in] Scale radius <span class="math notranslate nohighlight">\(r_c\)</span> of the NFW-like profile (kpc). </p></li>
<li><p><strong>nt_nfw_scaler</strong> -- [in] Density normalization constant (nt_nfw) for the profile. </p></li>
<li><p><strong>falloff_C_param</strong> -- [in] Falloff transition factor <span class="math notranslate nohighlight">\(C\)</span> for the power-law cutoff. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">rc_param</span></code> is non-positive. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411dRhoDtaufundd">
<span class="target" id="nsphere_8c_1a8de62bf1b56586a24266b2c9788f2995"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dRhoDtaufun</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rhoVal</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vVal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411dRhoDtaufundd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho/d\tau\)</span>, the derivative of the regularized coordinate <span class="math notranslate nohighlight">\(\rho\)</span> with respect to fictitious time <span class="math notranslate nohighlight">\(\tau\)</span>. </p>
<p>In Levi-Civita regularization, <span class="math notranslate nohighlight">\(d\rho/d\tau = (1/2) \rho v_{rad}\)</span>, where <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span> and <span class="math notranslate nohighlight">\(v_{rad}\)</span> is the radial velocity in physical units (though often represented as <span class="math notranslate nohighlight">\(v\)</span> or <span class="math notranslate nohighlight">\(v_{\rho}\)</span> in transformed equations of motion depending on the specific formulation). This function implements this relationship.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhoVal</strong> -- [in] The current value of the regularized radial coordinate <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span>. </p></li>
<li><p><strong>vVal</strong> -- [in] The current radial velocity <span class="math notranslate nohighlight">\(v_{rad}\)</span> (kpc/Myr). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/d\tau\)</span> (kpc <span class="math notranslate nohighlight">\(^{3/2}\)</span>/Myr). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423effective_angular_forcedd">
<span class="target" id="nsphere_8c_1a53ca1607d27fe1cffaabec48d29910e9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">effective_angular_force</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423effective_angular_forcedd" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the effective centrifugal acceleration due to angular momentum. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radius (kpc). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Centrifugal acceleration: <span class="math notranslate nohighlight">\(L^2/r^3\)</span> (kpc/Myr <span class="math notranslate nohighlight">\(^2\)</span>). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429effective_angular_force_rho_vdd">
<span class="target" id="nsphere_8c_1a9f030528565015911482c8584285839f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">effective_angular_force_rho_v</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429effective_angular_force_rho_vdd" title="Link to this definition"></a><br /></dt>
<dd><p>Computes effective centrifugal acceleration in transformed coordinates. </p>
<p>Used in the Levi-Civita regularization scheme. Calculates <span class="math notranslate nohighlight">\(L^2/r^3\)</span> in rho coordinates.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a53ca1607d27fe1cffaabec48d29910e9"><span class="std std-ref">effective_angular_force</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"><span class="std std-ref">doLeviCivitaLeapfrog</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> -- [in] Transformed radial coordinate (sqrt(r)). Units: sqrt(kpc). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(dv/d\tau\)</span> centrifugal term in Levi-Civita coordinates (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr <span class="math notranslate nohighlight">\(^2\)</span>).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412errorAndExitPKcPKcPKc">
<span class="target" id="nsphere_8c_1acc053c8a565be9074d3a4abefc609b3f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">errorAndExit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">msg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">arg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prog</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412errorAndExitPKcPKcPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Displays an error message, suggests <code class="docutils literal notranslate"><span class="pre">--help</span></code>, and terminates the program. </p>
<p>Formats and prints an error message to stderr, includes a suggestion to use the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag for usage information, performs necessary cleanup of allocated resources, and then exits with a non-zero status.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls <a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a> before exiting to free allocated memory. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function does not return; execution is terminated. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> -- [in] The error message to display. </p></li>
<li><p><strong>arg</strong> -- [in] Optional argument value that caused the error (shown in quotes), or NULL to omit. </p></li>
<li><p><strong>prog</strong> -- [in] The program name to display in the &amp;#8212;help usage suggestion.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld">
<span class="target" id="nsphere_8c_1ad07d4bc0d7acda78ba6f3b8864d936f8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">evaluatespline</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">spline</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">acc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld" title="Link to this definition"></a><br /></dt>
<dd><p>Safely evaluates a GSL spline with robust bounds checking. </p>
<p>Evaluates the spline at the given value. If the value is outside the spline's defined domain, this function clamps it to the nearest valid boundary to prevent a GSL domain error. Handles NULL pointers for the spline or accelerator by logging an error and returning 0.0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spline</strong> -- Pointer to the initialized GSL spline object. </p></li>
<li><p><strong>acc</strong> -- Pointer to the GSL interpolation accelerator. </p></li>
<li><p><strong>value</strong> -- The value at which to evaluate the spline.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The interpolated value from the spline. If <code class="docutils literal notranslate"><span class="pre">value</span></code> is out of bounds, returns the value at the nearest boundary. If <code class="docutils literal notranslate"><span class="pre">spline</span></code> or <code class="docutils literal notranslate"><span class="pre">acc</span></code> is NULL, prints an error to stderr and returns 0.0. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428evaluatespline_with_boundaryP10gsl_splineP16gsl_interp_accelddddd">
<span class="target" id="nsphere_8c_1aca1425fd453b2579fa579f24ddf95975"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">evaluatespline_with_boundary</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">spline</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">acc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x_min</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x_max</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y_min</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y_max</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428evaluatespline_with_boundaryP10gsl_splineP16gsl_interp_accelddddd" title="Link to this definition"></a><br /></dt>
<dd><p>Evaluates a spline, returning boundary values when outside domain. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spline</strong> -- GSL spline object </p></li>
<li><p><strong>acc</strong> -- GSL interpolation accelerator </p></li>
<li><p><strong>x</strong> -- Point to evaluate </p></li>
<li><p><strong>x_min</strong> -- Minimum x value in spline </p></li>
<li><p><strong>x_max</strong> -- Maximum x value in spline </p></li>
<li><p><strong>y_min</strong> -- Value to return when x &lt; x_min </p></li>
<li><p><strong>y_max</strong> -- Value to return when x &gt; x_max </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Interpolated value or boundary value </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411fEintegranddPv">
<span class="target" id="nsphere_8c_1aa5158e3d100422d6fe97a7914289bfe0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411fEintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the integrand for the distribution function calculation. </p>
<p>Uses splines to evaluate the potential and mass at a given energy and radius, and computes the distribution function integrand according to Eddington's formula.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> -- Integration variable </p></li>
<li><p><strong>params</strong> -- Structure containing necessary splines and energy value </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the distribution function integrand at the specified point </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421fEintegrand_hernquistdPv">
<span class="target" id="nsphere_8c_1a8f1d5021f29ca1ea098bf3d52817fba5"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_integration_var</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421fEintegrand_hernquistdPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for the NFW distribution function <span class="math notranslate nohighlight">\(I(E)\)</span> calculation. </p>
<p>The function computes the integrand <span class="math notranslate nohighlight">\(2 \cdot (d\rho/d\Psi)\)</span> for Eddington's formula, using the transformed integration variable <span class="math notranslate nohighlight">\(t = \sqrt{E_{shell} - \Psi(r)}\)</span>. It determines the radius <code class="docutils literal notranslate"><span class="pre">r</span></code> corresponding to a given <code class="docutils literal notranslate"><span class="pre">t</span></code> by first finding <span class="math notranslate nohighlight">\(\Psi(r) = E_{shell} - t^2\)</span> and then using a spline for <span class="math notranslate nohighlight">\(r(\Psi)\)</span>. The derivatives <span class="math notranslate nohighlight">\(d\rho/dr\)</span> and <span class="math notranslate nohighlight">\(d\Psi/dr\)</span> are then calculated at that radius.</p>
<p>
Integrand of Hernquist-specific Eddington inversion for computing <span class="math notranslate nohighlight">\(I(E)\)</span> or <span class="math notranslate nohighlight">\(I(Q)\)</span>.</p>
<p>The integrand is <span class="math notranslate nohighlight">\(2(d\rho/d\Psi)\)</span> which is positive due to sign convention <span class="math notranslate nohighlight">\(d\Psi/dr = -GM/r^2\)</span>. Uses transformed variable t_integration_var = sqrt(E_shell - Psi_true) to avoid singularities. For OM model, E_shell represents <span class="math notranslate nohighlight">\(Q = E - L^2/(2r_a^2)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_integration_var</strong> -- The integration variable, <span class="math notranslate nohighlight">\(t = \sqrt{E_{shell} - \Psi(r)}\)</span>. </p></li>
<li><p><strong>params</strong> -- Pointer to a <code class="docutils literal notranslate"><a class="reference internal" href="#structf_e__integrand__params___n_f_w__t"><span class="std std-ref"><span class="pre">fE_integrand_params_NFW_t</span></span></a></code> struct containing the energy shell, splines, and profile parameters. </p></li>
<li><p><strong>t_integration_var</strong> -- [in] The t variable where t = sqrt(E_shell - Psi_true). Integration bounds are [0, sqrt(E_shell - Psimin_global)]. </p></li>
<li><p><strong>params</strong> -- [in] Pointer to <a class="reference internal" href="#structf_e__integrand__params__hernquist__t"><span class="std std-ref">fE_integrand_params_hernquist_t</span></a> containing E_shell, splines, profile parameters, and physical range limits. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the integrand <span class="math notranslate nohighlight">\(2 \cdot (d\rho/d\Psi)\)</span>. Returns 0.0 if the potential is outside the physical range, the radius is non-physical, <span class="math notranslate nohighlight">\(d\Psi/dr\)</span> is near zero, or the result is non-finite.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>double The value of the integrand <span class="math notranslate nohighlight">\(2(d\rho/d\Psi)\)</span>. Returns 0.0 if invalid. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415fEintegrand_nfwdPv">
<span class="target" id="nsphere_8c_1a2607bf70ccc0b0f0b1ebb7dbd4c44607"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand_nfw</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_integration_var</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415fEintegrand_nfwdPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for NFW distribution function <span class="math notranslate nohighlight">\(I(E)\)</span> calculation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_integration_var</strong> -- Integration variable <span class="math notranslate nohighlight">\(t = \sqrt{E_{shell} - \Psi(r)}\)</span>. </p></li>
<li><p><strong>params</strong> -- Pointer to <a class="reference internal" href="#structf_e__integrand__params___n_f_w__t"><span class="std std-ref">fE_integrand_params_NFW_t</span></a> struct. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrand value <span class="math notranslate nohighlight">\(2(d\rho/d\Psi)\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424fft_gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fft_gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424fft_gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Applies Gaussian smoothing using FFT-based convolution (thread-safe via critical section). </p>
<p>Smooths a density field defined on a potentially non-uniform grid (<code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>) using FFT convolution with a Gaussian kernel of width <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code> (defined in log-space). Uses zero-padding to avoid wrap-around artifacts. This is generally faster than direct convolution for large <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>. Assumes log_r_grid is uniformly spaced.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"><span class="std std-ref">direct_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses FFTW library for Fast Fourier Transforms (<code class="docutils literal notranslate"><span class="pre">fftw_malloc</span></code>, <code class="docutils literal notranslate"><span class="pre">fftw_plan_dft_r2c_1d</span></code>, etc.). Requires FFTW to be installed. FFTW operations are protected by <code class="docutils literal notranslate"><span class="pre">omp</span> <span class="pre">critical(fftw)</span></code>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resulting smoothed density is clamped to a minimum value of 1e-10. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints errors to stderr and returns early on memory allocation failures or FFTW plan creation failures. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density_grid</strong> -- [in] Input density grid array (values corresponding to log_r_grid). </p></li>
<li><p><strong>grid_size</strong> -- [in] Number of points in the input grid and density arrays. </p></li>
<li><p><strong>log_r_grid</strong> -- [in] Array of logarithmic radial grid coordinates (log10(r)). Must be uniformly spaced. </p></li>
<li><p><strong>sigma_log</strong> -- [in] Width (standard deviation) of the Gaussian kernel in log10-space. </p></li>
<li><p><strong>result</strong> -- [out] Output array (pre-allocated, size grid_size) for the smoothed density field.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428finalize_debug_energy_outputv">
<span class="target" id="nsphere_8c_1a1219b4779e99559d4045950efce1739a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize_debug_energy_output</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428finalize_debug_energy_outputv" title="Link to this definition"></a><br /></dt>
<dd><p>Writes collected debug energy data to debug_energy_compare.dat. </p>
<p>Outputs time evolution of theoretical vs dynamical energy for the tracked particle (DEBUG_PARTICLE_ID), including KE and PE components. Called at simulation end if g_doDebug is enabled. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427finalize_energy_diagnosticsi">
<span class="target" id="nsphere_8c_1af1a9d2c4abb7a2f3bf3af2e90664c5c2"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize_energy_diagnostics</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">noutsnaps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427finalize_energy_diagnosticsi" title="Link to this definition"></a><br /></dt>
<dd><p>Writes the collected total system energy diagnostics to a file. </p>
<p>This function is called at the end of the simulation. It iterates through the global snapshot arrays and writes the time evolution of the system's total kinetic, potential, and combined energy to a file named <code class="docutils literal notranslate"><span class="pre">data/total_energy_vs_time&lt;suffix&gt;.dat</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file writing operation is skipped if the simulation is in restart mode and file writes are disabled (<code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code> is true). </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>noutsnaps</strong> -- [in] The total number of snapshots recorded.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv434find_last_common_complete_snapshotiiiiPKc">
<span class="target" id="nsphere_8c_1a1022f1e1f403f9e403d9b7c1c650415f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">find_last_common_complete_snapshot</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dtwrite</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_traj_particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlowest</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file_suffix</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434find_last_common_complete_snapshotiiiiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Find the last complete snapshot that exists across ALL output files. </p>
<p>When a simulation is interrupted, different files may have different amounts of data due to buffering. This function finds the last snapshot that is complete in ALL files to ensure consistency on restart.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>npts</strong> -- Number of particles </p></li>
<li><p><strong>dtwrite</strong> -- Timestep interval for writes </p></li>
<li><p><strong>num_traj_particles</strong> -- Number of trajectory particles </p></li>
<li><p><strong>nlowest</strong> -- Number of lowest-L particles </p></li>
<li><p><strong>file_suffix</strong> -- The file suffix string </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The last complete snapshot number common to all files, or -1 on error </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428find_last_processed_snapshotPii">
<span class="target" id="nsphere_8c_1a8f1878f89cdeb5134aa413a021e301ec"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">find_last_processed_snapshot</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">snapshot_steps</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">noutsnaps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428find_last_processed_snapshotPii" title="Link to this definition"></a><br /></dt>
<dd><p>Finds the index of the last successfully processed and written snapshot in restart mode. </p>
<p>This function is called when <code class="docutils literal notranslate"><span class="pre">--restart</span></code> is active. It checks for the existence and basic integrity of snapshot data files (e.g., <code class="docutils literal notranslate"><span class="pre">Rank_Mass_Rad_VRad_unsorted_t%05d.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">Rank_Mass_Rad_VRad_sorted_t%05d.dat</span></code>) corresponding to the timesteps listed in <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code>. Integrity is checked by comparing file sizes against those of the first snapshot's files (snapshot_steps[0]), allowing for a small percentage tolerance (typically +/- 5%). The function aims to determine from which snapshot index <code class="docutils literal notranslate"><span class="pre">s</span></code> (in <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code>) the post-processing (e.g., Rank file generation) should resume. It assumes <code class="docutils literal notranslate"><span class="pre">g_file_suffix</span></code> is correctly set to identify the relevant run's files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_steps</strong> -- [in] Array of integer timestep numbers for which snapshot data was expected to be written (often these are the <code class="docutils literal notranslate"><span class="pre">dtwrite</span></code> intervals). </p></li>
<li><p><strong>noutsnaps</strong> -- [in] The total number of snapshot indices in the <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code> array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int The index <code class="docutils literal notranslate"><span class="pre">s</span></code> into <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code> corresponding to the <em>first snapshot that needs to be processed</em> (i.e., last valid snapshot index + 1).<ul class="simple">
<li><p>Returns -1 if no valid snapshot files are found (implying processing should start from index 0).</p></li>
<li><p>Returns -2 if all expected snapshot files for all unique snapshot numbers exist and appear valid (implying no further snapshot processing is needed for this phase). Prints status messages to stdout and logs warnings/errors. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426find_minimum_useful_radiusPFddPvEPvdd">
<span class="target" id="nsphere_8c_1ad7307cad6bf016546646b508a454ad8b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">find_minimum_useful_radius</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">potential_func</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale_radius</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">tolerance</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426find_minimum_useful_radiusPFddPvEPvdd" title="Link to this definition"></a><br /></dt>
<dd><p>Finds the minimum useful radius where potential values are numerically distinguishable. </p>
<p>Starting from a safe radius, steps down logarithmically towards <span class="math notranslate nohighlight">\(r=0\)</span> until consecutive potential values differ by less than the tolerance. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>potential_func</strong> -- Function pointer to evaluate potential at radius <span class="math notranslate nohighlight">\(r\)</span></p></li>
<li><p><strong>params</strong> -- Parameters to pass to potential_func </p></li>
<li><p><strong>scale_radius</strong> -- Characteristic scale of the profile </p></li>
<li><p><strong>tolerance</strong> -- Relative tolerance for considering potentials equal </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum radius where potential is numerically distinguishable from smaller radii </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427flush_double_buffer_to_diskPKc">
<span class="target" id="nsphere_8c_1a3b070ecd651f8c8dfb9ceafa0a70c050"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flush_double_buffer_to_disk</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tag</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427flush_double_buffer_to_diskPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Flushes double-precision buffer to disk files. </p>
<p>Writes the entire 4-snapshot buffer to disk, overwriting previous buffer files. Creates two binary files:<ul class="simple">
<li><p>double_buffer_all_particle_data_&lt;tag&gt;.dat (Rank, R, Vrad, L)</p></li>
<li><p>double_buffer_all_particle_phi_&lt;tag&gt;.dat (phi)</p></li>
</ul>
</p>
<p>File format per particle per snapshot:<ul class="simple">
<li><p>data file: int32 Rank + double R + double Vrad + double L = 28 bytes</p></li>
<li><p>phi file: double phi = 8 bytes</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tag</strong> -- Simulation tag for filename </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424flush_trajectory_buffersiii">
<span class="target" id="nsphere_8c_1ada04ff20289d0a00e12038835665aac0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">flush_trajectory_buffers</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">items_to_write</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_traj_particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlowest</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424flush_trajectory_buffersiii" title="Link to this definition"></a><br /></dt>
<dd><p>Flushes all buffered trajectory data to their respective files. </p>
<p>This function writes the collected trajectory data for a block of timesteps to disk. It handles opening files on the first write and appends data on subsequent calls. It is synchronized with the main snapshot buffer flush.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>items_to_write</strong> -- The number of timesteps currently in the buffer to write. </p></li>
<li><p><strong>num_traj_particles</strong> -- The number of low-ID particles being tracked. </p></li>
<li><p><strong>nlowest</strong> -- The number of low-L particles being tracked. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410forceLCfuniidddd">
<span class="target" id="nsphere_8c_1ad782ca225e103de69acd7a2ed0b6e9d9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">forceLCfun</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">totalmass</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rhoVal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410forceLCfuniidddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the total effective force per unit mass in Levi-Civita transformed coordinates. </p>
<p>This function computes <span class="math notranslate nohighlight">\(F_{\rho}/m = (F_{grav,\rho} + F_{centrifugal,\rho})/m\)</span>, where <span class="math notranslate nohighlight">\(F_{grav,\rho}\)</span> is the gravitational force and <span class="math notranslate nohighlight">\(F_{centrifugal,\rho}\)</span> is the effective centrifugal force, both expressed in the regularized radial coordinate <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span>. It calls <code class="docutils literal notranslate"><span class="pre">gravitational_force_rho_v</span></code> and <code class="docutils literal notranslate"><span class="pre">effective_angular_force_rho_v</span></code>. This combined force is used in the equations of motion for Levi-Civita regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in gravitational force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>totalmass</strong> -- [in] Total halo mass of the system ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>) used for gravitational force. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr). </p></li>
<li><p><strong>rhoVal</strong> -- [in] Current value of the regularized radial coordinate <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double <span class="math notranslate nohighlight">\(dv/d\tau\)</span> in Levi-Civita coordinates (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr <span class="math notranslate nohighlight">\(^2\)</span>). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416format_file_sizelPc6size_t">
<span class="target" id="nsphere_8c_1a83a2e63c11c141847a52cf72209bdf96"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">format_file_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size_in_bytes</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">buffer_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416format_file_sizelPc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Formats a byte count into a human-readable string with appropriate units. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size_in_bytes</strong> -- [in] The size in bytes to format. </p></li>
<li><p><strong>buffer</strong> -- [out] Output buffer for the formatted string. </p></li>
<li><p><strong>buffer_size</strong> -- [in] Size of the output buffer. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411fprintf_binP4FILEPKcz">
<span class="target" id="nsphere_8c_1a43386b4e33cce0ad200f33114481d9e5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fprintf_bin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411fprintf_binP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Binary file I/O function declarations. </p>
<p>Writes binary data to a file using a printf-like format string.</p>
<p>These functions provide platform-independent binary file I/O operations similar to fprintf and fscanf, but ensure consistent binary format regardless of host architecture.</p>
<p>Parses a format string containing simplified specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Writes corresponding arguments from the variadic list (<code class="docutils literal notranslate"><span class="pre">...</span></code>) as binary data. Integer types (<code class="docutils literal notranslate"><span class="pre">d</span></code>) are written as <code class="docutils literal notranslate"><span class="pre">int</span></code>. Floating-point types (<code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">double</span></code> from args but written as <code class="docutils literal notranslate"><span class="pre">float</span></code> to the file for storage efficiency.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"><span class="std std-ref">fscanf_bin</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skips optional width/precision specifiers in the format string. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> -- [in] File pointer to write to (must be opened in binary mode). </p></li>
<li><p><strong>format</strong> -- [in] Format string with specifiers (d, f, g, e). Other characters are ignored. </p></li>
<li><p><strong>...</strong> -- [in] Variable arguments matching the format specifiers. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of items successfully written according to the format string.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415fprintf_bin_dblP4FILEPKcz">
<span class="target" id="nsphere_8c_1a6faaa79423a213d0c6d1156fe5a9aafe"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fprintf_bin_dbl</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415fprintf_bin_dblP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Writes binary data to a file using a printf-like format string (DOUBLE PRECISION). </p>
<p>Writes floating-point values as 8-byte doubles, preserving full precision. Avoids the precision loss from doublefloat32double conversion.</p>
<p>Used exclusively for the double_buffer_all_particle_* files which maintain the last 4 snapshots in full precision for accurate restart/extend operations.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a43386b4e33cce0ad200f33114481d9e5"><span class="std std-ref">fprintf_bin</span></a> (float32 version) </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1addf0b1af5e57172950992bbb30938890"><span class="std std-ref">fscanf_bin_dbl</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Integer types (d) written as int (4 bytes), floats (f/g/e) written as double (8 bytes). </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> -- [in] File pointer to write to (must be opened in binary mode). </p></li>
<li><p><strong>format</strong> -- [in] Format string with specifiers (d, f, g, e). Other characters are ignored. </p></li>
<li><p><strong>...</strong> -- [in] Variable arguments matching the format specifiers. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of items written according to the format string.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410fscanf_binP4FILEPKcz">
<span class="target" id="nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fscanf_bin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410fscanf_binP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Reads binary data from a file using a scanf-like format string. </p>
<p>Parses a format string containing simplified specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Reads corresponding binary data from the file and stores it in the pointer arguments provided in the variadic list (<code class="docutils literal notranslate"><span class="pre">...</span></code>). Integer types (<code class="docutils literal notranslate"><span class="pre">d</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">int</span></code>. Floating-point types (<code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">float</span></code> from the file but stored into <code class="docutils literal notranslate"><span class="pre">double*</span></code> arguments provided by the caller.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a43386b4e33cce0ad200f33114481d9e5"><span class="std std-ref">fprintf_bin</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skips optional width/precision specifiers in the format string. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> -- [in] File pointer to read from (must be opened in binary mode). </p></li>
<li><p><strong>format</strong> -- [in] Format string with specifiers (d, f, g, e). Other characters are ignored. </p></li>
<li><p><strong>...</strong> -- [out] Variable pointer arguments matching the format specifiers (e.g., int*, double*). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of items successfully read and assigned. Stops reading on first failure or EOF.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414fscanf_bin_dblP4FILEPKcz">
<span class="target" id="nsphere_8c_1addf0b1af5e57172950992bbb30938890"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fscanf_bin_dbl</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414fscanf_bin_dblP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Reads binary data from a file using a scanf-like format string (DOUBLE PRECISION). </p>
<p>Reads floating-point values as 8-byte doubles, preserving full precision. Avoids the precision loss from float32double conversion when loading snapshot data.</p>
<p>Used to restore full-precision snapshot data during restart/extend operations, avoiding the precision loss inherent in float32 storage.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"><span class="std std-ref">fscanf_bin</span></a> (float32 version) </p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a6faaa79423a213d0c6d1156fe5a9aafe"><span class="std std-ref">fprintf_bin_dbl</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Integer types (d) read as int (4 bytes), floats (f/g/e) read as double (8 bytes). </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fp</strong> -- [in] File pointer to read from (must be opened in binary mode). </p></li>
<li><p><strong>format</strong> -- [in] Format string with specifiers (d, f, g, e). Other characters are ignored. </p></li>
<li><p><strong>...</strong> -- [out] Variable pointer arguments matching the format specifiers (int*, double*). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The number of items successfully read and assigned. Stops reading on first failure or EOF.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs Gaussian smoothing by selecting the appropriate convolution method. </p>
<p>Acts as a routing function that delegates density smoothing to either <code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution</span></code> or <code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution</span></code> based on the value of the global <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> flag.<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> is non-zero, <code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution</span></code> is called (more accurate, <span class="math notranslate nohighlight">\(O(N^2)\)</span> complexity, suitable for smaller or non-uniform grids).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> is zero (default), <code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution</span></code> is called (faster for large grids, O(N log N) complexity, requires uniformly spaced logarithmic grid).</p></li>
</ul>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"><span class="std std-ref">direct_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"><span class="std std-ref">fft_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a4a1f369af4feb2852a5bddbace1948b9"><span class="std std-ref">debug_direct_convolution</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>density_grid</strong> -- [in] Input density grid array (values corresponding to log_r_grid). </p></li>
<li><p><strong>grid_size</strong> -- [in] Number of points in the input grid and density arrays. </p></li>
<li><p><strong>log_r_grid</strong> -- [in] Array of logarithmic radial grid coordinates (log10(r)). Must be uniform if FFT is used. </p></li>
<li><p><strong>sigma_log</strong> -- [in] Width (standard deviation) of the Gaussian kernel in log10-space. </p></li>
<li><p><strong>result</strong> -- [out] Output array (pre-allocated, size grid_size) for the smoothed density field.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv434generate_ics_hernquist_anisotropicPPdiP7gsl_rngddPP10gsl_splinePP16gsl_interp_accelPP10gsl_splinePP16gsl_interp_accelPP10gsl_splinePP16gsl_interp_accelPP10gsl_interpPP16gsl_interp_accelPPdPPdPPdPPdPii">
<span class="target" id="nsphere_8c_1af26fa02b1e0071556baa430915332336"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">generate_ics_hernquist_anisotropic</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts_initial</span></span>, <span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rng</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale_radius</span></span>, <span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">splinemass_out</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">enclosedmass_out</span></span>, <span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">splinePsi_out</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Psiinterp_out</span></span>, <span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">splinerofPsi_out</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rofPsiinterp_out</span></span>, <span class="n"><span class="pre">gsl_interp</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fofEinterp_out</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fofEacc_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">radius_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">radius_unsorted_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">mass_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Psivalues_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">num_points_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">splines_only</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434generate_ics_hernquist_anisotropicPPdiP7gsl_rngddPP10gsl_splinePP16gsl_interp_accelPP10gsl_splinePP16gsl_interp_accelPP10gsl_splinePP16gsl_interp_accelPP10gsl_interpPP16gsl_interp_accelPPdPPdPPdPPdPii" title="Link to this definition"></a><br /></dt>
<dd><p>Generates initial conditions for an anisotropic Hernquist profile. </p>
<p>Implements a sampling algorithm for the anisotropic Hernquist distribution function <span class="math notranslate nohighlight">\(f(E, L)\)</span>. It uses a combination of inverse transform sampling for radius and direction, and rejection sampling for velocity magnitude. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424get_available_disk_spacePKc">
<span class="target" id="nsphere_8c_1a69a5382b45f88c0e827ededfec0cf9e1"></span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_available_disk_space</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">path</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424get_available_disk_spacePKc" title="Link to this definition"></a><br /></dt>
<dd><p>Gets the available disk space for the filesystem containing the given path. </p>
<p>This function uses platform-specific APIs to determine the free space available to the current user on the filesystem where <code class="docutils literal notranslate"><span class="pre">path</span></code> resides. On Windows, it uses <code class="docutils literal notranslate"><span class="pre">GetDiskFreeSpaceEx</span></code>. On POSIX-compliant systems (Linux, macOS), it uses <code class="docutils literal notranslate"><span class="pre">statvfs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> -- [in] A path to a file or directory on the filesystem to check. For Windows, this can be a root directory like &quot;C:\\&quot;. For POSIX, any path within the target filesystem, e.g., &quot;data/&quot;. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>long long Available disk space in bytes. Returns -1 on error or if the functionality is not implemented for the current platform. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420get_sort_descriptionPKc">
<span class="target" id="nsphere_8c_1a2ae9c69e89df65eb9ddc9c3edd6e2422"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_sort_description</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sort_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420get_sort_descriptionPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Returns a human-readable description for a sort algorithm identifier string. </p>
<p>Maps internal sort algorithm identifiers (e.g., &quot;quadsort_parallel&quot;) to user-friendly descriptive names (e.g., &quot;Parallel Quadsort&quot;). This is primarily used for display purposes in command-line output or logs, providing more context than the internal short string identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sort_alg</strong> -- [in] The internal algorithm identifier string. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>const char* A descriptive name for the algorithm. If no match is found, the input <code class="docutils literal notranslate"><span class="pre">sort_alg</span></code> string itself is returned as a fallback. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421get_suffixed_filenamePKciPc6size_t">
<span class="target" id="nsphere_8c_1a4757da672d57dda1b6f4114423850503"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_suffixed_filename</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">base_filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">with_suffix</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bufsize</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421get_suffixed_filenamePKciPc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Applies the global suffix to a filename. </p>
<p>For .dat files, inserts suffix before the extension. For other files, appends suffix to the end of filename.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_filename</strong> -- [in] Original filename. </p></li>
<li><p><strong>with_suffix</strong> -- [in] Flag indicating whether to apply the suffix (1=yes, 0=no). </p></li>
<li><p><strong>buffer</strong> -- [out] Output buffer for the resulting filename. </p></li>
<li><p><strong>bufsize</strong> -- [in] Size of the output buffer. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419gravitational_forcediidd">
<span class="target" id="nsphere_8c_1a90e8d2ddbd4ea35b65f3232fdb0056f2"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravitational_force</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_rank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">G_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419gravitational_forcediidd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates gravitational acceleration at a given radius. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code> is set to 1. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(M(r)\)</span> is approximated as <code class="docutils literal notranslate"><span class="pre">(current_rank</span> <span class="pre">/</span> <span class="pre">npts)</span> <span class="pre">*</span> <span class="pre">halo_mass_value</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radius in kpc. </p></li>
<li><p><strong>current_rank</strong> -- [in] Particle rank (0 to npts-1), used for <span class="math notranslate nohighlight">\(M(r)\)</span> approximation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>G_value</strong> -- [in] Gravitational constant value (e.g., G_CONST). </p></li>
<li><p><strong>halo_mass_value</strong> -- [in] Total halo mass (e.g., HALO_MASS). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gravitational acceleration (force per unit mass) in simulation units (kpc/Myr <span class="math notranslate nohighlight">\(^2\)</span>).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425gravitational_force_rho_vdiidd">
<span class="target" id="nsphere_8c_1a302b3d50ea55f625e4f840e8515a5c79"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravitational_force_rho_v</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_rank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">G_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425gravitational_force_rho_vdiidd" title="Link to this definition"></a><br /></dt>
<dd><p>Alternative gravitational force calculation using transformed coordinates. </p>
<p>Used in the Levi-Civita regularization scheme. Calculates F/m in rho coordinates.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a90e8d2ddbd4ea35b65f3232fdb0056f2"><span class="std std-ref">gravitational_force</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"><span class="std std-ref">doLeviCivitaLeapfrog</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code> is set to 1. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rho</strong> -- [in] Transformed radial coordinate (sqrt(r)). Units: sqrt(kpc). </p></li>
<li><p><strong>current_rank</strong> -- [in] Particle rank (0 to npts-1). </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>G_value</strong> -- [in] Gravitational constant value (e.g., G_CONST). </p></li>
<li><p><strong>halo_mass_value</strong> -- [in] Total halo mass (e.g., HALO_MASS). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(dv/d\tau\)</span> in Levi-Civita coordinates (kpc <span class="math notranslate nohighlight">\(^2\)</span>/Myr <span class="math notranslate nohighlight">\(^2\)</span>).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416handle_sidm_stepPPdidddiiPi">
<span class="target" id="nsphere_8c_1a0acd72996dfcf89faf50100d0d49bcac"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">handle_sidm_step</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_sim_time</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">active_profile_rc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_method_display_num</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bootstrap_phase_active</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">current_scatter_counts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416handle_sidm_stepPPdidddiiPi" title="Link to this definition"></a><br /></dt>
<dd><p>Handles the SIDM scattering phase for a single timestep. </p>
<p>Checks if SIDM is enabled and if not in a bootstrap phase that should skip SIDM. If proceeding, it resets particle scatter flags, selects serial or parallel execution based on <code class="docutils literal notranslate"><span class="pre">g_sidm_execution_mode</span></code>, calls the appropriate core scattering function (<code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_serial</span></code> or <code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_parallel</span></code>), updates the global total scatter count, and logs debug information if scatters occurred and debugging is enabled. The core scattering functions are responsible for updating the <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code> flags for particles that underwent scattering.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function modifies the <code class="docutils literal notranslate"><span class="pre">particles</span></code> array in-place. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It uses global variables: <code class="docutils literal notranslate"><span class="pre">g_enable_sidm_scattering</span></code>, <code class="docutils literal notranslate"><span class="pre">g_sidm_execution_mode</span></code>, <code class="docutils literal notranslate"><span class="pre">g_rng_per_thread</span></code>, <code class="docutils literal notranslate"><span class="pre">g_max_omp_threads_for_rng</span></code>, <code class="docutils literal notranslate"><span class="pre">g_rng</span></code>, <code class="docutils literal notranslate"><span class="pre">g_total_sidm_scatters</span></code>, <code class="docutils literal notranslate"><span class="pre">g_active_halo_mass</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, and <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] The main particle data array: <code class="docutils literal notranslate"><span class="pre">particles[component][current_sorted_index]</span></code>. Modified in-place with post-scattering velocities/angular momenta. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>dt</strong> -- [in] The simulation timestep (Myr). </p></li>
<li><p><strong>current_sim_time</strong> -- [in] The current simulation time at the beginning of this step (Myr). </p></li>
<li><p><strong>active_profile_rc</strong> -- [in] The scale radius (kpc) of the currently active profile (NFW, Cored, or Hernquist), passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>current_method_display_num</strong> -- [in] The user-facing display number of the current integration method (for logging). </p></li>
<li><p><strong>bootstrap_phase_active</strong> -- [in] Flag (0 or 1) indicating if a bootstrap phase (e.g., for Adams-Bashforth) is active. If 1, SIDM scattering is skipped for this step. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427hernquist_potential_wrapperdPv">
<span class="target" id="nsphere_8c_1a0de54d29377407c2c230b38fbf1cdc70"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hernquist_potential_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427hernquist_potential_wrapperdPv" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper function for Hernquist potential calculation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- Radius (kpc). </p></li>
<li><p><strong>params</strong> -- Void pointer to <a class="reference internal" href="#structhernquist__potential__params"><span class="std std-ref">hernquist_potential_params</span></a> struct. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Potential value at radius <em>r</em>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415hyperg_2F1_safedd">
<span class="target" id="nsphere_8c_1a66a3cdf2ebd62eb4d16829d40e856a7f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hyperg_2F1_safe</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">beta</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_tilde</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415hyperg_2F1_safedd" title="Link to this definition"></a><br /></dt>
<dd><p>Safe wrapper for hypergeometric function with analytical special cases. </p>
<p>Handles boundary cases where GSL has singularities:<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta=0.5\)</span>: <span class="math notranslate nohighlight">\(a=0\)</span>, so <span class="math notranslate nohighlight">\({}_2F_1(0,b,c,x) = 1\)</span> (exact)</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta=-0.5\)</span>: <span class="math notranslate nohighlight">\({}_2F_1(2,6,4,x) = (3x^2-10x+10)/(5(x-1)^2)\)</span> (analytical)</p></li>
<li><p>Otherwise: Uses GSL implementation</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>beta</strong> -- Anisotropy parameter </p></li>
<li><p><strong>E_tilde</strong> -- Dimensionless energy (must be &lt; 1 for convergence) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Hypergeometric function value </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423insertion_parallel_sortPPdi">
<span class="target" id="nsphere_8c_1a333ac7a494bba72619fb98750fe69634"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_parallel_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423insertion_parallel_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Parallel insertion sort implementation using chunk-based approach with overlap. </p>
<p>Divides the data into num_sort_sections chunks, sorts each chunk in parallel, then fixes the boundaries between chunks by re-sorting overlap regions. This approach balances parallelism with the need to ensure properly sorted output.</p>
<p>
Parallel implementation of insertion sort algorithm optimized for particle sorting.</p>
<p>Uses multiple OpenMP threads to sort sections of particle data in parallel, followed by seam-fixing operations to ensure global ordering. Includes dynamic section calculation and optimized overlap sizing based on chunk characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort</p></li>
<li><p><strong>columns</strong> -- Column-major data array [particle][component] </p></li>
<li><p><strong>n</strong> -- Number of particles to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414insertion_sortPPdi">
<span class="target" id="nsphere_8c_1a9f764a3b15f188a11747c55c91e3fea6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414insertion_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Implementation of classic insertion sort algorithm for particle data. </p>
<p>Sorts an array of particle data using the insertion sort algorithm. While not the fastest algorithm for large datasets, it is stable and works well for small arrays or nearly sorted data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418insertion_sort_subPPdii">
<span class="target" id="nsphere_8c_1ad333571f8f209b19896bc93e94643a61"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_sort_sub</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">end</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418insertion_sort_subPPdii" title="Link to this definition"></a><br /></dt>
<dd><p>Performs insertion sort on a subarray of particle data. </p>
<p>Operates on range <code class="docutils literal notranslate"><span class="pre">[start..end]</span></code> inclusive within the columns array. Used by parallel sorting algorithms to sort individual chunks and seam regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data containing the target subarray (<code class="docutils literal notranslate"><span class="pre">double**</span></code>). </p></li>
<li><p><strong>start</strong> -- Starting index of the subarray (inclusive). </p></li>
<li><p><strong>end</strong> -- Ending index of the subarray (inclusive). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47isFloatPKc">
<span class="target" id="nsphere_8c_1a5b75ba4813fc53f0e959c9f67795a3b9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isFloat</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">str</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47isFloatPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a given string represents a valid floating-point number. </p>
<p>Validates if the input string conforms to common floating-point number formats, including an optional leading sign ('+' or '-'), digits, at most one decimal point (if not in exponent part), and an optional exponent part (e.g., &quot;e+10&quot;, &quot;E-5&quot;). The function requires at least one digit to be present for a number to be considered valid (e.g., &quot;.&quot; or &quot;+.&quot; are not valid floats).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str</strong> -- [in] The null-terminated string to check. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 if the string is a valid float, 0 otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49isIntegerPKc">
<span class="target" id="nsphere_8c_1a42b67ba97407675434b2e4a94e733f62"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isInteger</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">str</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49isIntegerPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a given string represents a valid integer. </p>
<p>Allows an optional leading '+' or '-' sign. Validates that all subsequent characters in the string are digits. Returns 0 (false) for empty strings, strings containing only a sign, or strings with non-digit characters after the optional sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str</strong> -- [in] The null-terminated string to check. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 if the string is a valid integer, 0 otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421load_chosen_particlesPKcPPiPiPPiPi">
<span class="target" id="nsphere_8c_1abf67ac23464b4f0de380fab48ed00cec"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">load_chosen_particles</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chosen_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">nlowest_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">traj_ids_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">n_traj_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421load_chosen_particlesPKcPPiPiPPiPi" title="Link to this definition"></a><br /></dt>
<dd><p>Load chosen particle IDs from a binary file. </p>
<p>This function loads particle IDs that were previously saved for trajectory tracking, restoring the particle selection state from a prior simulation run. It reads two sets of particle IDs: one for particles with the lowest angular momentum, and another for general trajectory tracking by original particle ID.</p>
<p>The expected binary file format is:<ul class="simple">
<li><p>Header (8 bytes):<ul>
<li><p>int32: num_lowestl - Number of particles with lowest angular momentum</p></li>
<li><p>int32: num_trajectories - Number of particles for general trajectory tracking</p></li>
</ul>
</p></li>
<li><p>Data section:<ul>
<li><p>int32[num_lowestl]: Particle IDs selected by lowest angular momentum</p></li>
<li><p>int32[num_trajectories]: Particle IDs for general trajectory tracking</p></li>
</ul>
</p></li>
</ul>
</p>
<p>For backward compatibility, the function also supports files with only a single integer header followed by lowest_l particle IDs. This allows older simulation outputs to be read correctly.</p>
<p>The loaded particle IDs are used to maintain continuity in trajectory tracking across simulation restarts and extensions. The lowest_l particles continue to be tracked in lowest_l_trajectories.dat, while the trajectory particles continue in trajectories.dat and single_trajectory.dat.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If traj_ids_out is NULL, trajectory IDs are read but not returned to the caller. Memory is allocated for the output arrays; caller is responsible for freeing them. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the input binary file containing saved particle IDs </p></li>
<li><p><strong>chosen_out</strong> -- [out] Pointer to store allocated array of lowest_l particle IDs </p></li>
<li><p><strong>nlowest_out</strong> -- [out] Number of lowest_l particles loaded </p></li>
<li><p><strong>traj_ids_out</strong> -- [out] Pointer to store allocated array of trajectory particle IDs (can be NULL) </p></li>
<li><p><strong>n_traj_out</strong> -- [out] Number of trajectory particles loaded (can be NULL) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 on success, 0 on failure (file not found or read error) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv432load_existing_energy_diagnosticsPKci">
<span class="target" id="nsphere_8c_1aab8f6279062b7519d9923579ec5ba8b6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">load_existing_energy_diagnostics</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_snapshots</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv432load_existing_energy_diagnosticsPKci" title="Link to this definition"></a><br /></dt>
<dd><p>Writes collected debug energy data to a file. </p>
<p>Writes the time evolution of theoretical vs. dynamic energy for the tracked particle (<code class="docutils literal notranslate"><span class="pre">DEBUG_PARTICLE_ID</span></code>) to <code class="docutils literal notranslate"><span class="pre">data/debug_energy_compare.dat</span></code>. The output includes kinetic and potential energy components. This function is called at the end of the simulation if <code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code> is enabled.</p>
<p>
Loads existing energy diagnostic data from a file for restart/extend operations.<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"><span class="std std-ref">store_debug_approxE</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"><span class="std std-ref">store_debug_dynE_components</span></a></p>
</div>
</p>
<p>Reads energy data from an existing total_energy_vs_time file to populate the global energy arrays. This ensures continuity when restarting simulations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>File writing is suppressed if <code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code> is non-zero.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the existing energy file </p></li>
<li><p><strong>max_snapshots</strong> -- [in] Maximum number of snapshots to load </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of snapshots successfully loaded </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423load_from_double_bufferPKciiPPdiPi">
<span class="target" id="nsphere_8c_1a8369f0524d65ae88410b781bd7ee4680"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">load_from_double_buffer</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tag</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapshot_index</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">total_snapshots</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particle_ids</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423load_from_double_bufferPKciiPPdiPi" title="Link to this definition"></a><br /></dt>
<dd><p>Attempts to load a snapshot from the double-precision buffer files. </p>
<p>Tries to load the specified snapshot from the double buffer files. Returns 1 if successful, 0 if snapshot not in buffer or files missing. On success, loads particle state with full double precision (no conversion).</p>
<p>Buffer stores snapshots in circular order. For 81-snapshot run, buffer contains snapshots [77, 78, 79, 80]. Snapshot 79 is located at buffer position 2.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tag</strong> -- Simulation tag for filename </p></li>
<li><p><strong>snapshot_index</strong> -- Snapshot number to load (e.g., 79) </p></li>
<li><p><strong>total_snapshots</strong> -- Total snapshots written so far (e.g., 81) </p></li>
<li><p><strong>particles</strong> -- Destination particle arrays [R, Vrad, L, ID, <span class="math notranslate nohighlight">\(\mu\)</span>, cos_phi, sin_phi] </p></li>
<li><p><strong>npts</strong> -- Number of particles </p></li>
<li><p><strong>particle_ids</strong> -- Destination for particle IDs (unused in this function). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if loaded successfully, 0 if snapshot not available in buffer </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427load_particles_from_restartPKciPPdiiPi">
<span class="target" id="nsphere_8c_1a593b98d856fb5eac58794529b317ae9b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">load_particles_from_restart</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapshot_index</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">inverse_map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427load_particles_from_restartPKciPPdiiPi" title="Link to this definition"></a><br /></dt>
<dd><p>Load particle state from all_particle_data file for restart/extend operations. </p>
<p>Reads a specific snapshot from an all_particle_data file and converts it to the internal particles array format used for initial conditions. This function is used by <code class="docutils literal notranslate"><span class="pre">--sim-restart</span></code> and <code class="docutils literal notranslate"><span class="pre">--sim-extend</span></code> to load the final particle state from a completed simulation run.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- Path to the all_particle_data file </p></li>
<li><p><strong>snapshot_index</strong> -- Which snapshot to load (0-based) </p></li>
<li><p><strong>particles</strong> -- Output array [5][npts] in standard IC format </p></li>
<li><p><strong>npts</strong> -- Number of particles </p></li>
<li><p><strong>block_size</strong> -- Block size for I/O (typically 100) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411log_messagePKcPKcz">
<span class="target" id="nsphere_8c_1a569e4ea9a45d9d1ed9d3c34d40b0da44"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">log_message</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411log_messagePKcPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Writes a formatted message to the log file with timestamp and severity level. </p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae577daedc1b00c1bb2e11dba4f69a64c"><span class="std std-ref">g_enable_logging</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Creates the &quot;log&quot; directory if it does not exist. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the log file cannot be opened. Logging only occurs if the global <code class="docutils literal notranslate"><span class="pre">g_enable_logging</span></code> flag is set. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>level</strong> -- [in] Severity level (e.g., &quot;INFO&quot;, &quot;WARNING&quot;, &quot;ERROR&quot;). </p></li>
<li><p><strong>format</strong> -- [in] Printf-style format string. </p></li>
<li><p><strong>...</strong> -- [in] Variable arguments for the format string.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416make_threevectorddd">
<span class="target" id="nsphere_8c_1a76679a4c5de497c0ffecd96f6f21cca2"></span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_threevector</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">z</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416make_threevectorddd" title="Link to this definition"></a><br /></dt>
<dd><p>Constructs a three-dimensional vector from its Cartesian components. </p>
<p>This utility function initializes a <code class="docutils literal notranslate"><span class="pre">threevector</span></code> structure with the provided x, y, and z components. It serves as a convenient constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> -- [in] The x-component of the vector. </p></li>
<li><p><strong>y</strong> -- [in] The y-component of the vector. </p></li>
<li><p><strong>z</strong> -- [in] The z-component of the vector. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>threevector An initialized <code class="docutils literal notranslate"><span class="pre">threevector</span></code> structure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424mass_integrand_hernquistdPv">
<span class="target" id="nsphere_8c_1a392460c431e17c28537a3db7dc3457cc"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mass_integrand_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">p</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424mass_integrand_hernquistdPv" title="Link to this definition"></a><br /></dt>
<dd><p>GSL-compatible wrapper for the Hernquist density integrand: <span class="math notranslate nohighlight">\(4\pi r^2 \rho(r)\)</span>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- Radius (kpc). </p></li>
<li><p><strong>p</strong> -- Void pointer to <a class="reference internal" href="#structhernquist__params"><span class="std std-ref">hernquist_params</span></a> struct. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Integrand value for mass calculation. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413massintegranddPv">
<span class="target" id="nsphere_8c_1a486e09e9ff56866413bdfb973b8172ce"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413massintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>GSL integrand <span class="math notranslate nohighlight">\(r^2 \rho_{shape}(r)\)</span> for Cored Plummer-like profile mass calculation. </p>
<p>Computes the term <span class="math notranslate nohighlight">\(r^2 \rho_{shape}(r)\)</span> for the Cored Plummer-like density profile, where <span class="math notranslate nohighlight">\(\rho_{shape}(r) = (1 + (r/r_c)^2)^{-3}\)</span>. This integrand is used in GSL numerical integration routines (e.g., <code class="docutils literal notranslate"><span class="pre">gsl_integration_qag</span></code>) to calculate the normalization factor or the enclosed mass <span class="math notranslate nohighlight">\(M(&lt;r) = 4\pi \int_0^r r'^2 \rho_{physical}(r') dr'\)</span>. It directly uses the <code class="docutils literal notranslate"><span class="pre">RC</span></code> macro for the scale radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate <span class="math notranslate nohighlight">\(r\)</span> (kpc). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to parameters (unused). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of the mass integrand <span class="math notranslate nohighlight">\(r^2 \rho_{shape}(r)\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423massintegrand_hernquistdPv">
<span class="target" id="nsphere_8c_1a0a4d830b1834855377adb0ae3a339dd7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423massintegrand_hernquistdPv" title="Link to this definition"></a><br /></dt>
<dd><p>GSL integrand <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> for Hernquist profile mass calculation. </p>
<p>Computes <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> where <span class="math notranslate nohighlight">\(\rho(r) = M_{\text{total}} a / [2\pi r (r+a)^3]\)</span> is the Hernquist density profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate (kpc). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to a double array: [a_scale, M_total, normalization_factor]. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv431massintegrand_profile_nfwcutoffdPv">
<span class="target" id="nsphere_8c_1a8e33f50ec202f76ee9185c55123dd196"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand_profile_nfwcutoff</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv431massintegrand_profile_nfwcutoffdPv" title="Link to this definition"></a><br /></dt>
<dd><p>GSL integrand <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> for NFW-like profile mass calculation. </p>
<p>Computes <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> where <span class="math notranslate nohighlight">\(\rho(r)\)</span> is an NFW-like density profile with an inner softening term and an outer power-law cutoff. The density <span class="math notranslate nohighlight">\(\rho(r) = p[2] \times [ (r_s + \epsilon)(1+r_s)^2 (1 + (r_s/C)^N) ]^{-1}\)</span>, where <span class="math notranslate nohighlight">\(r_s = r/p[0]\)</span>, <span class="math notranslate nohighlight">\(\epsilon=0.01\)</span>, <span class="math notranslate nohighlight">\(C=p[3]\)</span>, <span class="math notranslate nohighlight">\(N=10.0\)</span>. This integrand is used in GSL routines to calculate the normalization factor or enclosed mass for the NFW-like profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate <span class="math notranslate nohighlight">\(r\)</span> (kpc). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to a <code class="docutils literal notranslate"><span class="pre">double</span></code> array <code class="docutils literal notranslate"><span class="pre">p</span></code> of size 4:<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p[0]</span></code> (rc_param): Scale radius (kpc).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[1]</span></code> (halo_mass): Target total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>) - used to derive nt_nfw_scaler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[2]</span></code> (nt_nfw_scaler): Density normalization constant <span class="math notranslate nohighlight">\(nt_{NFW}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[3]</span></code> (falloff_C_param): Falloff transition factor <span class="math notranslate nohighlight">\(C\)</span>. </p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of the mass integrand <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span>. Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">rc_param</span></code> (p[0]) is non-positive. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421nfw_potential_wrapperdPv">
<span class="target" id="nsphere_8c_1a7522f48d030cd0dd4f64fe94db08f8a9"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nfw_potential_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421nfw_potential_wrapperdPv" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper function for NFW potential calculation. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- Radius (kpc). </p></li>
<li><p><strong>params</strong> -- Void pointer to <a class="reference internal" href="#structnfw__potential__params"><span class="std std-ref">nfw_potential_params</span></a> struct. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Approximate potential value at radius <em>r</em>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415om_mu_integranddPv">
<span class="target" id="nsphere_8c_1ab2c1aa9317e3ba97126230ff4b8451af"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">om_mu_integrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mu</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415om_mu_integranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for OM <span class="math notranslate nohighlight">\(\mu\)</span>-integral in df_fixed_radius. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419parallel_radix_sortPPdi">
<span class="target" id="nsphere_8c_1ad90beede079735805a2133d8746f143e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parallel_radix_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419parallel_radix_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>CPU-based parallel radix sort optimized for particle data. </p>
<p>High-performance radix sort that operates directly on double-precision radius values by converting them to sortable integer representations. Automatically chooses between serial and parallel implementations based on array size. Typically outperforms GPU sorting for arrays &lt; 50M elements due to lower overhead.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted [particle][component] </p></li>
<li><p><strong>n</strong> -- Number of particles to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422parse_nsphere_filenamePKcPiPiPd">
<span class="target" id="nsphere_8c_1a270e9bffcbd2ff96d387a06a2debb1fd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parse_nsphere_filename</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">N</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Ntimes</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">tfinal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422parse_nsphere_filenamePKcPiPiPd" title="Link to this definition"></a><br /></dt>
<dd><p>Parse NSphere filename to extract simulation parameters. </p>
<p>Attempts to extract N, Ntimes, and tfinal from standard NSphere filename format: prefix_tag_N_Ntimes_tfinal.dat (e.g., beta025_1000_1250000_100.dat) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- The filename to parse </p></li>
<li><p><strong>N</strong> -- Pointer to store extracted N value </p></li>
<li><p><strong>Ntimes</strong> -- Pointer to store extracted Ntimes value </p></li>
<li><p><strong>tfinal</strong> -- Pointer to store extracted tfinal value </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if successful, 0 if unable to parse </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413parseSaveArgsiA_PcPi">
<span class="target" id="nsphere_8c_1a344694a6ad4d30409cb375f274e47199"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parseSaveArgs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">argc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">argv</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pIndex</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413parseSaveArgsiA_PcPi" title="Link to this definition"></a><br /></dt>
<dd><p>Parses sub-arguments for the <code class="docutils literal notranslate"><span class="pre">--save</span></code> command-line option. </p>
<p>This function is called when the <code class="docutils literal notranslate"><span class="pre">--save</span></code> option is encountered during command-line argument parsing. It reads subsequent arguments (until another option starting with '-' is found, or arguments end) which specify the level or type of data to save. It then sets the corresponding global data output flags (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>) based on the highest priority valid sub-argument encountered. Valid sub-arguments and their priority (lowest to highest):<ul class="simple">
<li><p>&quot;raw-data&quot;: Enables <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>.</p></li>
<li><p>&quot;psi-snaps&quot;: Enables <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>.</p></li>
<li><p>&quot;full-snaps&quot;: Enables <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>.</p></li>
<li><p>&quot;all&quot; or &quot;debug-energy&quot;: Enables all flags (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>).</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits the program with an error message if an unknown sub-argument to <code class="docutils literal notranslate"><span class="pre">--save</span></code> is found. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argc</strong> -- [in] The total argument count from <code class="docutils literal notranslate"><span class="pre">main()</span></code>. </p></li>
<li><p><strong>argv</strong> -- [in] The argument array from <code class="docutils literal notranslate"><span class="pre">main()</span></code>. </p></li>
<li><p><strong>pIndex</strong> -- [in,out] Pointer to the current index in <code class="docutils literal notranslate"><span class="pre">argv</span></code>. On input, it points to the <code class="docutils literal notranslate"><span class="pre">--save</span></code> option. On output, it is updated to point to the last sub-argument consumed by this function. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422perform_scatter_updatePPdiiP7gsl_rng">
<span class="target" id="nsphere_8c_1a07bf4c6df539d29601ebcefaf60ecca9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">perform_scatter_update</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">j</span></span>, <span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rng</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422perform_scatter_updatePPdiiP7gsl_rng" title="Link to this definition"></a><br /></dt>
<dd><p>Helper function to perform scatter update for two particles. </p>
<p>Updates velocities and angular components for both particles after a scattering event. The graph coloring algorithm uses this function to directly update particle states, avoiding intermediate buffering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- Particle data arrays </p></li>
<li><p><strong>i</strong> -- First particle index </p></li>
<li><p><strong>j</strong> -- Second particle index </p></li>
<li><p><strong>rng</strong> -- Random number generator for scattering angles </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv443perform_sidm_scattering_parallel_graphcolorPPdiddPP7gsl_rngiPxddPi">
<span class="target" id="nsphere_8c_1ae6726d3a1e5e75bee3ba452e4bb0b454"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">perform_sidm_scattering_parallel_graphcolor</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_time</span></span>, <span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rng_per_thread_list</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads_for_rng</span></span>, <span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Nscatter_total_step</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_for_sidm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_for_sidm</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">current_scatter_counts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv443perform_sidm_scattering_parallel_graphcolorPPdiddPP7gsl_rngiPxddPi" title="Link to this definition"></a><br /></dt>
<dd><p>Performs SIDM scattering calculations for one timestep using graph coloring parallel algorithm. </p>
<p>Implements a parallel SIDM scattering algorithm using graph coloring to eliminate race conditions. Particles are divided into 11 color groups where particles of the same color are separated by more than the interaction range (&gt;10 positions), ensuring no conflicts. Each color is processed sequentially, but particles within a color are processed in parallel with direct state updates and no synchronization overhead.</p>
<p><strong>Azimuthal Angle Treatment:</strong> Uses persistent azimuthal angle storage (cos(), sin()) in <code class="docutils literal notranslate"><span class="pre">particles[5]</span></code> and <code class="docutils literal notranslate"><span class="pre">particles[6]</span></code>. These values are initialized randomly at simulation start and updated only during scattering events. Between scatters,  remains constant (no orbital precession tracking). This approximation is physically valid because in high-scatter regimes  evolves minimally between events, while in low-scatter regimes stochastic partner selection and orbital dynamics erase correlations from prior scatters. This approach maintains accuracy while avoiding costly per-timestep random number generation.</p>
<p><strong>Graph Coloring Algorithm:</strong><ol class="loweralpha simple">
<li><p>Divides particles into 11 colors (modulo arithmetic: color = i % 11).</p></li>
<li><p>Processes each color sequentially to prevent neighbor conflicts.</p></li>
<li><p>Within each color, processes particles in parallel with per-thread RNGs.</p></li>
<li><p>For each particle: a. Loads persistent  orientation from stored cos(), sin(). b. Evaluates scattering probability with neighbors using 3D relative velocities. c. If scatter occurs: performs isotropic scattering, updates velocities and  storage. d. Updates <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code> for AB3 integrator compatibility.</p></li>
</ol>
</p>
<p>This design achieves high parallel efficiency without race conditions or atomic operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] Main particle data array: <code class="docutils literal notranslate"><span class="pre">particles[component][current_sorted_index]</span></code>. Modified in-place with post-scattering velocities/angular momenta. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>dt</strong> -- [in] Simulation timestep (Myr), used in probability calculation. </p></li>
<li><p><strong>current_time</strong> -- [in] Current simulation time (Myr). Marked <code class="docutils literal notranslate"><span class="pre">unused</span></code> but available for future use. </p></li>
<li><p><strong>rng_per_thread_list</strong> -- [in] Array of GSL RNG states, one for each OpenMP thread. </p></li>
<li><p><strong>num_threads_for_rng</strong> -- [in] The number of allocated RNGs in <code class="docutils literal notranslate"><span class="pre">rng_per_thread_list</span></code> (equals max threads). </p></li>
<li><p><strong>Nscatter_total_step</strong> -- [out] Pointer to a long long to accumulate the total number of scatter events that occurred in this timestep. </p></li>
<li><p><strong>halo_mass_for_sidm</strong> -- [in] Total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>rc_for_sidm</strong> -- [in] Scale radius (kpc) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>current_scatter_counts</strong> -- [in,out] Per-particle scatter count array for tracking (can be NULL). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430perform_sidm_scattering_serialPPdiddP7gsl_rngPxddPi">
<span class="target" id="nsphere_8c_1aa610b1966ced5bd9fc93909793372ef4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">perform_sidm_scattering_serial</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_time</span></span>, <span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rng</span></span>, <span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Nscatter_total_step</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_for_sidm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_for_sidm</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">current_scatter_counts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430perform_sidm_scattering_serialPPdiddP7gsl_rngPxddPi" title="Link to this definition"></a><br /></dt>
<dd><p>Executes self-interacting dark matter (SIDM) scattering for one simulation timestep (Serial version). </p>
<p>Implements a serial SIDM scattering algorithm with persistent azimuthal angle tracking. For each particle <code class="docutils literal notranslate"><span class="pre">i</span></code> (the primary scatterer), it considers up to <code class="docutils literal notranslate"><span class="pre">nscat</span></code> (typically 10) subsequent particles in the array as potential scattering partners. The <code class="docutils literal notranslate"><span class="pre">particles</span></code> array is sorted by radius, making these neighbors spatially proximate.</p>
<p><strong>Azimuthal Angle Treatment:</strong> The azimuthal angle  for each particle's perpendicular velocity is stored persistently as cos() and sin() in <code class="docutils literal notranslate"><span class="pre">particles[5]</span></code> and <code class="docutils literal notranslate"><span class="pre">particles[6]</span></code>. These values are initialized randomly at simulation start and updated only during scattering events. Between scatters,  remains constant (no orbital precession tracking). This approximation is valid because:<ul class="simple">
<li><p>In high-scatter regimes,  evolves minimally between frequent scattering events.</p></li>
<li><p>In low-scatter regimes, stochastic partner selection and orbital dynamics erase correlations from prior scattering history. This approach maintains physical accuracy while avoiding costly random number generation at every timestep.</p></li>
</ul>
</p>
<p><strong>Algorithm Steps:</strong><ol class="loweralpha simple">
<li><p>Loads persistent  orientation (cos(), sin()) from <code class="docutils literal notranslate"><span class="pre">particles[5]</span></code> and <code class="docutils literal notranslate"><span class="pre">particles[6]</span></code>.</p></li>
<li><p>For each of the <code class="docutils literal notranslate"><span class="pre">nscat</span></code> potential partners <code class="docutils literal notranslate"><span class="pre">m</span></code>: a. Loads partner's  orientation and calculates relative azimuthal separation. b. Computes 3D relative velocity <span class="math notranslate nohighlight">\(v_{rel}\)</span> using Law of Cosines. c. Calculates interaction rate <span class="math notranslate nohighlight">\(\Gamma_m = \sigma(v_{rel}) v_{rel}\)</span>. d. Accumulates total interaction rate <span class="math notranslate nohighlight">\(\Gamma_{tot} = \sum \Gamma_m\)</span>.</p></li>
<li><p>Estimates local particle number density using shell volume approximation.</p></li>
<li><p>Calculates scattering probability: <span class="math notranslate nohighlight">\(P_{scatter} = 1 - \exp(-\Gamma_{tot} \times dt / (2V_{shell}))\)</span>.</p></li>
<li><p>If scatter occurs (stochastic decision): a. Selects partner weighted by individual <span class="math notranslate nohighlight">\(\Gamma_m\)</span> contributions. b. Performs isotropic scattering in center-of-mass frame. c. Updates both particles' velocities (radial and perpendicular components). d. Updates persistent  storage (cos(), sin()) for both particles. e. Sets <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code> flags for AB3 integrator history management.</p></li>
</ol>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] Main particle data array: <code class="docutils literal notranslate"><span class="pre">particles[component][current_sorted_index]</span></code>. Modified in-place with post-scattering velocities/angular momenta. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of simulation particles. </p></li>
<li><p><strong>dt</strong> -- [in] Integration timestep (Myr). </p></li>
<li><p><strong>current_time</strong> -- [in] Current simulation time (Myr). Marked <code class="docutils literal notranslate"><span class="pre">unused</span></code> but available. </p></li>
<li><p><strong>rng</strong> -- [in] GSL random number generator instance for all stochastic processes. </p></li>
<li><p><strong>Nscatter_total_step</strong> -- [out] Pointer to a long long to accumulate total scattering events this timestep. </p></li>
<li><p><strong>halo_mass_for_sidm</strong> -- [in] Total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>rc_for_sidm</strong> -- [in] Scale radius (kpc) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>current_scatter_counts</strong> -- [in,out] Per-particle scatter count array for tracking (can be NULL). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419potential_hernquistddd">
<span class="target" id="nsphere_8c_1af0e7b15d046643c4168151757353fe87"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">potential_hernquist</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">M</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419potential_hernquistddd" title="Link to this definition"></a><br /></dt>
<dd><p>Analytical potential for the Hernquist profile. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- Radius (kpc). </p></li>
<li><p><strong>M</strong> -- Total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). </p></li>
<li><p><strong>a</strong> -- Scale radius <span class="math notranslate nohighlight">\(a\)</span> of the Hernquist profile (kpc). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Gravitational potential in code units of (kpc/Myr) <span class="math notranslate nohighlight">\(^2\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410printUsagePKc">
<span class="target" id="nsphere_8c_1a85fda61d19f17f9567ee500e54d7e78e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">printUsage</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prog</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410printUsagePKc" title="Link to this definition"></a><br /></dt>
<dd><p>Displays detailed usage information for command-line arguments. </p>
<p>Prints a comprehensive help message to stderr showing all available command-line options, their default values, and brief descriptions. Includes information about integration methods, sorting algorithms, data saving modes, and basic usage examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Called when the user specifies <code class="docutils literal notranslate"><span class="pre">--help</span></code> or when errors occur during argument parsing. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prog</strong> -- [in] The program name to display in the usage message (typically argv[0]).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413prompt_yes_noPKc">
<span class="target" id="nsphere_8c_1a96756bc10475202e578c85a8dbce8045"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">prompt_yes_no</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prompt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413prompt_yes_noPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Prompts the user with a yes/no question and reads their response from stdin. </p>
<p>Displays the given <code class="docutils literal notranslate"><span class="pre">prompt</span></code> string followed by &quot;[y/N]: &quot;. Reads a line of input from the user.<ul class="simple">
<li><p>Returns 1 (yes) if the first character of the input is 'y' or 'Y'.</p></li>
<li><p>Returns 0 (no) if the first character is 'n', 'N', or if the input is an empty line (user just pressed Enter, defaulting to No).</p></li>
<li><p>If any other input is received, the prompt is repeated. Handles potential EOF or read errors by defaulting to No.</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prompt</strong> -- [in] The question/prompt message to display to the user. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 if the user confirms (yes), 0 otherwise (no/default). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412PsiintegranddPv">
<span class="target" id="nsphere_8c_1af5fd16c6b624d8d23a609134ed75bb0a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psiintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rp</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412PsiintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for calculating gravitational potential. </p>
<p>Computes the integrand required for the integral term in the potential calculation, <span class="math notranslate nohighlight">\(\Psi(r)\)</span>. This function acts as a dispatcher, calling the appropriate profile-specific mass integrand via a function pointer provided in the <code class="docutils literal notranslate"><span class="pre">params</span></code> struct.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#struct_psiintegrand__params"><span class="std std-ref">Psiintegrand_params</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a486e09e9ff56866413bdfb973b8172ce"><span class="std std-ref">massintegrand</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a8e33f50ec202f76ee9185c55123dd196"><span class="std std-ref">massintegrand_profile_nfwcutoff</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rp</strong> -- The radial integration variable <span class="math notranslate nohighlight">\(r'\)</span> (kpc). </p></li>
<li><p><strong>params</strong> -- Void pointer to a <code class="docutils literal notranslate"><a class="reference internal" href="#struct_psiintegrand__params"><span class="std std-ref"><span class="pre">Psiintegrand_params</span></span></a></code> struct, which contains the function pointer to the profile's mass integrand. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The value of the potential integrand at <code class="docutils literal notranslate"><span class="pre">rp</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422quadsort_parallel_sortPPdi">
<span class="target" id="nsphere_8c_1af20d2b892dfa310cbf845403a905796e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_parallel_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422quadsort_parallel_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Parallel quadsort implementation using chunk-based approach with overlap. </p>
<p>Uses quadsort algorithm for both initial chunk sorting and seam fixing, providing better performance than insertion sort for large datasets while maintaining sort stability.</p>
<p>
Parallel implementation of quadsort algorithm optimized for particle sorting.</p>
<p>Uses multiple OpenMP threads to sort sections of particle data in parallel, followed by seam-fixing operations to ensure global ordering. Includes dynamic section calculation and optimized overlap sizing based on chunk characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort</p></li>
<li><p><strong>columns</strong> -- Column-major data array [particle][component] </p></li>
<li><p><strong>n</strong> -- Number of particles to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416quadsort_wrapperPPdi">
<span class="target" id="nsphere_8c_1ae61a8488ea1cc6e78d15b9a6412a7ac4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416quadsort_wrapperPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper for the external quadsort algorithm. </p>
<p>Provides a consistent interface to the external quadsort function, which is typically faster than standard quicksort for many distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423read_initial_conditionsPPdiPKc">
<span class="target" id="nsphere_8c_1a5dd148939766228831427e02bb7e122d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_initial_conditions</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423read_initial_conditionsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Reads particle initial conditions from a binary file. </p>
<p>Loads the complete particle state (radius, velocity, angular momentum, original index, orientation parameter <span class="math notranslate nohighlight">\(\mu\)</span>) from a binary file previously created by <code class="docutils literal notranslate"><span class="pre">write_initial_conditions</span></code>. Verifies that the number of particles read from the file matches the expected count <code class="docutils literal notranslate"><span class="pre">npts</span></code>. Opens the file in read binary mode (&quot;rb&quot;).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1aca344a26cf5ac4e75f3e48f402260df8"><span class="std std-ref">write_initial_conditions</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Expects 7 variables per particle. See <code class="docutils literal notranslate"><span class="pre">write_initial_conditions</span></code> for file format details. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the file cannot be opened, if the particle count does not match <code class="docutils literal notranslate"><span class="pre">npts</span></code> (returns early), or if a read error occurs.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [out] 2D array to store loaded particle properties [component][particle_index]. Must be pre-allocated with dimensions [7][npts]. </p></li>
<li><p><strong>npts</strong> -- [in] Expected number of particles to read. </p></li>
<li><p><strong>filename</strong> -- [in] Path to the input binary file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427reassign_orig_ids_with_rankPdi">
<span class="target" id="nsphere_8c_1aa4b092fc3980d0bddf5571fb4e2ea26c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reassign_orig_ids_with_rank</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">orig_ids</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427reassign_orig_ids_with_rankPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Remaps particle IDs to zero-based rank order within the current particle set. </p>
<p>Typically used after tidal stripping where a subset of particles remains. The <code class="docutils literal notranslate"><span class="pre">orig_ids</span></code> array contains potentially non-contiguous IDs of the <code class="docutils literal notranslate"><span class="pre">n</span></code> remaining particles. Sorts these IDs and replaces each with its rank (0 to n-1) within the sorted sequence. Transforms arbitrary ID values into a compact, contiguous sequence of rank IDs. The input <code class="docutils literal notranslate"><span class="pre">orig_ids</span></code> array (which is <code class="docutils literal notranslate"><span class="pre">particles[3]</span></code> in <code class="docutils literal notranslate"><span class="pre">main</span></code>) is modified in-place.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses <code class="docutils literal notranslate"><span class="pre">qsort</span></code> and a temporary array for sorting. Exits via <code class="docutils literal notranslate"><span class="pre">exit(1)</span></code> if memory allocation for the temporary array fails. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orig_ids</strong> -- [in,out] Pointer to an array of particle IDs (stored as doubles). These are modified in-place to become rank IDs. </p></li>
<li><p><strong>n</strong> -- [in] The number of elements in the <code class="docutils literal notranslate"><span class="pre">orig_ids</span></code> array (i.e., <code class="docutils literal notranslate"><span class="pre">npts</span></code> after stripping). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv434retrieve_all_particle_phi_snapshotPKciiiPf">
<span class="target" id="nsphere_8c_1af38ec12c0bc83111b87183db138252cd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">retrieve_all_particle_phi_snapshot</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snap</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">phi_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv434retrieve_all_particle_phi_snapshotPKciiiPf" title="Link to this definition"></a><br /></dt>
<dd><p>Retrieves particle phi angles for a specific snapshot from the <code class="docutils literal notranslate"><span class="pre">all_particle_phi.dat</span></code> binary file. </p>
<p>This function reads the phi angle data for all <code class="docutils literal notranslate"><span class="pre">npts</span></code> particles corresponding to a single snapshot number (<code class="docutils literal notranslate"><span class="pre">snap</span></code>) from the specified binary file. The file is expected to be in step-major order, where each record per particle consists of a single float (phi). It calculates the correct file offset to seek to the desired snapshot. To ensure thread safety when called in parallel (e.g., during post-processing of snapshots), file I/O (seeking and reading) is performed within an OpenMP critical section named <code class="docutils literal notranslate"><span class="pre">file_access_phi</span></code>. Temporary local buffers are used for reading, and data is then copied to the caller-provided output array.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref"><span class="pre">CLEAN_EXIT(1)</span></span></a></code> on memory allocation failure, file open failure, fseek failure, or unexpected EOF. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the binary phi data file (e.g., &quot;data/all_particle_phi&lt;suffix&gt;.dat&quot;). </p></li>
<li><p><strong>snap</strong> -- [in] The snapshot number (0-indexed, corresponding to write events) to retrieve. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles per snapshot. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of snapshots written per block to file. </p></li>
<li><p><strong>phi_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved phi angle values. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf">
<span class="target" id="nsphere_8c_1acce6775e508269e301b9fdc90f71babf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">retrieve_all_particle_snapshot</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snap</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">L_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Rank_out</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">R_out</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Vrad_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf" title="Link to this definition"></a><br /></dt>
<dd><p>Retrieves particle data for a specific snapshot from the <code class="docutils literal notranslate"><span class="pre">all_particle_data.dat</span></code> binary file. </p>
<p>This function reads the data (rank, radius, radial velocity, angular momentum) for all <code class="docutils literal notranslate"><span class="pre">npts</span></code> particles corresponding to a single snapshot number (<code class="docutils literal notranslate"><span class="pre">snap</span></code>) from the specified binary file. The file is expected to be in step-major order, where each record per particle consists of an int (rank) and three floats (R, Vrad, L). It calculates the correct file offset to seek to the desired snapshot. To ensure thread safety when called in parallel (e.g., during post-processing of snapshots), file I/O (seeking and reading) is performed within an OpenMP critical section named <code class="docutils literal notranslate"><span class="pre">file_access</span></code>. Temporary local buffers are used for reading, and data is then copied to the caller-provided output arrays.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref"><span class="pre">CLEAN_EXIT(1)</span></span></a></code> on memory allocation failure, file open failure, fseek failure, or unexpected EOF. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the binary data file (e.g., &quot;data/all_particle_data&lt;suffix&gt;.dat&quot;). </p></li>
<li><p><strong>snap</strong> -- [in] The snapshot number (0-indexed, corresponding to write events) to retrieve. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles per snapshot. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of snapshots written per block by <code class="docutils literal notranslate"><span class="pre">append_all_particle_data_chunk_to_file</span></code>. Determines seek offset calculation. </p></li>
<li><p><strong>L_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved angular momentum values. </p></li>
<li><p><strong>Rank_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved particle ranks. </p></li>
<li><p><strong>R_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved radial positions. </p></li>
<li><p><strong>Vrad_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved radial velocities. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421save_chosen_particlesPKcPiiPii">
<span class="target" id="nsphere_8c_1a6e455a6bb7cf4a92c988145191a301c8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">save_chosen_particles</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">chosen</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlowest</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">traj_ids</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n_traj</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421save_chosen_particlesPKcPiiPii" title="Link to this definition"></a><br /></dt>
<dd><p>Save chosen particle IDs to a binary file. </p>
<p>This function saves particle IDs for multiple trajectory tracking systems to ensure continuity across restart and extend operations. It writes two sets of particle IDs: one for particles selected based on lowest angular momentum, and another for particles tracked by their original ID for general trajectory analysis.</p>
<p>The binary file format consists of:<ul class="simple">
<li><p>Header (8 bytes):<ul>
<li><p>int32: num_lowestl - Number of particles with lowest angular momentum</p></li>
<li><p>int32: num_trajectories - Number of particles for general trajectory tracking</p></li>
</ul>
</p></li>
<li><p>Data section:<ul>
<li><p>int32[num_lowestl]: Particle IDs selected by lowest angular momentum</p></li>
<li><p>int32[num_trajectories]: Particle IDs for general trajectory tracking</p></li>
</ul>
</p></li>
</ul>
</p>
<p>The lowest_l particles are used by lowest_l_trajectories.dat which tracks radius, energy, and angular momentum for these specific particles over time. The trajectory particles are used by trajectories.dat which tracks radius, velocity, and mu for the specified particles by their original ID. The file single_trajectory.dat uses only the first particle ID from the trajectory list.</p>
<p>This file is essential for maintaining consistent particle tracking when simulations are restarted or extended, ensuring that the same particles continue to be monitored.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref">CLEAN_EXIT(1)</span></a> if file creation fails. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the output binary file (e.g., &quot;data/chosen_particles_&lt;suffix&gt;.dat&quot;) </p></li>
<li><p><strong>chosen</strong> -- [in] Array of particle IDs that have the lowest angular momentum values </p></li>
<li><p><strong>nlowest</strong> -- [in] Number of lowest angular momentum particles to save </p></li>
<li><p><strong>traj_ids</strong> -- [in] Array of particle IDs to track in trajectories.dat </p></li>
<li><p><strong>n_traj</strong> -- [in] Number of trajectory particles to save </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410sigmatotaldidd">
<span class="target" id="nsphere_8c_1abdd2f3ea3887502b8d8a56774b24446e"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sigmatotal</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vrel</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_for_calc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_for_calc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410sigmatotaldidd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the self-interacting dark matter (SIDM) scattering cross-section. </p>
<p>Implements a velocity-independent cross-section model where the opacity <span class="math notranslate nohighlight">\(\sigma/m = \kappa\)</span> is constant. The function uses the global variable <code class="docutils literal notranslate"><span class="pre">g_sidm_kappa</span></code> for the opacity <span class="math notranslate nohighlight">\(\kappa\)</span>. The total cross-section <span class="math notranslate nohighlight">\(\sigma\)</span> scales with the individual particle mass, <span class="math notranslate nohighlight">\(m_{particle}\)</span>, derived from the total <code class="docutils literal notranslate"><span class="pre">halo_mass_for_calc</span></code> and the number of particles <code class="docutils literal notranslate"><span class="pre">npts</span></code>. The function includes unit conversions to return the cross-section in simulation units (kpc <span class="math notranslate nohighlight">\(^2\)</span>).</p>
<p>Unit Conversion Detail: <span class="math notranslate nohighlight">\(\kappa\)</span> (cm/g) <span class="math notranslate nohighlight">\(\times m_{particle}\)</span> ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>) <span class="math notranslate nohighlight">\(\rightarrow \sigma\)</span> (kpc) The conversion factor is <span class="math notranslate nohighlight">\(2.089 \times 10^{-10} \text{ (kpc}^2 \text{ } M_{\odot}^{-1}) / (\text{cm}^2 \text{ g}^{-1})\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vrel</strong> -- [in] Relative velocity between particles (kpc/Myr). This parameter is unused in the velocity-independent model. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of simulation particles, used for calculating <span class="math notranslate nohighlight">\(m_{particle}\)</span>. </p></li>
<li><p><strong>halo_mass_for_calc</strong> -- [in] Total halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>) for the active profile, used for <span class="math notranslate nohighlight">\(m_{particle}\)</span>. </p></li>
<li><p><strong>rc_for_calc</strong> -- [in] Scale radius (kpc) of the active profile. This parameter is unused in the velocity-independent model. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double Total scattering cross-section <span class="math notranslate nohighlight">\(\sigma\)</span> in kpc <span class="math notranslate nohighlight">\(^2\)</span>. Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">npts</span></code> or the calculated <code class="docutils literal notranslate"><span class="pre">particle_mass_Msun</span></code> is non-positive. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411sort_by_radP8PartDatai">
<span class="target" id="nsphere_8c_1aa18960860d11c051e4088aac179282a7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_by_rad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv48PartData" title="PartData"><span class="n"><span class="pre">PartData</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411sort_by_radP8PartDatai" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data in ascending order by radial position. </p>
<p>Sorts an array of <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures by their radial position (<code class="docutils literal notranslate"><span class="pre">rad</span></code>).</p>
<p>Performs a quick sort of the particle data structure array, using the radial position as the primary sorting key. Preserves the original indices to allow tracking particles across time steps.</p>
<p>
Uses the standard library <code class="docutils literal notranslate"><span class="pre">qsort</span></code> function with <code class="docutils literal notranslate"><span class="pre">compare_partdata_by_rad</span></code> as the comparison function. Includes basic safety checks for NULL array or non-positive <code class="docutils literal notranslate"><span class="pre">npts</span></code>. The sort is performed in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> -- Array of particle data structures to be sorted </p></li>
<li><p><strong>npts</strong> -- Number of particles in the array</p></li>
<li><p><strong>array</strong> -- [in,out] Array of <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures to be sorted. </p></li>
<li><p><strong>npts</strong> -- [in] Number of elements in the array. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414sort_particlesPPdi">
<span class="target" id="nsphere_8c_1ac80dacfe069ec441f196ff860e1e1455"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_particles</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414sort_particlesPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Convenience wrapper function for sorting particles with the default algorithm. </p>
<p>Calls sort_particles_with_alg using the default sorting algorithm specified in g_defaultSortAlg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] 2D array of particle data to be sorted [component][particle]. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles to sort. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423sort_particles_with_algPPdiPKc">
<span class="target" id="nsphere_8c_1a5a75c173db8a8ac46fd63b324b865771"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_particles_with_alg</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sortAlg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423sort_particles_with_algPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Main function for sorting particle data using a specified algorithm. </p>
<p>Transposes the data format from particles[component][particle] to columns[particle][component], applies the specified sorting algorithm, and then transposes back to the original format.</p>
<p>
Sorts particle data using the specified sorting algorithm.</p>
<p>Performs a three-phase particle sorting operation:<ol class="loweralpha simple">
<li><p>Data transposition to a persistent, column-major buffer.</p></li>
<li><p>Application of the selected sorting algorithm on the buffer.</p></li>
<li><p>Reverse transposition of the sorted data back to the original array.</p></li>
</ol>
</p>
<p>The function uses a persistent global buffer (<code class="docutils literal notranslate"><span class="pre">g_sort_columns_buffer</span></code>) to minimize memory allocation/deallocation overhead across repeated sort calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- 2D array of particle data to be sorted [component][particle] </p></li>
<li><p><strong>npts</strong> -- Number of particles to sort </p></li>
<li><p><strong>sortAlg</strong> -- String identifier of the sorting algorithm to use (&quot;quadsort&quot;, &quot;quadsort_parallel&quot;, or default to &quot;insertion_parallel&quot;)</p></li>
<li><p><strong>particles</strong> -- 2D array of particle data to be sorted [component][particle] </p></li>
<li><p><strong>npts</strong> -- Number of particles to sort </p></li>
<li><p><strong>sortAlg</strong> -- Sorting algorithm to use (&quot;quadsort&quot;, &quot;quadsort_parallel&quot;, &quot;insertion&quot;, or &quot;insertion_parallel&quot;) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418sort_rr_psi_arraysPdPdi">
<span class="target" id="nsphere_8c_1ae161185b8c5832ffaf4c6a6c3b87bbbb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_rr_psi_arrays</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rrA_spline</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">psiAarr_spline</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418sort_rr_psi_arraysPdPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts radius and potential arrays in tandem, maintaining their correspondence. </p>
<p>This function takes an array of radial coordinates (<code class="docutils literal notranslate"><span class="pre">rrA_spline</span></code>) and an array of corresponding potential values (<code class="docutils literal notranslate"><span class="pre">psiAarr_spline</span></code>). It sorts <code class="docutils literal notranslate"><span class="pre">rrA_spline</span></code> in ascending order and applies the identical swaps to <code class="docutils literal notranslate"><span class="pre">psiAarr_spline</span></code>, ensuring that <code class="docutils literal notranslate"><span class="pre">psiAarr_spline[i]</span></code> still corresponds to <code class="docutils literal notranslate"><span class="pre">rrA_spline[i]</span></code> after sorting. This is crucial for creating GSL splines where the x-array must be strictly monotonic and the y-array must maintain its pairing with the x-values. The arrays are assumed to have <code class="docutils literal notranslate"><span class="pre">npts</span></code> elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rrA_spline</strong> -- [in,out] Array of radial coordinates to be sorted. Modified in-place. </p></li>
<li><p><strong>psiAarr_spline</strong> -- [in,out] Array of corresponding Psi values. Modified in-place in tandem with <code class="docutils literal notranslate"><span class="pre">rrA_spline</span></code>. </p></li>
<li><p><strong>npts</strong> -- The number of points in the arrays (arrays are of size <code class="docutils literal notranslate"><span class="pre">npts</span></code>). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420stdlib_qsort_wrapperPPdi">
<span class="target" id="nsphere_8c_1a5054402587a6df1b0a3eaf1b197fee26"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stdlib_qsort_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420stdlib_qsort_wrapperPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper for the standard C library quicksort function. </p>
<p>Provides a consistent interface to the standard library <code class="docutils literal notranslate"><span class="pre">qsort</span></code> function using the <code class="docutils literal notranslate"><span class="pre">compare_particles</span></code> function as the comparison callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted (passed as <code class="docutils literal notranslate"><span class="pre">double**</span></code>). </p></li>
<li><p><strong>n</strong> -- Number of elements (particles) to sort. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419store_debug_approxEidd">
<span class="target" id="nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">store_debug_approxE</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapIndex</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time_val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419store_debug_approxEidd" title="Link to this definition"></a><br /></dt>
<dd><p>Records the theoretical model energy for a debug snapshot. </p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"><span class="std std-ref">store_debug_dynE_components</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1219b4779e99559d4045950efce1739a"><span class="std std-ref">finalize_debug_energy_output</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updates <code class="docutils literal notranslate"><span class="pre">dbg_count</span></code> if <code class="docutils literal notranslate"><span class="pre">snapIndex</span></code> extends the recorded range. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapIndex</strong> -- [in] Index of the snapshot (0 to DEBUG_MAX_STEPS - 1). </p></li>
<li><p><strong>E_value</strong> -- [in] Theoretical energy value (per unit mass). </p></li>
<li><p><strong>time_val</strong> -- [in] Simulation time (Myr).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427store_debug_dynE_componentsiddddd">
<span class="target" id="nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">store_debug_dynE_components</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapIndex</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">totalE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">kinE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">potE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time_val</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427store_debug_dynE_componentsiddddd" title="Link to this definition"></a><br /></dt>
<dd><p>Records the actual dynamical energy and its components for a debug snapshot. </p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"><span class="std std-ref">store_debug_approxE</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1219b4779e99559d4045950efce1739a"><span class="std std-ref">finalize_debug_energy_output</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updates <code class="docutils literal notranslate"><span class="pre">dbg_count</span></code> if <code class="docutils literal notranslate"><span class="pre">snapIndex</span></code> extends the recorded range. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapIndex</strong> -- [in] Index of the snapshot (0 to DEBUG_MAX_STEPS - 1). </p></li>
<li><p><strong>totalE</strong> -- [in] Total energy (KE + PE) per unit mass. </p></li>
<li><p><strong>kinE</strong> -- [in] Kinetic energy component (per unit mass). </p></li>
<li><p><strong>potE</strong> -- [in] Potential energy component (per unit mass). </p></li>
<li><p><strong>time_val</strong> -- [in] Simulation time (Myr). </p></li>
<li><p><strong>radius_val</strong> -- [in] Particle radius (kpc).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426truncate_files_to_snapshotiiiiiPKc">
<span class="target" id="nsphere_8c_1a532b4b6e3f9a53b79a4588dac99691b8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">truncate_files_to_snapshot</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">last_snapshot</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dtwrite</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_traj_particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nlowest</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">file_suffix</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426truncate_files_to_snapshotiiiiiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Truncate all output files to the last common complete snapshot. </p>
<p>Ensures all files are consistent for restart by removing partial data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>last_snapshot</strong> -- The last complete snapshot to keep (0-based) </p></li>
<li><p><strong>npts</strong> -- Number of particles </p></li>
<li><p><strong>dtwrite</strong> -- Timestep interval for writes </p></li>
<li><p><strong>num_traj_particles</strong> -- Number of trajectory particles </p></li>
<li><p><strong>nlowest</strong> -- Number of lowest-L particles </p></li>
<li><p><strong>file_suffix</strong> -- The file suffix string </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>0 on success, -1 on error </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419verify_sort_resultsPPdiPKc">
<span class="target" id="nsphere_8c_1a7569fb12f08ce841608a7c3e54a0ad19"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">verify_sort_results</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">label</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419verify_sort_resultsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Validates sorting results by comparing with standard qsort. </p>
<p>Creates a copy of the input array, sorts it with standard qsort, then compares the results element by element to verify that the sorting algorithm produced the expected ordering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data that has been sorted </p></li>
<li><p><strong>n</strong> -- Number of elements in the array </p></li>
<li><p><strong>label</strong> -- Name of the sorting algorithm for diagnostic output </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424write_initial_conditionsPPdiPKc">
<span class="target" id="nsphere_8c_1aca344a26cf5ac4e75f3e48f402260df8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_initial_conditions</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424write_initial_conditionsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Writes particle initial conditions to a binary file. </p>
<p>Stores the complete initial particle state (radius, velocity, angular momentum, original index, orientation parameter <span class="math notranslate nohighlight">\(\mu\)</span>) and the particle count (<code class="docutils literal notranslate"><span class="pre">npts</span></code>) to a binary file for later retrieval via <code class="docutils literal notranslate"><span class="pre">read_initial_conditions</span></code>. Opens the file in write binary mode (&quot;wb&quot;). First writes the integer <code class="docutils literal notranslate"><span class="pre">npts</span></code>, then writes the 5 double-precision values for each particle sequentially.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a5dd148939766228831427e02bb7e122d"><span class="std std-ref">read_initial_conditions</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The binary file format is: <code class="docutils literal notranslate"><span class="pre">npts</span></code> (int32), followed by <code class="docutils literal notranslate"><span class="pre">npts</span></code> records, each consisting of 7 <code class="docutils literal notranslate"><span class="pre">double</span></code> values: (radius, velocity, ang. mom., orig. index, mu, cos_phi, sin_phi). cos_phi and sin_phi are the cosine and sine of the azimuthal angle used for SIDM scattering. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the file cannot be opened.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in] 2D array containing particle properties [component][particle_index]. Expected components: 0=rad, 1=vel, 2=angmom, 3=orig_idx, 4=mu. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles to write. </p></li>
<li><p><strong>filename</strong> -- [in] Path to the output binary file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-variables">Variables</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv46chosen">
<span class="target" id="nsphere_8c_1a01d2e68fbc1f506be8cc06e896b620e0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">chosen</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv46chosen" title="Link to this definition"></a><br /></dt>
<dd><p>Array of indices (original IDs) for selected low-L particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411dbg_approxE">
<span class="target" id="nsphere_8c_1a5bb6373db7244f6d2891a3221d366785"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_approxE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv411dbg_approxE" title="Link to this definition"></a><br /></dt>
<dd><p>Arrays for tracking energy components through simulation for debugging. </p>
<p>Theoretical model energy (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49dbg_count">
<span class="target" id="nsphere_8c_1aa7285a020bc6f18e415d9537d2cdcfbe"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv49dbg_count" title="Link to this definition"></a><br /></dt>
<dd><p>Tracks the number of recorded debug snapshots. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_dynE">
<span class="target" id="nsphere_8c_1ac9cbd2043d21d1cc89ff1fc00d2a1460"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_dynE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_dynE" title="Link to this definition"></a><br /></dt>
<dd><p>Actual dynamical energy (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_kinE">
<span class="target" id="nsphere_8c_1a88f1da0ce13577814bbeb1e1fc08feb4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_kinE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_kinE" title="Link to this definition"></a><br /></dt>
<dd><p>Kinetic energy component (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_potE">
<span class="target" id="nsphere_8c_1a05fb53ef0323425e63e369bb5bf02d37"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_potE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_potE" title="Link to this definition"></a><br /></dt>
<dd><p>Potential energy component (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410dbg_radius">
<span class="target" id="nsphere_8c_1a3aa1bbdbd292c666a49c2c0414639c3a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_radius</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv410dbg_radius" title="Link to this definition"></a><br /></dt>
<dd><p>Particle radius at each snapshot (kpc). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_time">
<span class="target" id="nsphere_8c_1a5b8302c505609113d15735532f252bb5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_time</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_time" title="Link to this definition"></a><br /></dt>
<dd><p>Simulation time at each snapshot (Myr). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424debug_direct_convolution">
<span class="target" id="nsphere_8c_1a4a1f369af4feb2852a5bddbace1948b9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">debug_direct_convolution</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv424debug_direct_convolution" title="Link to this definition"></a><br /></dt>
<dd><p>Convolution method selection for density smoothing. </p>
<p>Controls the convolution method selection for density smoothing.</p>
<p>0 = FFT-based convolution (default, faster for large datasets). 1 = Direct spatial convolution (more accurate but slower).</p>
<p>Global flag that determines whether to use direct convolution (1) or FFT-based convolution (0). Direct convolution is more accurate but slower for large grids, while FFT-based convolution is faster but may introduce artifacts.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External declaration, defined elsewhere. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410doReadInit">
<span class="target" id="nsphere_8c_1a65de5bd03df8f31858db0a013fac2455"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doReadInit</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv410doReadInit" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating whether to read initial conditions from file (1=yes, 0=no). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411doWriteInit">
<span class="target" id="nsphere_8c_1ad09412fe58e3233624b7877a2cb392fd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doWriteInit</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411doWriteInit" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating whether to write initial conditions to file (1=yes, 0=no). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_active_halo_mass">
<span class="target" id="nsphere_8c_1acf0dc082ece5bafee76cb9ea1b3b8933"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_active_halo_mass</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS</span></span><a class="headerlink" href="#_CPPv418g_active_halo_mass" title="Link to this definition"></a><br /></dt>
<dd><p>Active halo mass for N-body force calculations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_anisotropy_beta">
<span class="target" id="nsphere_8c_1ae759550119422a0cea168b9d29ed28ea"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_anisotropy_beta</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.0</span></span><a class="headerlink" href="#_CPPv417g_anisotropy_beta" title="Link to this definition"></a><br /></dt>
<dd><p>Anisotropy parameter <span class="math notranslate nohighlight">\(\beta\)</span> for Hernquist profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_anisotropy_beta_provided">
<span class="target" id="nsphere_8c_1aacd9cc5b21500c6736d8a48c29c6d1cc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_anisotropy_beta_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_anisotropy_beta_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--aniso-beta</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_attempt_load_seeds">
<span class="target" id="nsphere_8c_1abc5cb3a638545879af6d8a83cc2c6cf6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_attempt_load_seeds</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420g_attempt_load_seeds" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 to attempt loading seeds from files if not provided via command line. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_benchmark_count">
<span class="target" id="nsphere_8c_1a174c780e257995f071ec19a7fe59c200"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_benchmark_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv417g_benchmark_count" title="Link to this definition"></a><br /></dt>
<dd><p>Number of times benchmarking was performed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_cored_profile_halo_mass">
<span class="target" id="nsphere_8c_1a392716ce8f5733c1325e0a979a85c12a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cored_profile_halo_mass</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS</span></span><a class="headerlink" href="#_CPPv425g_cored_profile_halo_mass" title="Link to this definition"></a><br /></dt>
<dd><p>Total halo mass for the Cored profile ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). Populated from <code class="docutils literal notranslate"><span class="pre">g_halo_mass_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_cored_profile_rc">
<span class="target" id="nsphere_8c_1a4b496196531b3475aa03188149b89f19"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cored_profile_rc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">RC</span></span><a class="headerlink" href="#_CPPv418g_cored_profile_rc" title="Link to this definition"></a><br /></dt>
<dd><p>Scale radius <span class="math notranslate nohighlight">\(r_c\)</span> for the Cored profile (kpc). Populated from <code class="docutils literal notranslate"><span class="pre">g_scale_radius_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv427g_cored_profile_rmax_factor">
<span class="target" id="nsphere_8c_1a8ba477b9aa943c64fb2426284cabe7fb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cored_profile_rmax_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></span><a class="headerlink" href="#_CPPv427g_cored_profile_rmax_factor" title="Link to this definition"></a><br /></dt>
<dd><p>Cutoff radius factor for the Cored profile. Populated from <code class="docutils literal notranslate"><span class="pre">g_cutoff_factor_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419g_current_best_sort">
<span class="target" id="nsphere_8c_1af51f985fa3c8ffd7cc3df83f50fb19ab"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_current_best_sort</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">32</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;insertion_parallel&quot;</span></span><a class="headerlink" href="#_CPPv419g_current_best_sort" title="Link to this definition"></a><br /></dt>
<dd><p>Tracks the best-performing sorting algorithm for adaptive mode. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv433g_current_timestep_scatter_counts">
<span class="target" id="nsphere_8c_1a0728edd2d4974a2324f5b55b9bb4b282"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_current_timestep_scatter_counts</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv433g_current_timestep_scatter_counts" title="Link to this definition"></a><br /></dt>
<dd><p>Tracks scatter counts per particle for the timestep block being processed. The counts are reset after each block write. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_cutoff_factor_param">
<span class="target" id="nsphere_8c_1ace43f213d0ce41c62f15b9054e4e4487"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cutoff_factor_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></span><a class="headerlink" href="#_CPPv421g_cutoff_factor_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized rmax factor, defaults to Cored's default. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv430g_cutoff_factor_param_provided">
<span class="target" id="nsphere_8c_1aa50274fc26ef6d1a63110f32b4336e7c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cutoff_factor_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv430g_cutoff_factor_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--cutoff-factor</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415g_dbl_buf_count">
<span class="target" id="nsphere_8c_1a225630acced4c2a17dc6a6f28650b1b0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv415g_dbl_buf_count" title="Link to this definition"></a><br /></dt>
<dd><p>Number of valid snapshots in buffer (range: 0-4, saturates at 4). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_dbl_buf_current_slot">
<span class="target" id="nsphere_8c_1a0c74ad28cb0cef8af8ad632b01d2290f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_current_slot</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv422g_dbl_buf_current_slot" title="Link to this definition"></a><br /></dt>
<dd><p>Next write slot in rolling 4-snapshot circular buffer (range: 0-3, wraps via modulo). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_dbl_buf_L">
<span class="target" id="nsphere_8c_1a63e4b6c69a01be26a22d2675a5c69a9b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_L</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv411g_dbl_buf_L" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for particle angular momenta (last 4 snapshots, npts particles each). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv414g_dbl_buf_npts">
<span class="target" id="nsphere_8c_1aeab61599df0d9c8f9eb48e653924061f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_npts</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv414g_dbl_buf_npts" title="Link to this definition"></a><br /></dt>
<dd><p>Number of particles, used for buffer indexing. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_dbl_buf_phi">
<span class="target" id="nsphere_8c_1a9252bdbf937b98d4e603f45918907202"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_phi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv413g_dbl_buf_phi" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for particle phi angles (last 4 snapshots, npts particles each). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_dbl_buf_R">
<span class="target" id="nsphere_8c_1a1f084a737b534e7adca0df25d4edec64"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_R</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv411g_dbl_buf_R" title="Link to this definition"></a><br /></dt>
<dd><p>Rolling buffer system for preserving last 4 snapshots in full double precision. </p>
<p>Maintains a circular buffer of the most recent snapshots to avoid precision loss during restart/extend operations. The buffer stores:<ul class="simple">
<li><p>Snapshots 0, then [0,1], then [0,1,2], then [0,1,2,3]</p></li>
<li><p>After 4 snapshots: rolling last 4 (e.g., [77,78,79,80] for 81-snapshot run)</p></li>
</ul>
</p>
<p>Files written: double_buffer_all_particle_data_&lt;tag&gt;.dat (28 bytes/particle/snap) double_buffer_all_particle_phi_&lt;tag&gt;.dat (8 bytes/particle/snap)</p>
<p>Buffer size: (28 + 8) * npts * 4 = 144 * npts bytes in memory Buffer for particle radii (last 4 snapshots, npts particles each). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv414g_dbl_buf_Rank">
<span class="target" id="nsphere_8c_1ad5fd156814d6aea0384c719978b7fbef"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_Rank</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv414g_dbl_buf_Rank" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for particle ranks (last 4 snapshots, npts particles each). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv414g_dbl_buf_Vrad">
<span class="target" id="nsphere_8c_1aced878d9d7c499a15da7a1a3c21c79c6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_dbl_buf_Vrad</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv414g_dbl_buf_Vrad" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for particle radial velocities (last 4 snapshots, npts particles each). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_default_max_threads">
<span class="target" id="nsphere_8c_1a5886073ed8b4bb94227a04bd52903d3b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_default_max_threads</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv421g_default_max_threads" title="Link to this definition"></a><br /></dt>
<dd><p>Default max threads (all cores) for non-SIDM operations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_defaultSortAlg">
<span class="target" id="nsphere_8c_1a6941efb3580a570bda2e5720545c0293"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_defaultSortAlg</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;quadsort_parallel&quot;</span></span><a class="headerlink" href="#_CPPv416g_defaultSortAlg" title="Link to this definition"></a><br /></dt>
<dd><p>&lt; Default sorting algorithm identifier string. Set based on command-line options. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_density_derivative_func">
<span class="target" id="nsphere_8c_1aa24b92c1f097418dc43ee90951cb62fe"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv413drhodr_func_t" title="drhodr_func_t"><span class="n"><span class="pre">drhodr_func_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_density_derivative_func</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv425g_density_derivative_func" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer for dynamically selected density derivative (Cored/Hernquist profiles). </p>
<p>Points to the appropriate <span class="math notranslate nohighlight">\(d\rho/dr\)</span> implementation selected at runtime during IC generation. Enables profile-specific calculations without conditional branching in performance-critical loops.</p>
<p>Selection logic:<ul class="simple">
<li><p>If OM model active: Points to augmented density derivative (density_derivative_om_cored)</p></li>
<li><p>Otherwise: Points to standard isotropic derivative (drhodr)</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be set before any integration begins. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv429g_density_derivative_nfw_func">
<span class="target" id="nsphere_8c_1affae38a0ed8bf217052b56ad6eed3f89"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv417drhodr_nfw_func_t" title="drhodr_nfw_func_t"><span class="n"><span class="pre">drhodr_nfw_func_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_density_derivative_nfw_func</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv429g_density_derivative_nfw_func" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer for dynamically selected NFW density derivative. </p>
<p>Points to the appropriate NFW-specific <span class="math notranslate nohighlight">\(d\rho/dr\)</span> implementation selected at runtime during IC generation. NFW derivatives require additional parameters (rc, nt_nfw, falloff_C) passed through the function signature.</p>
<p>Selection logic:<ul class="simple">
<li><p>If OM model active: Points to augmented NFW derivative (density_derivative_om_nfw)</p></li>
<li><p>Otherwise: Points to standard NFW derivative (drhodr_profile_nfwcutoff)</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be set before any integration begins. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419g_doAllParticleData">
<span class="target" id="nsphere_8c_1a90ac17f8099c6a91249c330a7a45dcb5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doAllParticleData</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv419g_doAllParticleData" title="Link to this definition"></a><br /></dt>
<dd><p>Save complete particle evolution history (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49g_doDebug">
<span class="target" id="nsphere_8c_1a2763bb9f0f7f79afffeac48905e799fb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDebug</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv49g_doDebug" title="Link to this definition"></a><br /></dt>
<dd><p>Global simulation feature flags. </p>
<p>These control various optional behaviors and optimizations in the simulation. Each flag can be set via command line arguments. Enable detailed debug output (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410g_doDynPsi">
<span class="target" id="nsphere_8c_1ac14e6ad00493002d0af407252f07f3b1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDynPsi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv410g_doDynPsi" title="Link to this definition"></a><br /></dt>
<dd><p>Enable dynamic potential recalculation (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_doDynRank">
<span class="target" id="nsphere_8c_1a8b153c5c0087d5c9f2330cc7ada744e7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDynRank</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv411g_doDynRank" title="Link to this definition"></a><br /></dt>
<dd><p>Enable dynamic rank calculation per step (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_doRestart">
<span class="target" id="nsphere_8c_1a74aece53e0af69f9a5537f139fa24f08"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doRestart</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411g_doRestart" title="Link to this definition"></a><br /></dt>
<dd><p>Enable simulation restart from checkpoint. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_doRestartForce">
<span class="target" id="nsphere_8c_1aae04bc655638422a87f8dc0ae446c8a5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doRestartForce</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_doRestartForce" title="Link to this definition"></a><br /></dt>
<dd><p>Force regeneration of all snapshots when restarting. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_doSimExtend">
<span class="target" id="nsphere_8c_1a455e805fd9b75c0399ddc592025ef4af"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doSimExtend</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv413g_doSimExtend" title="Link to this definition"></a><br /></dt>
<dd><p>Enable simulation extension mode (<code class="docutils literal notranslate"><span class="pre">--sim-extend</span></code>). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv414g_doSimRestart">
<span class="target" id="nsphere_8c_1a44b67da92f1c59ed79a7d703a5995495"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doSimRestart</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv414g_doSimRestart" title="Link to this definition"></a><br /></dt>
<dd><p>Enable simulation restart detection mode (<code class="docutils literal notranslate"><span class="pre">--sim-restart</span></code>). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423g_doSimRestartCheckOnly">
<span class="target" id="nsphere_8c_1a14b60ffb3497e4f5c79e4c019aa8eab1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doSimRestartCheckOnly</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv423g_doSimRestartCheckOnly" title="Link to this definition"></a><br /></dt>
<dd><p>Check-only mode for <code class="docutils literal notranslate"><span class="pre">--sim-restart</span></code> (do not actually restart). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47g_E_buf">
<span class="target" id="nsphere_8c_1a6640bd3c7a0d7a985222e80e2c791632"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_E_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47g_E_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for total relative energy E_rel [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_E_init_vals">
<span class="target" id="nsphere_8c_1a25c1f9c2eae9aba59e55220a5a2f5d8e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_E_init_vals</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv413g_E_init_vals" title="Link to this definition"></a><br /></dt>
<dd><p>Stores initial energy E_rel for tracked particles [particle_idx]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_enable_logging">
<span class="target" id="nsphere_8c_1ae577daedc1b00c1bb2e11dba4f69a64c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_enable_logging</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_enable_logging" title="Link to this definition"></a><br /></dt>
<dd><p>Enable logging to file (controlled by <code class="docutils literal notranslate"><span class="pre">--log</span></code> flag). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424g_enable_sidm_scattering">
<span class="target" id="nsphere_8c_1a5212a272a63a7d445406d01f4a7376d6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_enable_sidm_scattering</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv424g_enable_sidm_scattering" title="Link to this definition"></a><br /></dt>
<dd><p>Enable SIDM scattering physics (0=no, 1=yes). Default is OFF. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_energy_file">
<span class="target" id="nsphere_8c_1a36c5f0c920a67062e1a9a9276b531ef2"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_energy_file</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv413g_energy_file" title="Link to this definition"></a><br /></dt>
<dd><p>File handle for energy_and_angular_momentum_vs_time.dat. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_energy_snapshots_loaded">
<span class="target" id="nsphere_8c_1a0b6ad3f88b4b4d2ea1df4ca685bd8f65"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_energy_snapshots_loaded</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv425g_energy_snapshots_loaded" title="Link to this definition"></a><br /></dt>
<dd><p>Number of energy snapshots loaded from existing file in restart mode. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_extend_file_source">
<span class="target" id="nsphere_8c_1a223fa0803bbc72169e31e7f7f93a4f47"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_extend_file_source</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv420g_extend_file_source" title="Link to this definition"></a><br /></dt>
<dd><p>Source file to extend from (<code class="docutils literal notranslate"><span class="pre">--extend-file</span></code>). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_falloff_factor_param">
<span class="target" id="nsphere_8c_1a51e4192c713318eedeb97bb1a0f42e6e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_falloff_factor_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv422g_falloff_factor_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized falloff factor, defaults to NFW's default. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv431g_falloff_factor_param_provided">
<span class="target" id="nsphere_8c_1ae763f1806ffe602bf10277c4442f732a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_falloff_factor_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv431g_falloff_factor_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--falloff-factor</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_file_suffix">
<span class="target" id="nsphere_8c_1a2849b95526a209a1c2bef7450ec4fb6e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_file_suffix</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">256</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;&quot;</span></span><a class="headerlink" href="#_CPPv413g_file_suffix" title="Link to this definition"></a><br /></dt>
<dd><p>Global file suffix string. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_halo_mass_param">
<span class="target" id="nsphere_8c_1a8d239e4b6b0c636620a61d6a2bd1800c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_halo_mass_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS</span></span><a class="headerlink" href="#_CPPv417g_halo_mass_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized halo mass ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>), defaults to HALO_MASS macro. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_halo_mass_param_provided">
<span class="target" id="nsphere_8c_1a5d7e61dee00c23721502c57139eb7527"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_halo_mass_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_halo_mass_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--halo-mass</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_hybrid_p_cores">
<span class="target" id="nsphere_8c_1aeccfb3c5a305990e5429f86de159cd06"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_hybrid_p_cores</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_hybrid_p_cores" title="Link to this definition"></a><br /></dt>
<dd><p>Number of P-cores on hybrid CPUs (0 if not hybrid). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419g_initial_cond_seed">
<span class="target" id="nsphere_8c_1a1499d38fe15c1ecf99e32837e8a32f84"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_initial_cond_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv419g_initial_cond_seed" title="Link to this definition"></a><br /></dt>
<dd><p>Seed used for generating initial conditions. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv433g_initial_cond_seed_filename_base">
<span class="target" id="nsphere_8c_1abe62d0a2187049fff62f6a02288b1f5d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_initial_cond_seed_filename_base</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;data/last_initial_seed&quot;</span></span><a class="headerlink" href="#_CPPv433g_initial_cond_seed_filename_base" title="Link to this definition"></a><br /></dt>
<dd><p>Base name for IC seed file. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv428g_initial_cond_seed_provided">
<span class="target" id="nsphere_8c_1a90d748c2e2325d6ba2fea5e7a8df5c52"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_initial_cond_seed_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv428g_initial_cond_seed_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--init-cond-seed</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_insertion_wins">
<span class="target" id="nsphere_8c_1aae808cf433d710f25e011ffc527a4d5f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_insertion_wins</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_insertion_wins" title="Link to this definition"></a><br /></dt>
<dd><p>Number of times insertion sort was faster. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47g_L_buf">
<span class="target" id="nsphere_8c_1aa80939817d055ae2c38d9eb991e46b55"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_L_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47g_L_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for angular momentum [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_L_init_vals">
<span class="target" id="nsphere_8c_1a009b2ef968307196319495e56398d05c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_L_init_vals</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv413g_L_init_vals" title="Link to this definition"></a><br /></dt>
<dd><p>Stores initial angular momentum <span class="math notranslate nohighlight">\(L\)</span> for tracked particles [particle_idx]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_l_target_value">
<span class="target" id="nsphere_8c_1a8a19c4a8c6105aad25f698f05993119a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_l_target_value</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="o"><span class="pre">-</span></span><span class="m"><span class="pre">1.0</span></span><a class="headerlink" href="#_CPPv416g_l_target_value" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum selection configuration for particle filtering. </p>
<p>Mode 0: Select particles with the 5 lowest <span class="math notranslate nohighlight">\(L\)</span> values. Mode 1: Select particles with <span class="math notranslate nohighlight">\(L\)</span> values closest to <span class="math notranslate nohighlight">\(L_{compare}\)</span>. Target <span class="math notranslate nohighlight">\(L\)</span> value for <code class="docutils literal notranslate"><span class="pre">--lvals-target</span></code> mode. A negative value indicates the option was not set. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415g_lowestL_E_buf">
<span class="target" id="nsphere_8c_1a6da25df58a786741ff056804f3fe2c4a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_lowestL_E_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415g_lowestL_E_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for energy of low-L particles [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv414g_lowestL_file">
<span class="target" id="nsphere_8c_1aecba3a744576a14b7f476522df587d1b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_lowestL_file</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv414g_lowestL_file" title="Link to this definition"></a><br /></dt>
<dd><p>File handle for lowest_l_trajectories.dat. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415g_lowestL_L_buf">
<span class="target" id="nsphere_8c_1aa0f7ed3c86d9354171a25961359ff7a7"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_lowestL_L_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415g_lowestL_L_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for angular momentum of low-L particles [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415g_lowestL_r_buf">
<span class="target" id="nsphere_8c_1a3bd3ab5ea499d673ef772617b5f22061"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_lowestL_r_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415g_lowestL_r_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for radius of low-L particles [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_master_seed">
<span class="target" id="nsphere_8c_1a70f7730991da1fabb7c1e30e6c0dd496"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_master_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv413g_master_seed" title="Link to this definition"></a><br /></dt>
<dd><p>Master seed for the simulation, if provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_master_seed_provided">
<span class="target" id="nsphere_8c_1a4627e5cc97bd5b5041c6b778fb02c0b8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_master_seed_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv422g_master_seed_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--master-seed</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_max_omp_threads_for_rng">
<span class="target" id="nsphere_8c_1a0a4df77325009702c030ed07684f6293"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_max_omp_threads_for_rng</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv425g_max_omp_threads_for_rng" title="Link to this definition"></a><br /></dt>
<dd><p>Number of threads for which RNGs are allocated. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48g_mu_buf">
<span class="target" id="nsphere_8c_1a1b2ae9b09946ba5b2a6e186869f7a174"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_mu_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv48g_mu_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for radial direction cosine mu [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv428g_nfw_profile_falloff_factor">
<span class="target" id="nsphere_8c_1a18f7fcd78e311127476cf0c2c2ce0e2a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_falloff_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv428g_nfw_profile_falloff_factor" title="Link to this definition"></a><br /></dt>
<dd><p>Falloff concentration parameter <span class="math notranslate nohighlight">\(C\)</span> for the NFW profile. Populated from <code class="docutils literal notranslate"><span class="pre">g_falloff_factor_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423g_nfw_profile_halo_mass">
<span class="target" id="nsphere_8c_1aa358b93a9aeec3bf673da8095ab52403"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_halo_mass</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS_NFW</span></span><a class="headerlink" href="#_CPPv423g_nfw_profile_halo_mass" title="Link to this definition"></a><br /></dt>
<dd><p>Total halo mass for the NFW profile ( <span class="math notranslate nohighlight">\(M_{\odot}\)</span>). Populated from <code class="docutils literal notranslate"><span class="pre">g_halo_mass_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_nfw_profile_rc">
<span class="target" id="nsphere_8c_1aec9b994de512d155a4540635c15babd0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_rc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">RC_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv416g_nfw_profile_rc" title="Link to this definition"></a><br /></dt>
<dd><p>Scale radius <span class="math notranslate nohighlight">\(r_c\)</span> for the NFW profile (kpc). Populated from <code class="docutils literal notranslate"><span class="pre">g_scale_radius_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv430g_nfw_profile_rmax_norm_factor">
<span class="target" id="nsphere_8c_1a0837cffbd86824eb91cd573d8e5a72e6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_rmax_norm_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUTOFF_FACTOR_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv430g_nfw_profile_rmax_norm_factor" title="Link to this definition"></a><br /></dt>
<dd><p>Cutoff radius factor for the NFW profile. Populated from <code class="docutils literal notranslate"><span class="pre">g_cutoff_factor_param</span></code>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_om_aniso_factor_provided">
<span class="target" id="nsphere_8c_1a892a6680f7deab346f79b771421019db"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_om_aniso_factor_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_om_aniso_factor_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--aniso-factor</span></code> or <code class="docutils literal notranslate"><span class="pre">--aniso-betascale</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_om_anisotropy_radius">
<span class="target" id="nsphere_8c_1adb1749cbf73d499da7babb8412cdfded"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_om_anisotropy_radius</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.0</span></span><a class="headerlink" href="#_CPPv422g_om_anisotropy_radius" title="Link to this definition"></a><br /></dt>
<dd><p>Physical anisotropy radius <span class="math notranslate nohighlight">\(r_a\)</span> (kpc) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_om_ra_scale_factor">
<span class="target" id="nsphere_8c_1a655ce52d9a7f6c0e26eea836e6b28c1d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_om_ra_scale_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.0</span></span><a class="headerlink" href="#_CPPv420g_om_ra_scale_factor" title="Link to this definition"></a><br /></dt>
<dd><p>Anisotropy radius as multiple of scale radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424g_particle_scatter_state">
<span class="target" id="nsphere_8c_1a3c25f840da5e06f5e5055201eb94ce2e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_particle_scatter_state</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv424g_particle_scatter_state" title="Link to this definition"></a><br /></dt>
<dd><p>Tracks recent scatter history for Adams-Bashforth integrator state reset. Indexed by original particle ID. 0=normal AB, 1=scattered in the previous step (use AB1-like step), 2=one step has passed since scattering (use AB2-like step). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_profile_type_str">
<span class="target" id="nsphere_8c_1a4f5fe613774e06dfd7674bdfafb5f0c3"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_profile_type_str</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;nfw&quot;</span></span><a class="headerlink" href="#_CPPv418g_profile_type_str" title="Link to this definition"></a><br /></dt>
<dd><p>Profile type string (&quot;nfw&quot;, &quot;cored&quot;, or &quot;hernquist&quot;), default &quot;nfw&quot;. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv427g_profile_type_str_provided">
<span class="target" id="nsphere_8c_1ab9481936f94c3926eaf57f060ccf6080"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_profile_type_str_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv427g_profile_type_str_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--profile</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415g_quadsort_wins">
<span class="target" id="nsphere_8c_1a7e2eaacd14447228f8adeb9f23bba7ba"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_quadsort_wins</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv415g_quadsort_wins" title="Link to this definition"></a><br /></dt>
<dd><p>Number of times quadsort was faster. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv412g_radix_wins">
<span class="target" id="nsphere_8c_1a5babea403452c72a2f3f7696187188bb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_radix_wins</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv412g_radix_wins" title="Link to this definition"></a><br /></dt>
<dd><p>Number of times radix sort was faster. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423g_restart_file_override">
<span class="target" id="nsphere_8c_1aed980b5442455e300261935fd43ab936"></span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_restart_file_override</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv423g_restart_file_override" title="Link to this definition"></a><br /></dt>
<dd><p>Optional explicit restart file path (<code class="docutils literal notranslate"><span class="pre">--restart-file</span></code>). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_restart_initial_timestep">
<span class="target" id="nsphere_8c_1ae24d4f417b255a842b373c1c7717c856"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_restart_initial_timestep</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_restart_initial_timestep" title="Link to this definition"></a><br /></dt>
<dd><p>Actual timestep number from which restart continues (e.g., 10001). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_restart_mode_active">
<span class="target" id="nsphere_8c_1a283cc94e63565d2bbf207e640e48b3ae"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_restart_mode_active</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv421g_restart_mode_active" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 when actively restarting simulation, 0 when only checking or not restarting. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv428g_restart_snapshots_is_count">
<span class="target" id="nsphere_8c_1a09c4603f862ff74bc4bd536a11d0ea8c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_restart_snapshots_is_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv428g_restart_snapshots_is_count" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">restart_completed_snapshots</span></code> represents a count of snapshots; 0 if it is an index. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv45g_rng">
<span class="target" id="nsphere_8c_1a4ea0ea00d950a3956c6c25bb9fcc02a5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_rng</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv45g_rng" title="Link to this definition"></a><br /></dt>
<dd><p>GSL Random Number Generator state. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_rng_per_thread">
<span class="target" id="nsphere_8c_1af433507ee400c9d9bcd4b617c2c84804"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_rng_per_thread</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416g_rng_per_thread" title="Link to this definition"></a><br /></dt>
<dd><p>Array of GSL RNG states, one per OpenMP thread. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_scale_radius_param">
<span class="target" id="nsphere_8c_1a3f2c2ee1f35f78ab4532e82d47dc7c31"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_scale_radius_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">RC</span></span><a class="headerlink" href="#_CPPv420g_scale_radius_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized scale radius (kpc), defaults to RC macro. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv429g_scale_radius_param_provided">
<span class="target" id="nsphere_8c_1ad54ba634a2f778c54de975e96c0b82f0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_scale_radius_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv429g_scale_radius_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--scale-radius</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_sidm_execution_mode">
<span class="target" id="nsphere_8c_1a6792965561705eebe1e5f97a1bfd0a86"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_execution_mode</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv421g_sidm_execution_mode" title="Link to this definition"></a><br /></dt>
<dd><p>SIDM execution mode: 0 for serial, 1 for parallel (default). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv412g_sidm_kappa">
<span class="target" id="nsphere_8c_1ac86d3c67825f309cc2f48ef58f382818"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_kappa</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">50.0</span></span><a class="headerlink" href="#_CPPv412g_sidm_kappa" title="Link to this definition"></a><br /></dt>
<dd><p>SIDM opacity kappa (cm <span class="math notranslate nohighlight">\(^2\)</span>/g), default 50.0. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_sidm_kappa_provided">
<span class="target" id="nsphere_8c_1ae813c76b7cb1023356f7247f29a0362a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_kappa_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv421g_sidm_kappa_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--sidm-kappa</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv428g_sidm_max_interaction_range">
<span class="target" id="nsphere_8c_1a8cf59963ac3f9d9c1b7b8853fbdb726a"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_max_interaction_range</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">10</span></span><a class="headerlink" href="#_CPPv428g_sidm_max_interaction_range" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum number of neighbors to check for SIDM scattering. Default is 10. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_sidm_seed">
<span class="target" id="nsphere_8c_1ad46cd695e6fd724a1274e9fdc41749ed"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411g_sidm_seed" title="Link to this definition"></a><br /></dt>
<dd><p>Seed used for SIDM calculations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_sidm_seed_filename_base">
<span class="target" id="nsphere_8c_1ab08b4cd0c2b769f2d8615217b00988f4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_seed_filename_base</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;data/last_sidm_seed&quot;</span></span><a class="headerlink" href="#_CPPv425g_sidm_seed_filename_base" title="Link to this definition"></a><br /></dt>
<dd><p>Base name for SIDM seed file. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_sidm_seed_provided">
<span class="target" id="nsphere_8c_1ae77376af82313bcbdaa40bc29b66aa10"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_seed_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420g_sidm_seed_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if the <code class="docutils literal notranslate"><span class="pre">--sidm-seed</span></code> option is provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_single_traj_file">
<span class="target" id="nsphere_8c_1afae245ffda949cd139fd6293a3148efc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_single_traj_file</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv418g_single_traj_file" title="Link to this definition"></a><br /></dt>
<dd><p>File handle for single_trajectory.dat. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_sort_call_count">
<span class="target" id="nsphere_8c_1a473ebb8970aa3227a4ba27e4eb428793"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sort_call_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv417g_sort_call_count" title="Link to this definition"></a><br /></dt>
<dd><p>Total number of sort calls made. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_sort_columns_buffer">
<span class="target" id="nsphere_8c_1ac09f4032c74dc2d9655c3463813e5917"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_sort_columns_buffer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv421g_sort_columns_buffer" title="Link to this definition"></a><br /></dt>
<dd><p>Global persistent buffer for particle data transposition during sorting. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_sort_columns_buffer_npts">
<span class="target" id="nsphere_8c_1ababf87c8f003f632fa0a44ec44b9f5ff"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sort_columns_buffer_npts</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_sort_columns_buffer_npts" title="Link to this definition"></a><br /></dt>
<dd><p>Stores the number of particles for which the persistent buffer is allocated. </p>
<p>The buffer is reallocated if the number of simulation particles changes. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410g_time_buf">
<span class="target" id="nsphere_8c_1adac7c69628178550e3325200442a1215"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_time_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410g_time_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for time values [timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_time_snapshots">
<span class="target" id="nsphere_8c_1a07d9723349d95e77dba13a2f9bc07c13"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_time_snapshots</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416g_time_snapshots" title="Link to this definition"></a><br /></dt>
<dd><p>Arrays for tracking total system energy diagnostics over time. </p>
<p>Simulation time at each diagnostic snapshot (Myr). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49g_total_E">
<span class="target" id="nsphere_8c_1a9ccfff98606bd5407471c32d18a4ae1b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_total_E</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49g_total_E" title="Link to this definition"></a><br /></dt>
<dd><p>Total energy (KE + PE) of the system at each snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_total_insertion_time">
<span class="target" id="nsphere_8c_1af62aea2f25c94dc8761b8d2b1510dd8a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_total_insertion_time</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.0</span></span><a class="headerlink" href="#_CPPv422g_total_insertion_time" title="Link to this definition"></a><br /></dt>
<dd><p>Total time spent in insertion benchmarks (ms) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410g_total_KE">
<span class="target" id="nsphere_8c_1a1c0529e9d6564eda2906c6357e4515ed"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_total_KE</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410g_total_KE" title="Link to this definition"></a><br /></dt>
<dd><p>Total kinetic energy of the system at each snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410g_total_PE">
<span class="target" id="nsphere_8c_1ad14bb6b0d2fa0af66886b9ce9e4fe09c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_total_PE</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410g_total_PE" title="Link to this definition"></a><br /></dt>
<dd><p>Total potential energy of the system at each snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_total_quadsort_time">
<span class="target" id="nsphere_8c_1a2215a4bac5f9710041f991e849d7bb8a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_total_quadsort_time</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.0</span></span><a class="headerlink" href="#_CPPv421g_total_quadsort_time" title="Link to this definition"></a><br /></dt>
<dd><p>Total time spent in quadsort benchmarks (ms) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_total_radix_time">
<span class="target" id="nsphere_8c_1a2a801b181b836997994d846e58582ce4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_total_radix_time</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.0</span></span><a class="headerlink" href="#_CPPv418g_total_radix_time" title="Link to this definition"></a><br /></dt>
<dd><p>Total time spent in radix benchmarks (ms) </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_total_sidm_scatters">
<span class="target" id="nsphere_8c_1a6bf53edac8201b0f8eecf672e4071708"></span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_total_sidm_scatters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv421g_total_sidm_scatters" title="Link to this definition"></a><br /></dt>
<dd><p>Global counter for total SIDM scatters. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_traj_file">
<span class="target" id="nsphere_8c_1ac3c2f12d5f6c6b7ed2b8552b839dccb0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_traj_file</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv411g_traj_file" title="Link to this definition"></a><br /></dt>
<dd><p>File handle for trajectories.dat, kept open for performance. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_trajectories_buf">
<span class="target" id="nsphere_8c_1aae30422c80084c0622e495f26e94603a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_trajectories_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv418g_trajectories_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for radius [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_trajectory_buffer_index">
<span class="target" id="nsphere_8c_1a97e25dadef9e41d5e0ddb3448856bde0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_trajectory_buffer_index</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv425g_trajectory_buffer_index" title="Link to this definition"></a><br /></dt>
<dd><p>Current index for writing into the trajectory buffers. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424g_trajectory_buffer_size">
<span class="target" id="nsphere_8c_1a54d1283044bcf3920c93e9de22db8722"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_trajectory_buffer_size</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv424g_trajectory_buffer_size" title="Link to this definition"></a><br /></dt>
<dd><p>Size of the trajectory buffers (in timesteps), synchronized with snapshot buffer size. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_use_graph_coloring_sidm">
<span class="target" id="nsphere_8c_1a89f6e12273bace334b9833a1f07624d7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_graph_coloring_sidm</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv425g_use_graph_coloring_sidm" title="Link to this definition"></a><br /></dt>
<dd><p>Use graph coloring algorithm for parallel SIDM (eliminates double-booking). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv429g_use_hernquist_aniso_profile">
<span class="target" id="nsphere_8c_1a198cc7c00d7c12a524aed83e80dc5498"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_hernquist_aniso_profile</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv429g_use_hernquist_aniso_profile" title="Link to this definition"></a><br /></dt>
<dd><p>Flag to use anisotropic Hernquist profile for ICs. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_use_hernquist_numerical">
<span class="target" id="nsphere_8c_1ac5570d4f8028751e65fe768097d865b8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_hernquist_numerical</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv425g_use_hernquist_numerical" title="Link to this definition"></a><br /></dt>
<dd><p>Flag to use numerical Hernquist profile (OM-compatible). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_use_nfw_profile">
<span class="target" id="nsphere_8c_1acf4619905747dd78be38c192c1cce1b0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_nfw_profile</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv417g_use_nfw_profile" title="Link to this definition"></a><br /></dt>
<dd><p>Flag to select NFW profile for ICs (1=NFW, 0=use other profile flags). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_use_numerical_isotropic">
<span class="target" id="nsphere_8c_1aca071a7c7196969d128f1c32eb9e4188"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_numerical_isotropic</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv425g_use_numerical_isotropic" title="Link to this definition"></a><br /></dt>
<dd><p>Flag for numerical Hernquist with true f(E). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_use_om_profile">
<span class="target" id="nsphere_8c_1a1ebe4c2fe6472bf3ee9193b7f27180f5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_om_profile</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_use_om_profile" title="Link to this definition"></a><br /></dt>
<dd><p>Osipkov-Merritt Anisotropy Model Implementation. </p>
<p>The Osipkov-Merritt (OM) model provides radially-varying velocity anisotropy characterized by the anisotropy parameter:</p>
<p><span class="math notranslate nohighlight">\(\beta(r) = r^2/(r^2 + r_a^2)\)</span></p>
<p>where <span class="math notranslate nohighlight">\(r_a\)</span> is the anisotropy radius. The model transitions from isotropic ( <span class="math notranslate nohighlight">\(\beta=0\)</span>) at <span class="math notranslate nohighlight">\(r=0\)</span> to radially-biased ( <span class="math notranslate nohighlight">\(\beta \rightarrow 1\)</span>) as <span class="math notranslate nohighlight">\(r \rightarrow \infty\)</span>.</p>
<p>Implementation uses the augmented density method:<ul class="simple">
<li><p>Define augmented density: <span class="math notranslate nohighlight">\(\rho_Q(r) = \rho(r)(1 + r^2/r_a^2)\)</span></p></li>
<li><p>Use <span class="math notranslate nohighlight">\(Q = E - L^2/(2r_a^2)\)</span> as the OM invariant</p></li>
<li><p>Apply Eddington inversion to <span class="math notranslate nohighlight">\(\rho_Q\)</span> to get <span class="math notranslate nohighlight">\(f(Q)\)</span></p></li>
<li><p>Sample velocities in pseudo-space where Q-surfaces are spheres</p></li>
<li><p>Transform to physical velocities using mapping: <span class="math notranslate nohighlight">\(v_r = w \cos(\theta)\)</span>, <span class="math notranslate nohighlight">\(v_t = w \sin(\theta)/\sqrt{1 + r^2/r_a^2}\)</span></p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compatible with NFW, Cored, and numerical Hernquist profiles. Flag: 1 if OM model is requested </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_velocities_buf">
<span class="target" id="nsphere_8c_1a9d94fe31355495800cfea6d5fcc031e0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_velocities_buf</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416g_velocities_buf" title="Link to this definition"></a><br /></dt>
<dd><p>Buffer for radial velocity [particle_idx][timestep_in_buffer]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48ID_block">
<span class="target" id="nsphere_8c_1a804411baf5450f9423b5ecd61f0d4e1a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">ID_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv48ID_block" title="Link to this definition"></a><br /></dt>
<dd><p>Particle ID block (original IDs). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47L_block">
<span class="target" id="nsphere_8c_1ae2cf810c54ba0f579886bc7fa34e2a80"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">L_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47L_block" title="Link to this definition"></a><br /></dt>
<dd><p>Global arrays for particle data processing (block storage). </p>
<p>Angular momentum block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48Lcompare">
<span class="target" id="nsphere_8c_1acf387feb573420c5639256a2e7485a52"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Lcompare</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.05</span></span><a class="headerlink" href="#_CPPv48Lcompare" title="Link to this definition"></a><br /></dt>
<dd><p>Reference <span class="math notranslate nohighlight">\(L\)</span> value for closest-match mode (Mode 1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47nlowest">
<span class="target" id="nsphere_8c_1ae89d6fccec017254c845f6c6e6e78d3b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nlowest</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5</span></span><a class="headerlink" href="#_CPPv47nlowest" title="Link to this definition"></a><br /></dt>
<dd><p>Variables for tracking low angular momentum particles. </p>
<p>Number of lowest angular momentum particles to track. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413normalization">
<span class="target" id="nsphere_8c_1af30d254aedaf222a8f93118afc67a556"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">normalization</span></span></span><a class="headerlink" href="#_CPPv413normalization" title="Link to this definition"></a><br /></dt>
<dd><p>Mass normalization factor for energy calculations. Calculated based on the integral of the density profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418num_traj_particles">
<span class="target" id="nsphere_8c_1a01ac4b7d70776d60f2b9306e4209fbca"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_traj_particles</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">10</span></span><a class="headerlink" href="#_CPPv418num_traj_particles" title="Link to this definition"></a><br /></dt>
<dd><p>Number of particles to track in trajectories.dat (by original ID). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv430PARALLEL_SORT_DEFAULT_SECTIONS">
<span class="target" id="nsphere_8c_1a450ec57c21c7f482f7eeec7d631b48b9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_DEFAULT_SECTIONS</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span><a class="headerlink" href="#_CPPv430PARALLEL_SORT_DEFAULT_SECTIONS" title="Link to this definition"></a><br /></dt>
<dd><p>Default number of sections when OpenMP is unavailable or reports few threads. </p>
<p>Provides a baseline level of partitioning even in limited thread environments. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv438PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD">
<span class="target" id="nsphere_8c_1ae86f18d529275ccb0f9833f71280ff39"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">128</span></span><a class="headerlink" href="#_CPPv438PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum average chunk size threshold for parallel sort operation. </p>
<p>If the calculated size of each chunk (total elements / number of sections) falls below this threshold, the algorithm reverts to serial sorting to avoid overhead from managing very small parallel tasks. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv437PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP">
<span class="target" id="nsphere_8c_1aa88fd6b05f2f7010aed9a16a1deaa0b5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><a class="headerlink" href="#_CPPv437PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum required overlap between adjacent sort sections (in elements). </p>
<p>This ensures sufficient overlap for correct merging of sorted sections, particularly for sparse data distributions or when the calculated proportional overlap is small. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv429PARALLEL_SORT_OVERLAP_DIVISOR">
<span class="target" id="nsphere_8c_1a334eba1f65f9472e102be3d19d5a26ca"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_OVERLAP_DIVISOR</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span><a class="headerlink" href="#_CPPv429PARALLEL_SORT_OVERLAP_DIVISOR" title="Link to this definition"></a><br /></dt>
<dd><p>Divisor for calculating proportional overlap between sort sections. </p>
<p>Overlap is calculated as chunk_size / OVERLAP_DIVISOR to scale with data size. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv433PARALLEL_SORT_SECTIONS_PER_THREAD">
<span class="target" id="nsphere_8c_1aaf5d4e71f8c1282ec7aba67fda14bc5c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_SECTIONS_PER_THREAD</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><a class="headerlink" href="#_CPPv433PARALLEL_SORT_SECTIONS_PER_THREAD" title="Link to this definition"></a><br /></dt>
<dd><p>Number of sort sections per OpenMP thread for workload distribution. </p>
<p>Multiplier used to determine total section count from available threads. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49phi_block">
<span class="target" id="nsphere_8c_1a04770fe2a0aae6d373302c483f175259"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">phi_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49phi_block" title="Link to this definition"></a><br /></dt>
<dd><p>Phi angle block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47R_block">
<span class="target" id="nsphere_8c_1aac6f0b01f5fd9b6ae62ff0dcee03df09"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">R_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47R_block" title="Link to this definition"></a><br /></dt>
<dd><p>Radial position block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410Rank_block">
<span class="target" id="nsphere_8c_1aaead4d7d454a66bd595ee20411721b3a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Rank_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410Rank_block" title="Link to this definition"></a><br /></dt>
<dd><p>Particle rank (sorted position) block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416readInitFilename">
<span class="target" id="nsphere_8c_1a1a5e6187e6eed2330e7c5c2b12ed2104"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">readInitFilename</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416readInitFilename" title="Link to this definition"></a><br /></dt>
<dd><p>Filename to read initial conditions from (if doReadInit=1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419scatter_count_block">
<span class="target" id="nsphere_8c_1a1f84814e28215d60704b2d07f9c823fb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">scatter_count_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv419scatter_count_block" title="Link to this definition"></a><br /></dt>
<dd><p>Scatter count block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416skip_file_writes">
<span class="target" id="nsphere_8c_1acc92b9579ff43b04dd2277bf7d34dcdf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">skip_file_writes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416skip_file_writes" title="Link to this definition"></a><br /></dt>
<dd><p>Skip file writes during simulation restart. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423use_closest_to_Lcompare">
<span class="target" id="nsphere_8c_1aac9606b439f76709f7fe911236c020c0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_closest_to_Lcompare</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv423use_closest_to_Lcompare" title="Link to this definition"></a><br /></dt>
<dd><p>Mode selector (0=lowest <span class="math notranslate nohighlight">\(L\)</span>, 1=closest to <span class="math notranslate nohighlight">\(L_{compare}\)</span>). Default is lowest <span class="math notranslate nohighlight">\(L\)</span>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420use_identity_gravity">
<span class="target" id="nsphere_8c_1a6936a69fecabe2fdcb93993ef527ba44"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_identity_gravity</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420use_identity_gravity" title="Link to this definition"></a><br /></dt>
<dd><p>Gravitational force calculation control flag. </p>
<p>Used for testing and debugging orbital dynamics:<ul class="simple">
<li><p>0 = Normal gravitational force calculation (default).</p></li>
<li><p>1 = Zero gravity (particles move in straight lines).</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting this to 1 is useful for validating the integration scheme independent of gravitational physics. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410Vrad_block">
<span class="target" id="nsphere_8c_1ac2d702a2edcaf84b4f5ad4195e676b5d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Vrad_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410Vrad_block" title="Link to this definition"></a><br /></dt>
<dd><p>Radial velocity block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417writeInitFilename">
<span class="target" id="nsphere_8c_1a83025b3961bbc4fee6db755755cd892c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">writeInitFilename</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv417writeInitFilename" title="Link to this definition"></a><br /></dt>
<dd><p>Filename to write initial conditions to (if doWriteInit=1). </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv422cored_potential_params">
<span class="target" id="structcored__potential__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cored_potential_params</span></span></span><a class="headerlink" href="#_CPPv422cored_potential_params" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22cored_potential_params1ME">
<span class="target" id="structcored__potential__params_1af104559a44966dc8162f041ab4de608c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">M</span></span></span><a class="headerlink" href="#_CPPv4N22cored_potential_params1ME" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N22cored_potential_params2rcE">
<span class="target" id="structcored__potential__params_1a0a8bade8dae01ceefef24e7279d06406"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rc</span></span></span><a class="headerlink" href="#_CPPv4N22cored_potential_params2rcE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv431fE_integrand_params_hernquist_t">
<span class="target" id="structf_e__integrand__params__hernquist__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fE_integrand_params_hernquist_t</span></span></span><a class="headerlink" href="#_CPPv431fE_integrand_params_hernquist_t" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for the Hernquist distribution function integrand fEintegrand_hernquist. </p>
<p>This structure passes all necessary data, including pre-computed splines for <span class="math notranslate nohighlight">\(r(\Psi)\)</span> and <span class="math notranslate nohighlight">\(M(r)\)</span>, physical constants, and profile-specific parameters, to the GSL integration routine for calculating <span class="math notranslate nohighlight">\(I(E)\)</span> or <span class="math notranslate nohighlight">\(I(Q)\)</span>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t12accel_M_of_rE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1aa60a2b3a18e17dfba98f0cd0734add19"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">accel_M_of_r</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t12accel_M_of_rE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for the M(r) spline. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t14accel_r_of_PsiE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1a7184e463a6ab340366c2d7b5980de922"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">accel_r_of_Psi</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t14accel_r_of_PsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for the <span class="math notranslate nohighlight">\(r(-\Psi)\)</span> spline. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t17const_G_universalE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1aecad32314236cb2b630472a0d1dc522b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">const_G_universal</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t17const_G_universalE" title="Link to this definition"></a><br /></dt>
<dd><p>Universal gravitational constant G. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t15E_current_shellE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1a0f7299de5c1b2ac361e630e535076a55"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E_current_shell</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t15E_current_shellE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy E (isotropic) or Q (OM) of the current shell for which I is being computed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t17hernquist_a_scaleE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1a80f356093ada2d9051d552ed7c48c695"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hernquist_a_scale</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t17hernquist_a_scaleE" title="Link to this definition"></a><br /></dt>
<dd><p>Scale radius <span class="math notranslate nohighlight">\(a\)</span> of the Hernquist profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t23hernquist_normalizationE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1af7f788e3634d331f52b19957889f49ba"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hernquist_normalization</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t23hernquist_normalizationE" title="Link to this definition"></a><br /></dt>
<dd><p>Density normalization constant for the Hernquist profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t13Psimax_globalE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1aa845daf2ed62fb3baa218ab4642364d2"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimax_global</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t13Psimax_globalE" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum potential value for physical range validation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t13Psimin_globalE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1aeda0e1f78244bb51f820ac66eecf596b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimin_global</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t13Psimin_globalE" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum potential value for physical range validation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t13spline_M_of_rE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1ac8dbc77ab21c7ac44d637d23abbf1ef0"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spline_M_of_r</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t13spline_M_of_rE" title="Link to this definition"></a><br /></dt>
<dd><p>Spline for M(r), enclosed mass as a function of radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t15spline_r_of_PsiE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1ac844e449f89503dd19d94ab8813e1439"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spline_r_of_Psi</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t15spline_r_of_PsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Spline for <span class="math notranslate nohighlight">\(r(-\Psi)\)</span>: radius as function of negated potential (negation ensures monotonicity for GSL). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N31fE_integrand_params_hernquist_t6use_omE">
<span class="target" id="structf_e__integrand__params__hernquist__t_1aa7d459a63859199866d21f620ff6a9be"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_om</span></span></span><a class="headerlink" href="#_CPPv4N31fE_integrand_params_hernquist_t6use_omE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if using OM (E_current_shell represents Q), 0 if isotropic. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv425fE_integrand_params_NFW_t">
<span class="target" id="structf_e__integrand__params___n_f_w__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fE_integrand_params_NFW_t</span></span></span><a class="headerlink" href="#_CPPv425fE_integrand_params_NFW_t" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for the NFW distribution function integrand fEintegrand_nfw. </p>
<p>This structure passes all necessary data, including pre-computed splines for <span class="math notranslate nohighlight">\(r(\Psi)\)</span> and <span class="math notranslate nohighlight">\(M(r)\)</span>, physical constants, and profile-specific parameters, to the GSL integration routine for calculating <span class="math notranslate nohighlight">\(I(E)\)</span>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t12accel_M_of_rE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a73b425e7059c36c1053259338016c05e"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">accel_M_of_r</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t12accel_M_of_rE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for the M(r) spline. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t14accel_r_of_PsiE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ad4d7e509dc5b98423646bcaa56c8f02e"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">accel_r_of_Psi</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t14accel_r_of_PsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for the <span class="math notranslate nohighlight">\(r(-\Psi)\)</span> spline. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t17const_G_universalE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a1653e9f5d38710b6651d774a1e1738f0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">const_G_universal</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t17const_G_universalE" title="Link to this definition"></a><br /></dt>
<dd><p>Universal gravitational constant G. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t15E_current_shellE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ac2837b6f19585e32fc8f14cf121e731e"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E_current_shell</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t15E_current_shellE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy E (isotropic) or Q (OM) of the current shell for which I is being computed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t23profile_falloff_C_constE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ab43a143997cc8101756ff4c2c000d169"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">profile_falloff_C_const</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t23profile_falloff_C_constE" title="Link to this definition"></a><br /></dt>
<dd><p>Falloff concentration parameter <span class="math notranslate nohighlight">\(C\)</span> for power-law cutoff in NFW profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t21profile_nt_norm_constE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1afa1031bd4f6fa8f6bfd8a9e04b9b3a9f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">profile_nt_norm_const</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t21profile_nt_norm_constE" title="Link to this definition"></a><br /></dt>
<dd><p>Density normalization constant (nt_nfw) for the NFW profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t16profile_rc_constE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a5d8ca195751221764d81af08b2f5de62"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">profile_rc_const</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t16profile_rc_constE" title="Link to this definition"></a><br /></dt>
<dd><p>Scale radius <span class="math notranslate nohighlight">\(r_c\)</span> of the NFW profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t13Psimax_globalE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a8292eb84ef05b670c509e3576f1c06e6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimax_global</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimax_globalE" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum potential value for physical range validation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t13Psimin_globalE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1adbc535d243213e6d99975f97fb82361d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimin_global</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimin_globalE" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum potential value for physical range validation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t13spline_M_of_rE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1abc3c2fe5222329edeaf1d00372309abb"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spline_M_of_r</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t13spline_M_of_rE" title="Link to this definition"></a><br /></dt>
<dd><p>Spline for M(r), enclosed mass as a function of radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t15spline_r_of_PsiE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ae4aea3ff3e49702e09630e9921192c04"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spline_r_of_Psi</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t15spline_r_of_PsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Spline for <span class="math notranslate nohighlight">\(r(-\Psi)\)</span>: radius as function of negated potential (negation ensures monotonicity for GSL). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t6use_omE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a15ffee286df1cb6a995624321980a824"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_om</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t6use_omE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if using OM (E_current_shell represents Q), 0 if isotropic. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv418fEintegrand_params">
<span class="target" id="structf_eintegrand__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand_params</span></span></span><a class="headerlink" href="#_CPPv418fEintegrand_params" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for energy integration calculations. </p>
<p>Used as <code class="docutils literal notranslate"><span class="pre">void*</span> <span class="pre">params</span></code> argument in GSL integration routines, specifically for distribution function calculations (<code class="docutils literal notranslate"><span class="pre">fEintegrand</span></code>). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params1EE">
<span class="target" id="structf_eintegrand__params_1a8148bf8c4b22bbfd93f59103abc163d6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params1EE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy value <span class="math notranslate nohighlight">\(E\)</span> for isotropic or <span class="math notranslate nohighlight">\(Q\)</span> value for OM. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params9massarrayE">
<span class="target" id="structf_eintegrand__params_1a45ce775bb086d45e113c2c7106884ace"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">massarray</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params9massarrayE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for mass lookups <span class="math notranslate nohighlight">\(M(r)\)</span>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params11rofPsiarrayE">
<span class="target" id="structf_eintegrand__params_1a1760a14a28a84477a7a3444759efc592"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">rofPsiarray</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params11rofPsiarrayE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for radius lookup from potential <span class="math notranslate nohighlight">\(r(\Psi)\)</span>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params10splinemassE">
<span class="target" id="structf_eintegrand__params_1a08bb5a8a8de6922b3e77425fb03266c9"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">splinemass</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params10splinemassE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolation spline for enclosed mass <span class="math notranslate nohighlight">\(M(r)\)</span>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params9splinePsiE">
<span class="target" id="structf_eintegrand__params_1ac2b33746e579217236e1dd75c998c7f2"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">splinePsi</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params9splinePsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolation spline for potential <span class="math notranslate nohighlight">\(\Psi(r)\)</span>. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params6use_omE">
<span class="target" id="structf_eintegrand__params_1a4f75406aa889d958058bfce80292248e"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_om</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params6use_omE" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if using OM (E represents Q), 0 if isotropic (E represents energy). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv416hernquist_params">
<span class="target" id="structhernquist__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hernquist_params</span></span></span><a class="headerlink" href="#_CPPv416hernquist_params" title="Link to this definition"></a><br /></dt>
<dd><p>Struct to pass parameters to the GSL Hernquist density integrand. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16hernquist_params1aE">
<span class="target" id="structhernquist__params_1af4abd840b14f31473a3c7047f6783fdb"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">a</span></span></span><a class="headerlink" href="#_CPPv4N16hernquist_params1aE" title="Link to this definition"></a><br /></dt>
<dd><p>Scale Radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N16hernquist_params1ME">
<span class="target" id="structhernquist__params_1aaee8d0c17b5ff1eb67fc8dd4f818ccc3"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">M</span></span></span><a class="headerlink" href="#_CPPv4N16hernquist_params1ME" title="Link to this definition"></a><br /></dt>
<dd><p>Total Mass. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv426hernquist_potential_params">
<span class="target" id="structhernquist__potential__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">hernquist_potential_params</span></span></span><a class="headerlink" href="#_CPPv426hernquist_potential_params" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N26hernquist_potential_params1aE">
<span class="target" id="structhernquist__potential__params_1a07e85beb8594756b032901c154bba384"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">a</span></span></span><a class="headerlink" href="#_CPPv4N26hernquist_potential_params1aE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N26hernquist_potential_params1ME">
<span class="target" id="structhernquist__potential__params_1aeab2accca027e53d3349c3ac6330844d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">M</span></span></span><a class="headerlink" href="#_CPPv4N26hernquist_potential_params1ME" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49LAndIndex">
<span class="target" id="struct_l_and_index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LAndIndex</span></span></span><a class="headerlink" href="#_CPPv49LAndIndex" title="Link to this definition"></a><br /></dt>
<dd><p>Structure to track angular momentum with particle index and direction. </p>
<p>Used in sorting and selection of particles by angular momentum, especially when finding particles closest to a reference <span class="math notranslate nohighlight">\(L\)</span>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex3idxE">
<span class="target" id="struct_l_and_index_1a6138ce671f1ee01ee02e5a498daefddf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex3idxE" title="Link to this definition"></a><br /></dt>
<dd><p>Original particle index (before sorting by L). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex1LE">
<span class="target" id="struct_l_and_index_1a60d9f7a202ef0503d1115c40b58709da"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex1LE" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum value (or squared difference from Lcompare). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex4signE">
<span class="target" id="struct_l_and_index_1a9ca1d244ef4fbe305a2abc2ee9b85f72"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sign</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex4signE" title="Link to this definition"></a><br /></dt>
<dd><p>Direction indicator (+1 or -1) or sign of (L - Lcompare). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv420nfw_potential_params">
<span class="target" id="structnfw__potential__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nfw_potential_params</span></span></span><a class="headerlink" href="#_CPPv420nfw_potential_params" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20nfw_potential_params7falloffE">
<span class="target" id="structnfw__potential__params_1a22c2096dad5608630292288b60fccd61"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">falloff</span></span></span><a class="headerlink" href="#_CPPv4N20nfw_potential_params7falloffE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20nfw_potential_params1ME">
<span class="target" id="structnfw__potential__params_1aabd36e897d473199287c68ddbe3df10e"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">M</span></span></span><a class="headerlink" href="#_CPPv4N20nfw_potential_params1ME" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20nfw_potential_params13normalizationE">
<span class="target" id="structnfw__potential__params_1aaa89813cf25bc04d19b0c8b373f8ce1e"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">normalization</span></span></span><a class="headerlink" href="#_CPPv4N20nfw_potential_params13normalizationE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20nfw_potential_params4Phi0E">
<span class="target" id="structnfw__potential__params_1a1e41b9b9ef59787b79ef2ccb56115cde"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Phi0</span></span></span><a class="headerlink" href="#_CPPv4N20nfw_potential_params4Phi0E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N20nfw_potential_params2rsE">
<span class="target" id="structnfw__potential__params_1a554ea8851ef57f6fe3265a457c4797df"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rs</span></span></span><a class="headerlink" href="#_CPPv4N20nfw_potential_params2rsE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv421om_mu_integral_params">
<span class="target" id="structom__mu__integral__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">om_mu_integral_params</span></span></span><a class="headerlink" href="#_CPPv421om_mu_integral_params" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for OM <span class="math notranslate nohighlight">\(\mu\)</span>-integral in df_fixed_radius output. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params10fofQ_accelE">
<span class="target" id="structom__mu__integral__params_1ae71be14ab366ca37b3161271a1a35dfe"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fofQ_accel</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params10fofQ_accelE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params11fofQ_interpE">
<span class="target" id="structom__mu__integral__params_1a0c5971ae1c5ac3251daa940470841bd7"></span><span class="n"><span class="pre">gsl_interp</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">fofQ_interp</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params11fofQ_interpE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params7I_arrayE">
<span class="target" id="structom__mu__integral__params_1af417445a90657e05573e8f224b7c0db4"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">I_array</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params7I_arrayE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params12Psi_rf_codesE">
<span class="target" id="structom__mu__integral__params_1af75efb87237202a4e84e2d1c2b4f8b0a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psi_rf_codes</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params12Psi_rf_codesE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params6PsimaxE">
<span class="target" id="structom__mu__integral__params_1af4af593dbf5e4c32f72cb9d62483592c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimax</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params6PsimaxE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params6PsiminE">
<span class="target" id="structom__mu__integral__params_1a3b832cabd750196bb1115add0ca5a188"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimin</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params6PsiminE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params7Q_arrayE">
<span class="target" id="structom__mu__integral__params_1a305d7157930d4e12670eca1b6a584cda"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Q_array</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params7Q_arrayE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params12r_over_ra_sqE">
<span class="target" id="structom__mu__integral__params_1a2be2a61373d31ed8f2d4c0510df5f53f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">r_over_ra_sq</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params12r_over_ra_sqE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N21om_mu_integral_params4v_sqE">
<span class="target" id="structom__mu__integral__params_1a3d6e0993f8c7241c519171d3ee4b47ab"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">v_sq</span></span></span><a class="headerlink" href="#_CPPv4N21om_mu_integral_params4v_sqE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv48PartData">
<span class="target" id="struct_part_data"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PartData</span></span></span><a class="headerlink" href="#_CPPv48PartData" title="Link to this definition"></a><br /></dt>
<dd><p>Compact data structure for particle properties used in sorting and analysis. </p>
<p>Contains essential physical properties (radial position, velocity, angular momentum) and tracking metadata (rank, original index) for each particle in the simulation. Used extensively for sorting, file I/O, and data analysis operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses compact <code class="docutils literal notranslate"><span class="pre">float</span></code> types for physical quantities to reduce memory usage when processing large particle counts. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rank</span></code> field is assigned during radial sorting, while <code class="docutils literal notranslate"><span class="pre">original_index</span></code> preserves the initial array position for tracking particles across snapshots. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData6angmomE">
<span class="target" id="struct_part_data_1a19c621246e1220d18589f0fc3405bc80"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">angmom</span></span></span><a class="headerlink" href="#_CPPv4N8PartData6angmomE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData14original_indexE">
<span class="target" id="struct_part_data_1a03b0004349d68fcc4cf0fa32dace0d98"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">original_index</span></span></span><a class="headerlink" href="#_CPPv4N8PartData14original_indexE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData3radE">
<span class="target" id="struct_part_data_1a378b215a66fde62b868dbaa582b7e0e2"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad</span></span></span><a class="headerlink" href="#_CPPv4N8PartData3radE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData4rankE">
<span class="target" id="struct_part_data_1aceb7fe5a7c0942f79e068ce54ee91dcd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rank</span></span></span><a class="headerlink" href="#_CPPv4N8PartData4rankE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData4vradE">
<span class="target" id="struct_part_data_1a9fb91714a8d216cfa0bc8527bc2d24c7"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrad</span></span></span><a class="headerlink" href="#_CPPv4N8PartData4vradE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv419Psiintegrand_params">
<span class="target" id="struct_psiintegrand__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psiintegrand_params</span></span></span><a class="headerlink" href="#_CPPv419Psiintegrand_params" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for Psiintegrand to support profile-specific mass integrands. </p>
<p>Allows Psiintegrand to call the appropriate mass integrand function based on the selected density profile. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19Psiintegrand_params18massintegrand_funcE">
<span class="target" id="struct_psiintegrand__params_1a08f79ebbb4f859151c641942bee01199"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand_func</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N19Psiintegrand_params18massintegrand_funcE" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer to profile-specific mass integrand. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19Psiintegrand_params24params_for_massintegrandE">
<span class="target" id="struct_psiintegrand__params_1a7129aef313bd4f27e37445aeca27bba3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">params_for_massintegrand</span></span></span><a class="headerlink" href="#_CPPv4N19Psiintegrand_params24params_for_massintegrandE" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for the mass integrand function. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49RrPsiPair">
<span class="target" id="struct_rr_psi_pair"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RrPsiPair</span></span></span><a class="headerlink" href="#_CPPv49RrPsiPair" title="Link to this definition"></a><br /></dt>
<dd><p>Main entry point for the n-sphere dark matter simulation program. </p>
<p>Orchestrates the overall simulation workflow:<ol class="loweralpha simple">
<li><p>Parses command-line arguments using a flexible option system</p></li>
<li><p>Sets up initial conditions (particle distribution, system parameters)</p></li>
<li><p>Executes the selected integration method for trajectory evolution</p></li>
<li><p>Outputs data products (particle states, phase diagrams, energy tracking)</p></li>
<li><p>Handles restart/resume functionality when requested</p></li>
</ol>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a highly parallelized application that takes advantage of OpenMP when available. Performance scales with the number of available cores. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some simulation configurations can be very memory-intensive. For large particle counts ( <span class="math notranslate nohighlight">\(&gt;10^6\)</span>), ensure sufficient RAM is available. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Param argc<span class="colon">:</span></dt>
<dd class="field-odd"><p>[in] Standard argument count from the command line. </p>
</dd>
<dt class="field-even">Param argv<span class="colon">:</span></dt>
<dd class="field-even"><p>[in] Standard array of argument strings from the command line. </p>
</dd>
<dt class="field-odd">Return<span class="colon">:</span></dt>
<dd class="field-odd"><p>Exit code: 0 for successful execution, non-zero for errors.</p>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9RrPsiPair3psiE">
<span class="target" id="struct_rr_psi_pair_1aee931f7363bc481421578669c2d5663c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">psi</span></span></span><a class="headerlink" href="#_CPPv4N9RrPsiPair3psiE" title="Link to this definition"></a><br /></dt>
<dd><p>Corresponding potential value or y-axis value. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9RrPsiPair2rrE">
<span class="target" id="struct_rr_psi_pair_1ab8518b2772c88f6bafef91f3d8b1bdf8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rr</span></span></span><a class="headerlink" href="#_CPPv4N9RrPsiPair2rrE" title="Link to this definition"></a><br /></dt>
<dd><p>Radius value or x-axis value for sorting. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv411threevector">
<span class="target" id="structthreevector"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">threevector</span></span></span><a class="headerlink" href="#_CPPv411threevector" title="Link to this definition"></a><br /></dt>
<dd><p>Three-dimensional vector structure for particle physics calculations. </p>
<p>Represents velocity and position vectors in 3D space for self-interacting dark matter simulations. Components are stored in Cartesian coordinates. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11threevector1xE">
<span class="target" id="structthreevector_1ae10f3b0baf38750c51085e860f59c470"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><a class="headerlink" href="#_CPPv4N11threevector1xE" title="Link to this definition"></a><br /></dt>
<dd><p>x-component of the vector. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11threevector1yE">
<span class="target" id="structthreevector_1acd143be9d252b1c65cdec417ce21e6b1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">y</span></span></span><a class="headerlink" href="#_CPPv4N11threevector1yE" title="Link to this definition"></a><br /></dt>
<dd><p>y-component of the vector. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11threevector1zE">
<span class="target" id="structthreevector_1ac9effd86f9ab947dfeceddcf1ab34c5a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">z</span></span></span><a class="headerlink" href="#_CPPv4N11threevector1zE" title="Link to this definition"></a><br /></dt>
<dd><p>z-component of the vector. </p>
</dd></dl>

</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="C API Reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nsphere_sort.html" class="btn btn-neutral float-right" title="NSphere Sort (nsphere_sort.h)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kris Sigurdson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>