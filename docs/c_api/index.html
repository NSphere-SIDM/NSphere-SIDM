

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C API Reference &mdash; NSphere  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
      <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
      <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python API Reference" href="../python_api/index.html" />
    <link rel="prev" title="Data and Results Flow" href="../data_flow/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NSphere
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../command_line/index.html">Command-Line Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_flow/index.html">Data and Results Flow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nsphere-core-nsphere-c">NSphere Core (<cite>nsphere.c</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.MYBINIO_H"><code class="docutils literal notranslate"><span class="pre">MYBINIO_H</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CLEAN_EXIT"><code class="docutils literal notranslate"><span class="pre">CLEAN_EXIT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.imin"><code class="docutils literal notranslate"><span class="pre">imin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RC"><code class="docutils literal notranslate"><span class="pre">RC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RC_NFW_DEFAULT"><code class="docutils literal notranslate"><span class="pre">RC_NFW_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HALO_MASS_NFW"><code class="docutils literal notranslate"><span class="pre">HALO_MASS_NFW</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HALO_MASS"><code class="docutils literal notranslate"><span class="pre">HALO_MASS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CUTOFF_FACTOR_NFW_DEFAULT"><code class="docutils literal notranslate"><span class="pre">CUTOFF_FACTOR_NFW_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CUTOFF_FACTOR_CORED_DEFAULT"><code class="docutils literal notranslate"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.FALLOFF_FACTOR_NFW_DEFAULT"><code class="docutils literal notranslate"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.NUM_MINI_SUBSTEPS_BOOTSTRAP"><code class="docutils literal notranslate"><span class="pre">NUM_MINI_SUBSTEPS_BOOTSTRAP</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DEBUG"><code class="docutils literal notranslate"><span class="pre">IF_DEBUG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DYNPSI"><code class="docutils literal notranslate"><span class="pre">IF_DYNPSI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DYNRANK"><code class="docutils literal notranslate"><span class="pre">IF_DYNRANK</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_ALL_PART"><code class="docutils literal notranslate"><span class="pre">IF_ALL_PART</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PI"><code class="docutils literal notranslate"><span class="pre">PI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.G_CONST"><code class="docutils literal notranslate"><span class="pre">G_CONST</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.sqr"><code class="docutils literal notranslate"><span class="pre">sqr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.cube"><code class="docutils literal notranslate"><span class="pre">cube</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.kmsec_to_kpcmyr"><code class="docutils literal notranslate"><span class="pre">kmsec_to_kpcmyr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.VEL_CONV_SQ"><code class="docutils literal notranslate"><span class="pre">VEL_CONV_SQ</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CLEAN_LOCAL_EXIT"><code class="docutils literal notranslate"><span class="pre">CLEAN_LOCAL_EXIT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.DEBUG_PARTICLE_ID"><code class="docutils literal notranslate"><span class="pre">DEBUG_PARTICLE_ID</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.DEBUG_MAX_STEPS"><code class="docutils literal notranslate"><span class="pre">DEBUG_MAX_STEPS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HIST_NBINS"><code class="docutils literal notranslate"><span class="pre">HIST_NBINS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416make_threevectorddd"><code class="docutils literal notranslate"><span class="pre">make_threevector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410dotproduct11threevector11threevector"><code class="docutils literal notranslate"><span class="pre">dotproduct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412crossproduct11threevector11threevector"><code class="docutils literal notranslate"><span class="pre">crossproduct()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410sigmatotaldidd"><code class="docutils literal notranslate"><span class="pre">sigmatotal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430perform_sidm_scattering_serialPPdiddP7gsl_rngPxdd"><code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_serial()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv432perform_sidm_scattering_parallelPPdiddPP7gsl_rngiPxdd"><code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_parallel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421get_suffixed_filenamePKciPc6size_t"><code class="docutils literal notranslate"><span class="pre">get_suffixed_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411log_messagePKcPKcz"><code class="docutils literal notranslate"><span class="pre">log_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416format_file_sizelPc6size_t"><code class="docutils literal notranslate"><span class="pre">format_file_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411fprintf_binP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fprintf_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410fscanf_binP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fscanf_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425cleanup_all_particle_datav"><code class="docutils literal notranslate"><span class="pre">cleanup_all_particle_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422free_local_snap_arraysv"><code class="docutils literal notranslate"><span class="pre">free_local_snap_arrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419gravitational_forcediidd"><code class="docutils literal notranslate"><span class="pre">gravitational_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423effective_angular_forcedd"><code class="docutils literal notranslate"><span class="pre">effective_angular_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425gravitational_force_rho_vdiidd"><code class="docutils literal notranslate"><span class="pre">gravitational_force_rho_v()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429effective_angular_force_rho_vdd"><code class="docutils literal notranslate"><span class="pre">effective_angular_force_rho_v()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419store_debug_approxEidd"><code class="docutils literal notranslate"><span class="pre">store_debug_approxE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427store_debug_dynE_componentsiddddd"><code class="docutils literal notranslate"><span class="pre">store_debug_dynE_components()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428finalize_debug_energy_outputv"><code class="docutils literal notranslate"><span class="pre">finalize_debug_energy_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410double_cmpPKvPKv"><code class="docutils literal notranslate"><span class="pre">double_cmp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417compare_particlesPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414sort_particlesPPdi"><code class="docutils literal notranslate"><span class="pre">sort_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423sort_particles_with_algPPdiPKc"><code class="docutils literal notranslate"><span class="pre">sort_particles_with_alg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418sort_rr_psi_arraysPdPdi"><code class="docutils literal notranslate"><span class="pre">sort_rr_psi_arrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413massintegranddPv"><code class="docutils literal notranslate"><span class="pre">massintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv431massintegrand_profile_nfwcutoffdPv"><code class="docutils literal notranslate"><span class="pre">massintegrand_profile_nfwcutoff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424drhodr_profile_nfwcutoffdddd"><code class="docutils literal notranslate"><span class="pre">drhodr_profile_nfwcutoff()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415fEintegrand_nfwdPv"><code class="docutils literal notranslate"><span class="pre">fEintegrand_nfw()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46drhodrd"><code class="docutils literal notranslate"><span class="pre">drhodr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412PsiintegranddPv"><code class="docutils literal notranslate"><span class="pre">Psiintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld"><code class="docutils literal notranslate"><span class="pre">evaluatespline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411fEintegranddPv"><code class="docutils literal notranslate"><span class="pre">fEintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47cmp_LAIPKvPKv"><code class="docutils literal notranslate"><span class="pre">cmp_LAI()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49isIntegerPKc"><code class="docutils literal notranslate"><span class="pre">isInteger()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47isFloatPKc"><code class="docutils literal notranslate"><span class="pre">isFloat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410printUsagePKc"><code class="docutils literal notranslate"><span class="pre">printUsage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412errorAndExitPKcPKcPKc"><code class="docutils literal notranslate"><span class="pre">errorAndExit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411sort_by_radP8PartDatai"><code class="docutils literal notranslate"><span class="pre">sort_by_rad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf"><code class="docutils literal notranslate"><span class="pre">append_all_particle_data_chunk_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf"><code class="docutils literal notranslate"><span class="pre">retrieve_all_particle_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417adjust_ntimestepsiii"><code class="docutils literal notranslate"><span class="pre">adjust_ntimesteps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415doMicroLeapfrogiiddddiidPdPd"><code class="docutils literal notranslate"><span class="pre">doMicroLeapfrog()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418doAdaptiveFullLeapiiddddddidiPdPd"><code class="docutils literal notranslate"><span class="pre">doAdaptiveFullLeap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411dRhoDtaufundd"><code class="docutils literal notranslate"><span class="pre">dRhoDtaufun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410forceLCfuniidddd"><code class="docutils literal notranslate"><span class="pre">forceLCfun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420doLeviCivitaLeapfrogiiddddidPdPd"><code class="docutils literal notranslate"><span class="pre">doLeviCivitaLeapfrog()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417doMicroLeviCivitaiidddidddPdPdPd"><code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd"><code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd"><code class="docutils literal notranslate"><span class="pre">doAdaptiveFullLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424write_initial_conditionsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">write_initial_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423read_initial_conditionsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">read_initial_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420get_sort_descriptionPKc"><code class="docutils literal notranslate"><span class="pre">get_sort_description()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413parseSaveArgsiA_PcPi"><code class="docutils literal notranslate"><span class="pre">parseSaveArgs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427reassign_orig_ids_with_rankPdi"><code class="docutils literal notranslate"><span class="pre">reassign_orig_ids_with_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424fft_gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427direct_gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428find_last_processed_snapshotPii"><code class="docutils literal notranslate"><span class="pre">find_last_processed_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413compare_by_rrPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_by_rr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425check_strict_monotonicityPKdiPKc"><code class="docutils literal notranslate"><span class="pre">check_strict_monotonicity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416handle_sidm_stepPPdidddii"><code class="docutils literal notranslate"><span class="pre">handle_sidm_step()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424get_available_disk_spacePKc"><code class="docutils literal notranslate"><span class="pre">get_available_disk_space()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413prompt_yes_noPKc"><code class="docutils literal notranslate"><span class="pre">prompt_yes_no()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv44mainiA_Pc"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414insertion_sortPPdi"><code class="docutils literal notranslate"><span class="pre">insertion_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420stdlib_qsort_wrapperPPdi"><code class="docutils literal notranslate"><span class="pre">stdlib_qsort_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416quadsort_wrapperPPdi"><code class="docutils literal notranslate"><span class="pre">quadsort_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418insertion_sort_subPPdii"><code class="docutils literal notranslate"><span class="pre">insertion_sort_sub()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423insertion_parallel_sortPPdi"><code class="docutils literal notranslate"><span class="pre">insertion_parallel_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422quadsort_parallel_sortPPdi"><code class="docutils literal notranslate"><span class="pre">quadsort_parallel_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419verify_sort_resultsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">verify_sort_results()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423compare_partdata_by_radPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_partdata_by_rad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422compare_scatter_eventsPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_scatter_events()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_file_suffix"><code class="docutils literal notranslate"><span class="pre">g_file_suffix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv45g_rng"><code class="docutils literal notranslate"><span class="pre">g_rng</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_rng_per_thread"><code class="docutils literal notranslate"><span class="pre">g_rng_per_thread</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_max_omp_threads_for_rng"><code class="docutils literal notranslate"><span class="pre">g_max_omp_threads_for_rng</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_sort_columns_buffer"><code class="docutils literal notranslate"><span class="pre">g_sort_columns_buffer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_sort_columns_buffer_npts"><code class="docutils literal notranslate"><span class="pre">g_sort_columns_buffer_npts</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_nfw_splinemass_for_force"><code class="docutils literal notranslate"><span class="pre">g_nfw_splinemass_for_force</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv434g_nfw_enclosedmass_accel_for_force"><code class="docutils literal notranslate"><span class="pre">g_nfw_enclosedmass_accel_for_force</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430PARALLEL_SORT_DEFAULT_SECTIONS"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_DEFAULT_SECTIONS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433PARALLEL_SORT_SECTIONS_PER_THREAD"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_SECTIONS_PER_THREAD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429PARALLEL_SORT_OVERLAP_DIVISOR"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_OVERLAP_DIVISOR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv437PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv438PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD"><code class="docutils literal notranslate"><span class="pre">PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_enable_logging"><code class="docutils literal notranslate"><span class="pre">g_enable_logging</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49g_doDebug"><code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410g_doDynPsi"><code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_doDynRank"><code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419g_doAllParticleData"><code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_doRestart"><code class="docutils literal notranslate"><span class="pre">g_doRestart</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416skip_file_writes"><code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424g_enable_sidm_scattering"><code class="docutils literal notranslate"><span class="pre">g_enable_sidm_scattering</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_sidm_execution_mode"><code class="docutils literal notranslate"><span class="pre">g_sidm_execution_mode</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_total_sidm_scatters"><code class="docutils literal notranslate"><span class="pre">g_total_sidm_scatters</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412g_sidm_kappa"><code class="docutils literal notranslate"><span class="pre">g_sidm_kappa</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_sidm_kappa_provided"><code class="docutils literal notranslate"><span class="pre">g_sidm_kappa_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424g_particle_scatter_state"><code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_master_seed"><code class="docutils literal notranslate"><span class="pre">g_master_seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419g_initial_cond_seed"><code class="docutils literal notranslate"><span class="pre">g_initial_cond_seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_sidm_seed"><code class="docutils literal notranslate"><span class="pre">g_sidm_seed</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_master_seed_provided"><code class="docutils literal notranslate"><span class="pre">g_master_seed_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428g_initial_cond_seed_provided"><code class="docutils literal notranslate"><span class="pre">g_initial_cond_seed_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_sidm_seed_provided"><code class="docutils literal notranslate"><span class="pre">g_sidm_seed_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_attempt_load_seeds"><code class="docutils literal notranslate"><span class="pre">g_attempt_load_seeds</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433g_initial_cond_seed_filename_base"><code class="docutils literal notranslate"><span class="pre">g_initial_cond_seed_filename_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_sidm_seed_filename_base"><code class="docutils literal notranslate"><span class="pre">g_sidm_seed_filename_base</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_use_nfw_profile"><code class="docutils literal notranslate"><span class="pre">g_use_nfw_profile</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_nfw_profile_rc"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_rc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423g_nfw_profile_halo_mass"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_halo_mass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430g_nfw_profile_rmax_norm_factor"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_rmax_norm_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428g_nfw_profile_falloff_factor"><code class="docutils literal notranslate"><span class="pre">g_nfw_profile_falloff_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420g_scale_radius_param"><code class="docutils literal notranslate"><span class="pre">g_scale_radius_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417g_halo_mass_param"><code class="docutils literal notranslate"><span class="pre">g_halo_mass_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421g_cutoff_factor_param"><code class="docutils literal notranslate"><span class="pre">g_cutoff_factor_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_profile_type_str"><code class="docutils literal notranslate"><span class="pre">g_profile_type_str</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429g_scale_radius_param_provided"><code class="docutils literal notranslate"><span class="pre">g_scale_radius_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv426g_halo_mass_param_provided"><code class="docutils literal notranslate"><span class="pre">g_halo_mass_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430g_cutoff_factor_param_provided"><code class="docutils literal notranslate"><span class="pre">g_cutoff_factor_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422g_falloff_factor_param"><code class="docutils literal notranslate"><span class="pre">g_falloff_factor_param</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv431g_falloff_factor_param_provided"><code class="docutils literal notranslate"><span class="pre">g_falloff_factor_param_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427g_profile_type_str_provided"><code class="docutils literal notranslate"><span class="pre">g_profile_type_str_provided</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_cored_profile_rc"><code class="docutils literal notranslate"><span class="pre">g_cored_profile_rc</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425g_cored_profile_halo_mass"><code class="docutils literal notranslate"><span class="pre">g_cored_profile_halo_mass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427g_cored_profile_rmax_factor"><code class="docutils literal notranslate"><span class="pre">g_cored_profile_rmax_factor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424debug_direct_convolution"><code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418g_active_halo_mass"><code class="docutils literal notranslate"><span class="pre">g_active_halo_mass</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423use_closest_to_Lcompare"><code class="docutils literal notranslate"><span class="pre">use_closest_to_Lcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48Lcompare"><code class="docutils literal notranslate"><span class="pre">Lcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418Rank_partdata_snap"><code class="docutils literal notranslate"><span class="pre">Rank_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415R_partdata_snap"><code class="docutils literal notranslate"><span class="pre">R_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418Vrad_partdata_snap"><code class="docutils literal notranslate"><span class="pre">Vrad_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415L_partdata_snap"><code class="docutils literal notranslate"><span class="pre">L_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47L_block"><code class="docutils literal notranslate"><span class="pre">L_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410Rank_block"><code class="docutils literal notranslate"><span class="pre">Rank_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47R_block"><code class="docutils literal notranslate"><span class="pre">R_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410Vrad_block"><code class="docutils literal notranslate"><span class="pre">Vrad_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47nlowest"><code class="docutils literal notranslate"><span class="pre">nlowest</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46chosen"><code class="docutils literal notranslate"><span class="pre">chosen</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49lowestL_r"><code class="docutils literal notranslate"><span class="pre">lowestL_r</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49lowestL_E"><code class="docutils literal notranslate"><span class="pre">lowestL_E</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49lowestL_L"><code class="docutils literal notranslate"><span class="pre">lowestL_L</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420use_identity_gravity"><code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411dbg_approxE"><code class="docutils literal notranslate"><span class="pre">dbg_approxE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_dynE"><code class="docutils literal notranslate"><span class="pre">dbg_dynE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_kinE"><code class="docutils literal notranslate"><span class="pre">dbg_kinE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_potE"><code class="docutils literal notranslate"><span class="pre">dbg_potE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_time"><code class="docutils literal notranslate"><span class="pre">dbg_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410dbg_radius"><code class="docutils literal notranslate"><span class="pre">dbg_radius</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49dbg_count"><code class="docutils literal notranslate"><span class="pre">dbg_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413normalization"><code class="docutils literal notranslate"><span class="pre">normalization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410doReadInit"><code class="docutils literal notranslate"><span class="pre">doReadInit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411doWriteInit"><code class="docutils literal notranslate"><span class="pre">doWriteInit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416readInitFilename"><code class="docutils literal notranslate"><span class="pre">readInitFilename</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417writeInitFilename"><code class="docutils literal notranslate"><span class="pre">writeInitFilename</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_defaultSortAlg"><code class="docutils literal notranslate"><span class="pre">g_defaultSortAlg</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411threevector"><code class="docutils literal notranslate"><span class="pre">threevector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11threevector1xE"><code class="docutils literal notranslate"><span class="pre">x</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11threevector1yE"><code class="docutils literal notranslate"><span class="pre">y</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N11threevector1zE"><code class="docutils literal notranslate"><span class="pre">z</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412ScatterEvent"><code class="docutils literal notranslate"><span class="pre">ScatterEvent</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12ScatterEvent1iE"><code class="docutils literal notranslate"><span class="pre">i</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12ScatterEvent8m_offsetE"><code class="docutils literal notranslate"><span class="pre">m_offset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12ScatterEvent7VifinalE"><code class="docutils literal notranslate"><span class="pre">Vifinal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N12ScatterEvent7VmfinalE"><code class="docutils literal notranslate"><span class="pre">Vmfinal</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425fE_integrand_params_NFW_t"><code class="docutils literal notranslate"><span class="pre">fE_integrand_params_NFW_t</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t15E_current_shellE"><code class="docutils literal notranslate"><span class="pre">E_current_shell</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t15spline_r_of_PsiE"><code class="docutils literal notranslate"><span class="pre">spline_r_of_Psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t14accel_r_of_PsiE"><code class="docutils literal notranslate"><span class="pre">accel_r_of_Psi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t13spline_M_of_rE"><code class="docutils literal notranslate"><span class="pre">spline_M_of_r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t12accel_M_of_rE"><code class="docutils literal notranslate"><span class="pre">accel_M_of_r</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t17const_G_universalE"><code class="docutils literal notranslate"><span class="pre">const_G_universal</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t16profile_rc_constE"><code class="docutils literal notranslate"><span class="pre">profile_rc_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t21profile_nt_norm_constE"><code class="docutils literal notranslate"><span class="pre">profile_nt_norm_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t23profile_falloff_C_constE"><code class="docutils literal notranslate"><span class="pre">profile_falloff_C_const</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimin_globalE"><code class="docutils literal notranslate"><span class="pre">Psimin_global</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimax_globalE"><code class="docutils literal notranslate"><span class="pre">Psimax_global</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418fEintegrand_params"><code class="docutils literal notranslate"><span class="pre">fEintegrand_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params1EE"><code class="docutils literal notranslate"><span class="pre">E</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params9splinePsiE"><code class="docutils literal notranslate"><span class="pre">splinePsi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params10splinemassE"><code class="docutils literal notranslate"><span class="pre">splinemass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params11rofPsiarrayE"><code class="docutils literal notranslate"><span class="pre">rofPsiarray</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params9massarrayE"><code class="docutils literal notranslate"><span class="pre">massarray</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419Psiintegrand_params"><code class="docutils literal notranslate"><span class="pre">Psiintegrand_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N19Psiintegrand_params18massintegrand_funcE"><code class="docutils literal notranslate"><span class="pre">massintegrand_func</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N19Psiintegrand_params24params_for_massintegrandE"><code class="docutils literal notranslate"><span class="pre">params_for_massintegrand</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49LAndIndex"><code class="docutils literal notranslate"><span class="pre">LAndIndex</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex1LE"><code class="docutils literal notranslate"><span class="pre">L</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex3idxE"><code class="docutils literal notranslate"><span class="pre">idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex4signE"><code class="docutils literal notranslate"><span class="pre">sign</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48PartData"><code class="docutils literal notranslate"><span class="pre">PartData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData4rankE"><code class="docutils literal notranslate"><span class="pre">rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData3radE"><code class="docutils literal notranslate"><span class="pre">rad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData4vradE"><code class="docutils literal notranslate"><span class="pre">vrad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData6angmomE"><code class="docutils literal notranslate"><span class="pre">angmom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData14original_indexE"><code class="docutils literal notranslate"><span class="pre">original_index</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49RrPsiPair"><code class="docutils literal notranslate"><span class="pre">RrPsiPair</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9RrPsiPair2rrE"><code class="docutils literal notranslate"><span class="pre">rr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9RrPsiPair3psiE"><code class="docutils literal notranslate"><span class="pre">psi</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nsphere-sort-nsphere-sort-h">NSphere Sort (<cite>nsphere_sort.h</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_array"><code class="docutils literal notranslate"><span class="pre">ns_sort_array</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_prim"><code class="docutils literal notranslate"><span class="pre">ns_sort_prim</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_size"><code class="docutils literal notranslate"><span class="pre">ns_sort_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_extended"><code class="docutils literal notranslate"><span class="pre">ns_sort_extended</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420ns_quadsort_extendedPv6size_t6size_tP7CMPFUNC"><code class="docutils literal notranslate"><span class="pre">ns_quadsort_extended()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quadsort-quadsort-c-quadsort-h">QuadSort (<cite>quadsort.c</cite> / <cite>quadsort.h</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.QUAD_CACHE"><code class="docutils literal notranslate"><span class="pre">QUAD_CACHE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.head_branchless_merge"><code class="docutils literal notranslate"><span class="pre">head_branchless_merge</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.tail_branchless_merge"><code class="docutils literal notranslate"><span class="pre">tail_branchless_merge</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.parity_merge_two"><code class="docutils literal notranslate"><span class="pre">parity_merge_two</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.parity_merge_four"><code class="docutils literal notranslate"><span class="pre">parity_merge_four</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.branchless_swap"><code class="docutils literal notranslate"><span class="pre">branchless_swap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.swap_branchless"><code class="docutils literal notranslate"><span class="pre">swap_branchless</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.VAR"><code class="docutils literal notranslate"><span class="pre">VAR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.FUNC"><code class="docutils literal notranslate"><span class="pre">FUNC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.cmp"><code class="docutils literal notranslate"><span class="pre">cmp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47CMPFUNC"><code class="docutils literal notranslate"><span class="pre">CMPFUNC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48quadsortPv6size_t6size_tP7CMPFUNC"><code class="docutils literal notranslate"><span class="pre">quadsort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413quadsort_primPv6size_t6size_t"><code class="docutils literal notranslate"><span class="pre">quadsort_prim()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413quadsort_sizePv6size_t6size_tP7CMPFUNC"><code class="docutils literal notranslate"><span class="pre">quadsort_size()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../python_api/index.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NSphere</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">C API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/c_api/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="c-api-reference">
<h1>C API Reference<a class="headerlink" href="#c-api-reference" title="Link to this heading"></a></h1>
<p>This section provides detailed documentation for the C components of NSphere, generated from source code comments using Doxygen and Breathe.</p>
<section id="nsphere-core-nsphere-c">
<h2>NSphere Core (<cite>nsphere.c</cite>)<a class="headerlink" href="#nsphere-core-nsphere-c" title="Link to this heading"></a></h2>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.MYBINIO_H">
<span class="target" id="nsphere_8c_1a8a7cdbd9f0c6050c69cf5edb33079101"></span><span class="sig-name descname"><span class="n"><span class="pre">MYBINIO_H</span></span></span><a class="headerlink" href="#c.MYBINIO_H" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CLEAN_EXIT">
<span class="target" id="nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"></span><span class="sig-name descname"><span class="n"><span class="pre">CLEAN_EXIT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CLEAN_EXIT" title="Link to this definition"></a><br /></dt>
<dd><p>Thread-safe exit macro that properly cleans up allocated resources. </p>
<p>This macro ensures proper resource cleanup before program termination:<ul class="simple">
<li><p>Uses OpenMP critical section to ensure only one thread performs cleanup.</p></li>
<li><p>Calls <a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a> and <a class="reference internal" href="#nsphere_8c_1a4237306378c83f198a54fc2feac8e5eb"><span class="std std-ref">free_local_snap_arrays()</span></a> to free dynamically allocated memory.</p></li>
<li><p>Exits with the specified error code.</p></li>
</ul>
</p>
<p><dl>
<dt><strong>Example</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">error_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CLEAN_EXIT</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> -- The exit code for the program.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.imin">
<span class="target" id="nsphere_8c_1a9e512761aee37544a1f18ee854407b87"></span><span class="sig-name descname"><span class="n"><span class="pre">imin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.imin" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RC">
<span class="target" id="nsphere_8c_1a9de40e06982123e40c3c92b5db6d7640"></span><span class="sig-name descname"><span class="n"><span class="pre">RC</span></span></span><a class="headerlink" href="#c.RC" title="Link to this definition"></a><br /></dt>
<dd><p>Core radius in kpc. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RC_NFW_DEFAULT">
<span class="target" id="nsphere_8c_1a5feffe4681c8f5d7e6096678b2d94b9d"></span><span class="sig-name descname"><span class="n"><span class="pre">RC_NFW_DEFAULT</span></span></span><a class="headerlink" href="#c.RC_NFW_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default NFW profile scale radius (kpc). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HALO_MASS_NFW">
<span class="target" id="nsphere_8c_1ab5be2218953aa22f1eda20f8a065ffde"></span><span class="sig-name descname"><span class="n"><span class="pre">HALO_MASS_NFW</span></span></span><a class="headerlink" href="#c.HALO_MASS_NFW" title="Link to this definition"></a><br /></dt>
<dd><p>Default NFW profile halo mass in solar masses (Msun). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HALO_MASS">
<span class="target" id="nsphere_8c_1a6dfa358045ebb8fb55bbef34f5151786"></span><span class="sig-name descname"><span class="n"><span class="pre">HALO_MASS</span></span></span><a class="headerlink" href="#c.HALO_MASS" title="Link to this definition"></a><br /></dt>
<dd><p>Default general halo mass (used for Cored profile by default) in Msun. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CUTOFF_FACTOR_NFW_DEFAULT">
<span class="target" id="nsphere_8c_1a91dd721f8691889d511b2d2d233cf884"></span><span class="sig-name descname"><span class="n"><span class="pre">CUTOFF_FACTOR_NFW_DEFAULT</span></span></span><a class="headerlink" href="#c.CUTOFF_FACTOR_NFW_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default rmax factor for NFW profile (rmax = factor * rc). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CUTOFF_FACTOR_CORED_DEFAULT">
<span class="target" id="nsphere_8c_1a5d16973bb95b421ae8100c8a4b36a8c7"></span><span class="sig-name descname"><span class="n"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></span></span><a class="headerlink" href="#c.CUTOFF_FACTOR_CORED_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default rmax factor for Cored profile (rmax = factor * rc). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.FALLOFF_FACTOR_NFW_DEFAULT">
<span class="target" id="nsphere_8c_1a1ff1990d20151562a3598b02763b07fe"></span><span class="sig-name descname"><span class="n"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></span></span><a class="headerlink" href="#c.FALLOFF_FACTOR_NFW_DEFAULT" title="Link to this definition"></a><br /></dt>
<dd><p>Default falloff factor for NFW profile (C_cutoff_factor). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.NUM_MINI_SUBSTEPS_BOOTSTRAP">
<span class="target" id="nsphere_8c_1aae2fd93ceb16ef535f7af25b5b7ffd7d"></span><span class="sig-name descname"><span class="n"><span class="pre">NUM_MINI_SUBSTEPS_BOOTSTRAP</span></span></span><a class="headerlink" href="#c.NUM_MINI_SUBSTEPS_BOOTSTRAP" title="Link to this definition"></a><br /></dt>
<dd><p>Number of mini Euler steps per bootstrap full step. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DEBUG">
<span class="target" id="nsphere_8c_1a084107b11a831e4b4bf3e83327b903b5"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DEBUG</span></span></span><a class="headerlink" href="#c.IF_DEBUG" title="Link to this definition"></a><br /></dt>
<dd><p>Conditional compilation macros for feature flags. </p>
<p>These macros provide a cleaner syntax for conditional code blocks that depend on the global feature flags.</p>
<p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DYNPSI">
<span class="target" id="nsphere_8c_1a293d1823eeb32494bd8d0dfb3152b004"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DYNPSI</span></span></span><a class="headerlink" href="#c.IF_DYNPSI" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DYNRANK">
<span class="target" id="nsphere_8c_1a30d555dd887fc6c09e9d6cbb9accc0e5"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DYNRANK</span></span></span><a class="headerlink" href="#c.IF_DYNRANK" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_ALL_PART">
<span class="target" id="nsphere_8c_1ac2a7d072f22c12400574ce6ecec1b2f3"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_ALL_PART</span></span></span><a class="headerlink" href="#c.IF_ALL_PART" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PI">
<span class="target" id="nsphere_8c_1a598a3330b3c21701223ee0ca14316eca"></span><span class="sig-name descname"><span class="n"><span class="pre">PI</span></span></span><a class="headerlink" href="#c.PI" title="Link to this definition"></a><br /></dt>
<dd><p>Mathematical constant Pi. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.G_CONST">
<span class="target" id="nsphere_8c_1ac4c50d2ec5229af74ea12911980e265a"></span><span class="sig-name descname"><span class="n"><span class="pre">G_CONST</span></span></span><a class="headerlink" href="#c.G_CONST" title="Link to this definition"></a><br /></dt>
<dd><p>Newton's gravitational constant in kpc (km/sec)^2/Msun. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.sqr">
<span class="target" id="nsphere_8c_1adee8c6d2fc20a1194cf64c481e7b6353"></span><span class="sig-name descname"><span class="n"><span class="pre">sqr</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sqr" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cube">
<span class="target" id="nsphere_8c_1a8368822f21884eec2e99ce31c08b0df4"></span><span class="sig-name descname"><span class="n"><span class="pre">cube</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cube" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.kmsec_to_kpcmyr">
<span class="target" id="nsphere_8c_1a27bf9b96269ee7511a077c4c908a37c0"></span><span class="sig-name descname"><span class="n"><span class="pre">kmsec_to_kpcmyr</span></span></span><a class="headerlink" href="#c.kmsec_to_kpcmyr" title="Link to this definition"></a><br /></dt>
<dd><p>Conversion factor: km/s to kpc/Myr. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.VEL_CONV_SQ">
<span class="target" id="nsphere_8c_1ac95cb8dbb481dff84064cae250b647ef"></span><span class="sig-name descname"><span class="n"><span class="pre">VEL_CONV_SQ</span></span></span><a class="headerlink" href="#c.VEL_CONV_SQ" title="Link to this definition"></a><br /></dt>
<dd><p>Velocity conversion squared (kpc/Myr)^2 per (km/s)^2. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CLEAN_LOCAL_EXIT">
<span class="target" id="nsphere_8c_1ab44d6b36e8f42f8d0abbb57735dae501"></span><span class="sig-name descname"><span class="n"><span class="pre">CLEAN_LOCAL_EXIT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CLEAN_LOCAL_EXIT" title="Link to this definition"></a><br /></dt>
<dd><p>Non-thread-safe exit macro for cleanup and termination. </p>
<p>Performs cleanup and exits in single-threaded contexts:<ul class="simple">
<li><p>Frees local snapshot arrays via <a class="reference internal" href="#nsphere_8c_1a4237306378c83f198a54fc2feac8e5eb"><span class="std std-ref">free_local_snap_arrays()</span></a>.</p></li>
<li><p>Cleans up all global particle data arrays via <a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a>.</p></li>
<li><p>Exits with the specified error code.</p></li>
</ul>
</p>
<p><dl>
<dt><strong>Example</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">error_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CLEAN_LOCAL_EXIT</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not thread-safe. Use only in single-threaded contexts or where thread safety is guaranteed by other means.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> -- The exit code for the program.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.DEBUG_PARTICLE_ID">
<span class="target" id="nsphere_8c_1ad93df23038c4de269c9c6b66dc4a3f56"></span><span class="sig-name descname"><span class="n"><span class="pre">DEBUG_PARTICLE_ID</span></span></span><a class="headerlink" href="#c.DEBUG_PARTICLE_ID" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.DEBUG_MAX_STEPS">
<span class="target" id="nsphere_8c_1a85a9270015b4ab8087c007d98dd57808"></span><span class="sig-name descname"><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span></span><a class="headerlink" href="#c.DEBUG_MAX_STEPS" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HIST_NBINS">
<span class="target" id="nsphere_8c_1aa192737d626c2dfbf13c1078f6ce701d"></span><span class="sig-name descname"><span class="n"><span class="pre">HIST_NBINS</span></span></span><a class="headerlink" href="#c.HIST_NBINS" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1a415c6d1c558074ad329697f2c01820fc"></span><span class="sig-name descname"><span class="pre">static</span> <span class="pre">int</span> <span class="pre">__attribute__</span> <span class="pre">((unused))</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416make_threevectorddd">
<span class="target" id="nsphere_8c_1a76679a4c5de497c0ffecd96f6f21cca2"></span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_threevector</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">z</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416make_threevectorddd" title="Link to this definition"></a><br /></dt>
<dd><p>Constructs a three-dimensional vector from its Cartesian components. </p>
<p>This utility function initializes a <code class="docutils literal notranslate"><span class="pre">threevector</span></code> structure with the provided x, y, and z components. It serves as a convenient constructor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> -- [in] The x-component of the vector. </p></li>
<li><p><strong>y</strong> -- [in] The y-component of the vector. </p></li>
<li><p><strong>z</strong> -- [in] The z-component of the vector. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>threevector An initialized <code class="docutils literal notranslate"><span class="pre">threevector</span></code> structure. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410dotproduct11threevector11threevector">
<span class="target" id="nsphere_8c_1a7bfc5a1ebba2824215129d3539ed2ed7"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dotproduct</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">X</span></span>, <a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">Y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410dotproduct11threevector11threevector" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the scalar dot product of two three-dimensional vectors. </p>
<p>Calculates <span class="math notranslate nohighlight">\(X \cdot Y = X_x Y_x + X_y Y_y + X_z Y_z\)</span>. The dot product is a measure of the projection of one vector onto another and is used in various physics calculations, such as determining the magnitude squared of a vector ( <span class="math notranslate nohighlight">\(V \cdot V = |V|^2\)</span>) or the angle between vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> -- [in] The first threevector operand. </p></li>
<li><p><strong>Y</strong> -- [in] The second threevector operand. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The scalar result of the dot product <span class="math notranslate nohighlight">\(X \cdot Y\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412crossproduct11threevector11threevector">
<span class="target" id="nsphere_8c_1a36a6435a975f2de2667a3e78627d1459"></span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">crossproduct</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">X</span></span>, <a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">Y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412crossproduct11threevector11threevector" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the vector cross product of two three-dimensional vectors. </p>
<p>Calculates <span class="math notranslate nohighlight">\(Z = X \times Y\)</span>, where <span class="math notranslate nohighlight">\(X = (X_x, X_y, X_z)\)</span> and <span class="math notranslate nohighlight">\(Y = (Y_x, Y_y, Y_z)\)</span>. The components of the resulting vector <span class="math notranslate nohighlight">\(Z\)</span> are determined by: <span class="math notranslate nohighlight">\(Z_x = X_y Y_z - X_z Y_y\)</span> <span class="math notranslate nohighlight">\(Z_y = X_z Y_x - X_x Y_z\)</span> <span class="math notranslate nohighlight">\(Z_z = X_x Y_y - X_y Y_x\)</span> This follows the standard right-hand rule for vector cross products.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> -- [in] The first threevector operand. </p></li>
<li><p><strong>Y</strong> -- [in] The second threevector operand. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>threevector The resulting vector <span class="math notranslate nohighlight">\(Z = X \times Y\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410sigmatotaldidd">
<span class="target" id="nsphere_8c_1abdd2f3ea3887502b8d8a56774b24446e"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sigmatotal</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vrel</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_for_calc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_for_calc</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410sigmatotaldidd" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430perform_sidm_scattering_serialPPdiddP7gsl_rngPxdd">
<span class="target" id="nsphere_8c_1a1e14ae5c8708c7603758a77f4bbae095"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">perform_sidm_scattering_serial</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_time</span></span>, <span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rng</span></span>, <span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Nscatter_total_step</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_for_sidm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_for_sidm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430perform_sidm_scattering_serialPPdiddP7gsl_rngPxdd" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv432perform_sidm_scattering_parallelPPdiddPP7gsl_rngiPxdd">
<span class="target" id="nsphere_8c_1aa974a99f6d021c941ffe399445f53428"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">perform_sidm_scattering_parallel</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_time</span></span>, <span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rng_per_thread_list</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_threads_for_rng</span></span>, <span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Nscatter_total_step</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_for_sidm</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_for_sidm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv432perform_sidm_scattering_parallelPPdiddPP7gsl_rngiPxdd" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421get_suffixed_filenamePKciPc6size_t">
<span class="target" id="nsphere_8c_1a4757da672d57dda1b6f4114423850503"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_suffixed_filename</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">base_filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">with_suffix</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bufsize</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421get_suffixed_filenamePKciPc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Applies the global suffix to a filename. </p>
<p>For .dat files, inserts suffix before the extension. For other files, appends suffix to the end of filename.</p>
<section id="nsphere_8c_1autotoc_md0_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md0_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md0">
<span id="nsphere_8c_1autotoc_md0_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md0" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md0">base_filename : const char* Original filename. with_suffix : int Flag indicating whether to apply the suffix (1=yes, 0=no). buffer : char* Output buffer for the resulting filename. bufsize : size_t Size of the output buffer.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md1_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md1_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md1">
<span id="nsphere_8c_1autotoc_md1_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md1" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md1">None </p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411log_messagePKcPKcz">
<span class="target" id="nsphere_8c_1a569e4ea9a45d9d1ed9d3c34d40b0da44"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">log_message</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411log_messagePKcPKcz" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416format_file_sizelPc6size_t">
<span class="target" id="nsphere_8c_1a83a2e63c11c141847a52cf72209bdf96"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">format_file_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size_in_bytes</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">buffer_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416format_file_sizelPc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Formats a byte count into a human-readable string with appropriate units. </p>
<section id="nsphere_8c_1autotoc_md4_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md4_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md4">
<span id="nsphere_8c_1autotoc_md4_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md4" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md4">size_in_bytes : long The size in bytes to format. buffer : char* Output buffer for the formatted string. buffer_size : size_t Size of the output buffer.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md5_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md5_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md5">
<span id="nsphere_8c_1autotoc_md5_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md5" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md5">None </p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411fprintf_binP4FILEPKcz">
<span class="target" id="nsphere_8c_1a43386b4e33cce0ad200f33114481d9e5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fprintf_bin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411fprintf_binP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Binary file I/O function declarations. </p>
<p>Writes binary data to a file using a printf-like format string.</p>
<p>These functions provide platform-independent binary file I/O operations similar to fprintf and fscanf, but ensure consistent binary format regardless of host architecture.</p>
<p>Parses a format string containing simplified specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Writes corresponding arguments from the variadic list (<code class="docutils literal notranslate"><span class="pre">...</span></code>) as binary data. Integer types (<code class="docutils literal notranslate"><span class="pre">d</span></code>) are written as <code class="docutils literal notranslate"><span class="pre">int</span></code>. Floating-point types (<code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">double</span></code> from args but written as <code class="docutils literal notranslate"><span class="pre">float</span></code> to the file for storage efficiency.</p>
<section id="nsphere_8c_1autotoc_md46_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md46_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md46">
<span id="nsphere_8c_1autotoc_md46_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md46" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md46">fp : FILE* File pointer to write to (must be opened in binary mode). format : const char* Format string with specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Other characters are ignored. ... : Variable arguments matching the format specifiers.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md47_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md47_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md47">
<span id="nsphere_8c_1autotoc_md47_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md47" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md47">int The number of items successfully written according to the format string.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"><span class="std std-ref">fscanf_bin</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skips optional width/precision specifiers in the format string. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410fscanf_binP4FILEPKcz">
<span class="target" id="nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fscanf_bin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410fscanf_binP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Reads binary data from a file using a scanf-like format string. </p>
<p>Parses a format string containing simplified specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Reads corresponding binary data from the file and stores it in the pointer arguments provided in the variadic list (<code class="docutils literal notranslate"><span class="pre">...</span></code>). Integer types (<code class="docutils literal notranslate"><span class="pre">d</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">int</span></code>. Floating-point types (<code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">float</span></code> from the file but stored into <code class="docutils literal notranslate"><span class="pre">double*</span></code> arguments provided by the caller.</p>
<section id="nsphere_8c_1autotoc_md48_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md48_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md48">
<span id="nsphere_8c_1autotoc_md48_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md48" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md48">fp : FILE* File pointer to read from (must be opened in binary mode). format : const char* Format string with specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Other characters are ignored. ... : Variable pointer arguments matching the format specifiers (e.g., <code class="docutils literal notranslate"><span class="pre">int*</span></code>, <code class="docutils literal notranslate"><span class="pre">double*</span></code>).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md49_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md49_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md49">
<span id="nsphere_8c_1autotoc_md49_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md49" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md49">int The number of items successfully read and assigned according to the format string. Stops reading on the first failure or EOF.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a43386b4e33cce0ad200f33114481d9e5"><span class="std std-ref">fprintf_bin</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skips optional width/precision specifiers in the format string. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425cleanup_all_particle_datav">
<span class="target" id="nsphere_8c_1a7aee25e5421122109daf373663e3735e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cleanup_all_particle_data</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425cleanup_all_particle_datav" title="Link to this definition"></a><br /></dt>
<dd><p>Frees all global arrays used for particle data processing. </p>
<p>Frees L_block, Rank_block, R_block, Vrad_block, and chosen. Does NOT free lowestL_* arrays as they are handled elsewhere. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422free_local_snap_arraysv">
<span class="target" id="nsphere_8c_1a4237306378c83f198a54fc2feac8e5eb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_local_snap_arrays</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422free_local_snap_arraysv" title="Link to this definition"></a><br /></dt>
<dd><p>Frees local arrays used for snapshot processing. </p>
<p>Frees Rank_partdata_snap, R_partdata_snap, Vrad_partdata_snap, L_partdata_snap. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419gravitational_forcediidd">
<span class="target" id="nsphere_8c_1a90e8d2ddbd4ea35b65f3232fdb0056f2"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravitational_force</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_rank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">G_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419gravitational_forcediidd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates gravitational acceleration at a given radius. </p>
<section id="nsphere_8c_1autotoc_md6_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md6_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md6">
<span id="nsphere_8c_1autotoc_md6_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md6" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md6">r : double Radius in kpc. current_rank : int Particle rank (0 to npts-1), used for M(r) approximation. npts : int Total number of particles. G_value : double Gravitational constant value (e.g., G_CONST). halo_mass_value : double Total halo mass (e.g., HALO_MASS).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md7_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md7_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md7">
<span id="nsphere_8c_1autotoc_md7_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md7" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md7">double Gravitational acceleration (force per unit mass) in simulation units (kpc/Myr^2).</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code> is set to 1. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>M(r) is approximated as <code class="docutils literal notranslate"><span class="pre">(current_rank</span> <span class="pre">/</span> <span class="pre">npts)</span> <span class="pre">*</span> <span class="pre">halo_mass_value</span></code>. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423effective_angular_forcedd">
<span class="target" id="nsphere_8c_1a53ca1607d27fe1cffaabec48d29910e9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">effective_angular_force</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423effective_angular_forcedd" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the effective centrifugal acceleration due to angular momentum. </p>
<section id="nsphere_8c_1autotoc_md8_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md8_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md8">
<span id="nsphere_8c_1autotoc_md8_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md8" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md8">r : double Radius (kpc). ell : double Angular momentum per unit mass (kpc^2/Myr).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md9_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md9_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md9">
<span id="nsphere_8c_1autotoc_md9_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md9" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md9">double Centrifugal acceleration: L²/r³ (kpc/Myr^2). </p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425gravitational_force_rho_vdiidd">
<span class="target" id="nsphere_8c_1a302b3d50ea55f625e4f840e8515a5c79"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravitational_force_rho_v</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_rank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">G_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425gravitational_force_rho_vdiidd" title="Link to this definition"></a><br /></dt>
<dd><p>Alternative gravitational force calculation using transformed coordinates. </p>
<p>Used in the Levi-Civita regularization scheme. Calculates F/m in rho coordinates.</p>
<section id="nsphere_8c_1autotoc_md10_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md10_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md10">
<span id="nsphere_8c_1autotoc_md10_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md10" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md10">rho : double Transformed radial coordinate (sqrt(r)). Units: sqrt(kpc). current_rank : int Particle rank (0 to npts-1). npts : int Total number of particles. G_value : double Gravitational constant value (e.g., G_CONST). halo_mass_value : double Total halo mass (e.g., HALO_MASS).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md11_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md11_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md11">
<span id="nsphere_8c_1autotoc_md11_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md11" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md11">double Gravitational acceleration in transformed coordinates (units related to kpc^(3/2)/Myr^2).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a90e8d2ddbd4ea35b65f3232fdb0056f2"><span class="std std-ref">gravitational_force</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"><span class="std std-ref">doLeviCivitaLeapfrog</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code> is set to 1. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429effective_angular_force_rho_vdd">
<span class="target" id="nsphere_8c_1a9f030528565015911482c8584285839f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">effective_angular_force_rho_v</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429effective_angular_force_rho_vdd" title="Link to this definition"></a><br /></dt>
<dd><p>Computes effective centrifugal acceleration in transformed coordinates. </p>
<p>Used in the Levi-Civita regularization scheme. Calculates L^2/r^3 in rho coordinates.</p>
<section id="nsphere_8c_1autotoc_md12_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md12_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md12">
<span id="nsphere_8c_1autotoc_md12_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md12" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md12">rho : double Transformed radial coordinate (sqrt(r)). Units: sqrt(kpc). ell : double Angular momentum per unit mass (kpc^2/Myr).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md13_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md13_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md13">
<span id="nsphere_8c_1autotoc_md13_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md13" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md13">double Centrifugal acceleration in transformed coordinates (units related to kpc^(3/2)/Myr^2).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a53ca1607d27fe1cffaabec48d29910e9"><span class="std std-ref">effective_angular_force</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"><span class="std std-ref">doLeviCivitaLeapfrog</span></a></p>
</div>
</p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419store_debug_approxEidd">
<span class="target" id="nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">store_debug_approxE</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapIndex</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time_val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419store_debug_approxEidd" title="Link to this definition"></a><br /></dt>
<dd><p>Records the theoretical model energy for a debug snapshot. </p>
<section id="nsphere_8c_1autotoc_md14_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md14_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md14">
<span id="nsphere_8c_1autotoc_md14_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md14" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md14">snapIndex : int Index of the snapshot (0 to DEBUG_MAX_STEPS - 1). E_value : double Theoretical energy value (per unit mass). time_val : double Simulation time (Myr).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md15_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md15_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md15">
<span id="nsphere_8c_1autotoc_md15_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md15" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md15">None</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"><span class="std std-ref">store_debug_dynE_components</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1219b4779e99559d4045950efce1739a"><span class="std std-ref">finalize_debug_energy_output</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updates <code class="docutils literal notranslate"><span class="pre">dbg_count</span></code> if <code class="docutils literal notranslate"><span class="pre">snapIndex</span></code> extends the recorded range. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427store_debug_dynE_componentsiddddd">
<span class="target" id="nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">store_debug_dynE_components</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapIndex</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">totalE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">kinE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">potE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time_val</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427store_debug_dynE_componentsiddddd" title="Link to this definition"></a><br /></dt>
<dd><p>Records the actual dynamical energy and its components for a debug snapshot. </p>
<section id="nsphere_8c_1autotoc_md16_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md16_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md16">
<span id="nsphere_8c_1autotoc_md16_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md16" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md16">snapIndex : int Index of the snapshot (0 to DEBUG_MAX_STEPS - 1). totalE : double Total energy (KE + PE) per unit mass. kinE : double Kinetic energy component (per unit mass). potE : double Potential energy component (per unit mass). time_val : double Simulation time (Myr). radius_val : double Particle radius (kpc).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md17_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md17_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md17">
<span id="nsphere_8c_1autotoc_md17_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md17" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md17">None</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"><span class="std std-ref">store_debug_approxE</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a1219b4779e99559d4045950efce1739a"><span class="std std-ref">finalize_debug_energy_output</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Updates <code class="docutils literal notranslate"><span class="pre">dbg_count</span></code> if <code class="docutils literal notranslate"><span class="pre">snapIndex</span></code> extends the recorded range. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428finalize_debug_energy_outputv">
<span class="target" id="nsphere_8c_1a1219b4779e99559d4045950efce1739a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize_debug_energy_output</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428finalize_debug_energy_outputv" title="Link to this definition"></a><br /></dt>
<dd><p>Writes the collected debug energy comparison data to a file. </p>
<p>This function is called at the end of the simulation if debug mode (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>) is enabled. It iterates through the stored debug snapshots collected during the simulation and post-processing, writing the following data for the tracked particle (DEBUG_PARTICLE_ID) to <code class="docutils literal notranslate"><span class="pre">data/debug_energy_compare.dat</span></code> (with the appropriate file suffix applied):<ul class="simple">
<li><p>Snapshot index</p></li>
<li><p>Simulation time (Myr)</p></li>
<li><p>Particle radius (kpc)</p></li>
<li><p>Approximate (theoretical) energy (per unit mass)</p></li>
<li><p>Dynamic (calculated) energy (per unit mass)</p></li>
<li><p>Difference between dynamic and approximate energy</p></li>
<li><p>Kinetic energy component (per unit mass)</p></li>
<li><p>Potential energy component (per unit mass)</p></li>
</ul>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"><span class="std std-ref">store_debug_approxE</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"><span class="std std-ref">store_debug_dynE_components</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file writing operation is skipped if the simulation is in restart mode and file writes are disabled (<code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code> is true).</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410double_cmpPKvPKv">
<span class="target" id="nsphere_8c_1aaedb17f00b23fc8b1250f6f76611eb83"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">double_cmp</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410double_cmpPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting double values in ascending order. </p>
<p>This function is designed to be used with <code class="docutils literal notranslate"><span class="pre">qsort</span></code> or other standard library sorting functions that require a comparator. It takes two void pointers, casts them to <code class="docutils literal notranslate"><span class="pre">const</span> <span class="pre">double*</span></code>, dereferences them, and compares their values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- [in] Pointer to the first double value. </p></li>
<li><p><strong>b</strong> -- [in] Pointer to the second double value. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if the first double is less than the second, 1 if the first double is greater than the second, 0 if they are equal. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417compare_particlesPKvPKv">
<span class="target" id="nsphere_8c_1af2ff6db0e6e59733fd0fbc5470849b68"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_particles</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417compare_particlesPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for qsort to order particles based on radius. </p>
<p>Compares two particle entries for sorting based on the first column value.</p>
<section id="nsphere_8c_1autotoc_md18_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md18_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md18">
<span id="nsphere_8c_1autotoc_md18_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md18" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md18">a : const void* Pointer to the first particle data array (double**). b : const void* Pointer to the second particle data array (double**).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md19_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md19_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md19">
<span id="nsphere_8c_1autotoc_md19_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md19" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md19">int Integer less than, equal to, or greater than zero if the radius (first element) of particle <code class="docutils literal notranslate"><span class="pre">a</span></code> is found, respectively, to be less than, to match, or be greater than the radius of particle <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>
Used as a comparison function for qsort, quadsort, and other sorting algorithms. Particles with smaller values in column 0 will be sorted before those with larger values.</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compares based on the first element (index 0) of the column data, which represents the radius.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assumes the particle data is structured as [particle_index][component_index] when passed via <code class="docutils literal notranslate"><span class="pre">columns</span></code> array in sorting functions, and compares <code class="docutils literal notranslate"><span class="pre">columns[i][0]</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- Pointer to the first particle entry (as void pointer, expected double**). </p></li>
<li><p><strong>b</strong> -- Pointer to the second particle entry (as void pointer, expected double**). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>-1 if a&lt;b, 1 if a&gt;b, 0 if equal based on the first column value (radius).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414sort_particlesPPdi">
<span class="target" id="nsphere_8c_1ac80dacfe069ec441f196ff860e1e1455"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_particles</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414sort_particlesPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data using the default sorting algorithm (g_defaultSortAlg). </p>
<p>Convenience wrapper function for sorting particles with the default algorithm.</p>
<section id="nsphere_8c_1autotoc_md20_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md20_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md20">
<span id="nsphere_8c_1autotoc_md20_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md20" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md20">particles : double** Particle data array to sort (array of pointers to component arrays). Assumed structure: particles[component][particle_index]. npts : int Number of particles.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md21_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md21_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md21">
<span id="nsphere_8c_1autotoc_md21_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md21" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md21">None (sorts the array in-place).</p>
<p>
Calls sort_particles_with_alg using the default sorting algorithm specified in g_defaultSortAlg.<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a5a75c173db8a8ac46fd63b324b865771"><span class="std std-ref">sort_particles_with_alg</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a6941efb3580a570bda2e5720545c0293"><span class="std std-ref">g_defaultSortAlg</span></a></p>
</div>
</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md58_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md58_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md58">
<span id="nsphere_8c_1autotoc_md58_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md58" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md58">particles : double** 2D array of particle data to be sorted [component][particle] npts : int Number of particles to sort </p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423sort_particles_with_algPPdiPKc">
<span class="target" id="nsphere_8c_1a5a75c173db8a8ac46fd63b324b865771"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_particles_with_alg</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sortAlg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423sort_particles_with_algPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data using the specified sorting algorithm. </p>
<p>Main function for sorting particle data using a specified algorithm.</p>
<section id="nsphere_8c_1autotoc_md22_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md22_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md22">
<span id="nsphere_8c_1autotoc_md22_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md22" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md22">particles : double** Particle data array to sort (array of pointers to component arrays). Assumed structure: particles[component][particle_index]. npts : int Number of particles. sortAlg : const char* Algorithm identifier string: &quot;quadsort&quot;, &quot;quadsort_parallel&quot;, &quot;insertion&quot;, &quot;insertion_parallel&quot;.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md23_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md23_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md23">
<span id="nsphere_8c_1autotoc_md23_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md23" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md23">None (sorts the array in-place).</p>
<p>
Transposes the data format from particles[component][particle] to columns[particle][component], applies the specified sorting algorithm, and then transposes back to the original format.<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ac80dacfe069ec441f196ff860e1e1455"><span class="std std-ref">sort_particles</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1af2ff6db0e6e59733fd0fbc5470849b68"><span class="std std-ref">compare_particles</span></a></p>
</div>
</p>
<p>
Sorts particle data using the specified sorting algorithm.</p>
<p>Performs a three-phase particle sorting operation:<ol class="loweralpha simple">
<li><p>Memory allocation and data transposition to column-major format</p></li>
<li><p>Application of the selected sorting algorithm</p></li>
<li><p>Reverse transposition of sorted data and memory cleanup</p></li>
</ol>
</p>
<p>The function uses per-call local buffer allocation for transposing data.</p>
<p></p>
</section>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- 2D array of particle data to be sorted [component][particle] </p></li>
<li><p><strong>npts</strong> -- Number of particles to sort </p></li>
<li><p><strong>sortAlg</strong> -- String identifier of the sorting algorithm to use (&quot;quadsort&quot;, &quot;quadsort_parallel&quot;, or default to &quot;insertion_parallel&quot;)</p></li>
<li><p><strong>particles</strong> -- 2D array of particle data to be sorted [component][particle] </p></li>
<li><p><strong>npts</strong> -- Number of particles to sort </p></li>
<li><p><strong>sortAlg</strong> -- Sorting algorithm to use (&quot;quadsort&quot;, &quot;quadsort_parallel&quot;, &quot;insertion&quot;, or &quot;insertion_parallel&quot;) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418sort_rr_psi_arraysPdPdi">
<span class="target" id="nsphere_8c_1ae161185b8c5832ffaf4c6a6c3b87bbbb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_rr_psi_arrays</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rrA_spline</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">psiAarr_spline</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418sort_rr_psi_arraysPdPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts radius and psi arrays in tandem based on radius values. </p>
<p>Sorts radius and potential arrays in tandem, maintaining their correspondence.</p>
<p>Ensures that the correspondence between radius and potential values is maintained after sorting, which is necessary for spline creation.</p>
<section id="nsphere_8c_1autotoc_md24_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md24_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md24">
<span id="nsphere_8c_1autotoc_md24_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md24" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md24">rrA_spline : double* Array of radial coordinates to be sorted. psiAarr_spline : double* Array of corresponding Psi values. npts : int Number of points (arrays are typically of size npts or npts+1).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md25_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md25_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md25">
<span id="nsphere_8c_1autotoc_md25_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md25" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md25">None (sorts the arrays in-place).</p>
<p>This function takes an array of radial coordinates (<code class="docutils literal notranslate"><span class="pre">rrA_spline</span></code>) and an array of corresponding potential values (<code class="docutils literal notranslate"><span class="pre">psiAarr_spline</span></code>). It sorts <code class="docutils literal notranslate"><span class="pre">rrA_spline</span></code> in ascending order and applies the identical swaps to <code class="docutils literal notranslate"><span class="pre">psiAarr_spline</span></code>, ensuring that <code class="docutils literal notranslate"><span class="pre">psiAarr_spline[i]</span></code> still corresponds to <code class="docutils literal notranslate"><span class="pre">rrA_spline[i]</span></code> after sorting. This is crucial for creating GSL splines where the x-array must be strictly monotonic and the y-array must maintain its pairing with the x-values. The arrays are assumed to have <code class="docutils literal notranslate"><span class="pre">npts</span> <span class="pre">+</span> <span class="pre">1</span></code> elements, indexed from 0 to <code class="docutils literal notranslate"><span class="pre">npts</span></code>.</p>
<p></p>
</section>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rrA_spline</strong> -- [in,out] Array of radial coordinates to be sorted. Modified in-place. </p></li>
<li><p><strong>psiAarr_spline</strong> -- [in,out] Array of corresponding Psi values. Modified in-place in tandem with <code class="docutils literal notranslate"><span class="pre">rrA_spline</span></code>. </p></li>
<li><p><strong>npts</strong> -- The number of points, typically meaning arrays are of size <code class="docutils literal notranslate"><span class="pre">npts</span> <span class="pre">+</span> <span class="pre">1</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413massintegranddPv">
<span class="target" id="nsphere_8c_1a486e09e9ff56866413bdfb973b8172ce"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413massintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for calculating enclosed mass: <code class="docutils literal notranslate"><span class="pre">r^2</span> <span class="pre">*</span> <span class="pre">rho(r)</span></code>. </p>
<p>Used in GSL integration routines to compute M(r).</p>
<section id="nsphere_8c_1autotoc_md26_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md26_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md26">
<span id="nsphere_8c_1autotoc_md26_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md26" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md26">r : double Radial coordinate (kpc). params : void* Integration parameters (unused here, but required by GSL).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md27_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md27_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md27">
<span id="nsphere_8c_1autotoc_md27_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md27" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md27">double Value of the mass integrand <code class="docutils literal notranslate"><span class="pre">r^2</span> <span class="pre">*</span> <span class="pre">rho(r)</span></code> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assumes a density profile <code class="docutils literal notranslate"><span class="pre">rho(r)</span></code> proportional to <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">(r/RC)^2)^3</span></code>. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv431massintegrand_profile_nfwcutoffdPv">
<span class="target" id="nsphere_8c_1a8e33f50ec202f76ee9185c55123dd196"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand_profile_nfwcutoff</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv431massintegrand_profile_nfwcutoffdPv" title="Link to this definition"></a><br /></dt>
<dd><p>GSL integrand <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> for NFW-like profile mass calculation. </p>
<p>Computes <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span> where <span class="math notranslate nohighlight">\(\rho(r)\)</span> is an NFW-like density profile with an inner softening term and an outer power-law cutoff. The density <span class="math notranslate nohighlight">\(\rho(r) = p[2] \times [ (r_s + \epsilon)(1+r_s)^2 (1 + (r_s/C)^N) ]^{-1}\)</span>, where <span class="math notranslate nohighlight">\(r_s = r/p[0]\)</span>, <span class="math notranslate nohighlight">\(\epsilon=0.01\)</span>, <span class="math notranslate nohighlight">\(C=p[3]\)</span>, <span class="math notranslate nohighlight">\(N=10.0\)</span>. This integrand is used in GSL routines to calculate the normalization factor or enclosed mass for the NFW-like profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate <span class="math notranslate nohighlight">\(r\)</span> (kpc). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to a <code class="docutils literal notranslate"><span class="pre">double</span></code> array <code class="docutils literal notranslate"><span class="pre">p</span></code> of size 4:<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">p[0]</span></code> (rc_param): Scale radius (kpc).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[1]</span></code> (halo_mass): Target total halo mass (Msun) - used to derive nt_nfw_scaler.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[2]</span></code> (nt_nfw_scaler): Density normalization constant <span class="math notranslate nohighlight">\(nt_{NFW}\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p[3]</span></code> (falloff_C_param): Falloff transition factor <span class="math notranslate nohighlight">\(C\)</span>. </p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of the mass integrand <span class="math notranslate nohighlight">\(r^2 \rho(r)\)</span>. Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">rc_param</span></code> (p[0]) is non-positive. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424drhodr_profile_nfwcutoffdddd">
<span class="target" id="nsphere_8c_1a7d9dd173f38d371829f3acbc8ae9beb8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr_profile_nfwcutoff</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rc_param</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nt_nfw_scaler</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">falloff_C_param</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424drhodr_profile_nfwcutoffdddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho/dr\)</span> for the NFW-like profile with a power-law cutoff. </p>
<p>The NFW-like density profile used is: <span class="math notranslate nohighlight">\(\rho(r) = \text{nt_nfw_scaler} \times [ (r_s + \epsilon)(1+r_s)^2 (1 + (r_s/C)^N) ]^{-1}\)</span> where <span class="math notranslate nohighlight">\(r_s = r / \text{rc_param}\)</span>, <span class="math notranslate nohighlight">\(\epsilon\)</span> is a softening parameter (0.01), <span class="math notranslate nohighlight">\(C\)</span> is the <code class="docutils literal notranslate"><span class="pre">falloff_C_param</span></code>, and <span class="math notranslate nohighlight">\(N\)</span> is a power-law index (10.0). This function computes the analytical derivative of this <span class="math notranslate nohighlight">\(\rho(r)\)</span> with respect to <span class="math notranslate nohighlight">\(r\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate (kpc) at which to evaluate the derivative. </p></li>
<li><p><strong>rc_param</strong> -- [in] Scale radius (RC) of the NFW-like profile (kpc). </p></li>
<li><p><strong>nt_nfw_scaler</strong> -- [in] Density normalization constant (nt_nfw) for the profile. </p></li>
<li><p><strong>falloff_C_param</strong> -- [in] Falloff transition factor <span class="math notranslate nohighlight">\(C\)</span> for the power-law cutoff. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">rc_param</span></code> is non-positive. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415fEintegrand_nfwdPv">
<span class="target" id="nsphere_8c_1a2607bf70ccc0b0f0b1ebb7dbd4c44607"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand_nfw</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_integration_var</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415fEintegrand_nfwdPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for calculating the I(E) component of the NFW distribution function. </p>
<p>This function is integrated with respect to t_integration_var = sqrt(E_shell - Psi_true_at_r). It computes -2 * (d(rho)/d(Psi_true)) to ensure a positive integrand, leading to a monotonically increasing I(E). Psi_true_at_r is the potential corresponding to the radius r reached when energy E_shell has been reduced by t_integration_var^2. The radius r is determined from Psi_true_at_r using a spline. Derivatives d(rho)/dr and d(Psi_true)/dr are then calculated at this r.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t_integration_var</strong> -- [in] The integration variable, t_prime = sqrt(E_shell - Psi_true_at_r). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to a <code class="docutils literal notranslate"><a class="reference internal" href="#structf_e__integrand__params___n_f_w__t"><span class="std std-ref"><span class="pre">fE_integrand_params_NFW_t</span></span></a></code> structure. This struct contains the current energy shell E_shell, splines for r(Psi) and M(r), physical constants (G), NFW profile-specific parameters (scale radius, density normalization, falloff factor C), and global Psimin/Psimax for physical range validation. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of the integrand -2 * (d(rho)/d(Psi_true)). Returns 0.0 if Psi_true_at_r is outside the physical range, if the derived radius is non-physical, if dPsi/dr is too small (or zero), or if the result is non-finite. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46drhodrd">
<span class="target" id="nsphere_8c_1a8e43116b27062f239c75f9e228f3420b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46drhodrd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the derivative of the density profile with respect to radius. </p>
<p>Calculates <span class="math notranslate nohighlight">\(d\rho/dr\)</span> for the Cored Plummer-like density profile.</p>
<section id="nsphere_8c_1autotoc_md28_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md28_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md28">
<span id="nsphere_8c_1autotoc_md28_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md28" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md28">r : double Radial coordinate (kpc).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md29_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md29_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md29">
<span id="nsphere_8c_1autotoc_md29_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md29" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md29">double Density gradient d(rho)/dr at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<p>
The density profile is <span class="math notranslate nohighlight">\(\rho(r) \propto (1 + (r/RC)^2)^{-3}\)</span>. This function computes its analytical derivative with respect to <span class="math notranslate nohighlight">\(r\)</span>. It directly uses the <code class="docutils literal notranslate"><span class="pre">RC</span></code> macro for the scale radius.</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assumes a density profile <code class="docutils literal notranslate"><span class="pre">rho(r)</span></code> proportional to <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">(r/RC)^2)^3</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>r</strong> -- [in] Radial coordinate (kpc) at which to evaluate the derivative. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/dr\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412PsiintegranddPv">
<span class="target" id="nsphere_8c_1af5fd16c6b624d8d23a609134ed75bb0a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psiintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rp</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412PsiintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for calculating gravitational potential: <code class="docutils literal notranslate"><span class="pre">massintegrand(r)</span> <span class="pre">/</span> <span class="pre">r</span></code>. </p>
<p>GSL integrand for calculating the gravitational potential <span class="math notranslate nohighlight">\(\Psi(r)\)</span>.</p>
<p>Used in GSL integration routines to compute Psi(r) via integral from r to infinity.</p>
<section id="nsphere_8c_1autotoc_md30_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md30_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md30">
<span id="nsphere_8c_1autotoc_md30_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md30" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md30">rp : double Radial coordinate (kpc). params : void* Integration parameters (contains alpha, currently unused but required by GSL).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md31_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md31_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md31">
<span id="nsphere_8c_1autotoc_md31_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md31" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md31">double Value of the potential integrand <code class="docutils literal notranslate"><span class="pre">M(r)</span> <span class="pre">/</span> <span class="pre">r</span></code> (related to <code class="docutils literal notranslate"><span class="pre">r</span> <span class="pre">*</span> <span class="pre">rho(r)</span></code>).</p>
<p>
This function computes the integrand <span class="math notranslate nohighlight">\(M_{enc}(r')/r'\)</span> or <span class="math notranslate nohighlight">\(r' \rho_{shape}(r')\)</span> (depending on the exact formulation of <span class="math notranslate nohighlight">\(\Psi\)</span>) needed for the integral part of the potential calculation: <span class="math notranslate nohighlight">\(\Psi(r) = G M(&lt;r)/r + G \int_r^{\infty} \text{integrand_val } dr'\)</span>. It uses a function pointer (<code class="docutils literal notranslate"><span class="pre">p_psi-&gt;massintegrand_func</span></code>) passed via the <code class="docutils literal notranslate"><span class="pre">params</span></code> argument (a <code class="docutils literal notranslate"><a class="reference internal" href="#struct_psiintegrand__params"><span class="std std-ref"><span class="pre">Psiintegrand_params</span></span></a></code> struct) to call the profile-specific mass integrand (which itself returns <span class="math notranslate nohighlight">\(r'^2 \rho_{shape}(r')\)</span> or similar). The function then typically divides by <code class="docutils literal notranslate"><span class="pre">rp</span></code> to get <span class="math notranslate nohighlight">\(r' \rho_{shape}(r')\)</span> if <code class="docutils literal notranslate"><span class="pre">massintegrand_func</span></code> returned <span class="math notranslate nohighlight">\(r'^2 \rho_{shape}(r')\)</span>. It includes a safety check to exit if <code class="docutils literal notranslate"><span class="pre">rp</span></code> (radius prime) is non-positive.<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a486e09e9ff56866413bdfb973b8172ce"><span class="std std-ref">massintegrand</span></a></p>
</div>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#struct_psiintegrand__params"><span class="std std-ref">Psiintegrand_params</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a486e09e9ff56866413bdfb973b8172ce"><span class="std std-ref">massintegrand</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a8e33f50ec202f76ee9185c55123dd196"><span class="std std-ref">massintegrand_profile_nfwcutoff</span></a></p>
</div>
</p>
</section>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rp</strong> -- [in] The radial integration variable <span class="math notranslate nohighlight">\(r'\)</span> (kpc). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to a <code class="docutils literal notranslate"><a class="reference internal" href="#struct_psiintegrand__params"><span class="std std-ref"><span class="pre">Psiintegrand_params</span></span></a></code> struct. This struct contains a function pointer to the profile-specific mass integrand and its parameters. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of the potential integrand at <code class="docutils literal notranslate"><span class="pre">rp</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld">
<span class="target" id="nsphere_8c_1ad07d4bc0d7acda78ba6f3b8864d936f8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">evaluatespline</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">spline</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">acc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld" title="Link to this definition"></a><br /></dt>
<dd><p>Evaluates a GSL spline at a given value with bounds checking. </p>
<p>Safely evaluates a GSL spline at a given value with robust bounds checking.</p>
<p>Safely evaluates the spline, clamping the input value to the spline's defined range if necessary to prevent GSL errors.</p>
<section id="nsphere_8c_1autotoc_md32_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md32_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md32">
<span id="nsphere_8c_1autotoc_md32_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md32" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md32">spline : gsl_spline* Pointer to the initialized GSL spline object. acc : gsl_interp_accel* Pointer to the GSL interpolation accelerator. value : double The value at which to evaluate the spline.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md33_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md33_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md33">
<span id="nsphere_8c_1autotoc_md33_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md33" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md33">double The interpolated value from the spline. Returns the boundary value if <code class="docutils literal notranslate"><span class="pre">value</span></code> is outside the spline's range. Returns 0.0 if spline or acc is NULL.</p>
<p>This function evaluates the provided GSL spline at the specified <code class="docutils literal notranslate"><span class="pre">value</span></code>. It includes critical safety checks:<ol class="loweralpha simple">
<li><p>It verifies that the <code class="docutils literal notranslate"><span class="pre">spline</span></code> and accelerator <code class="docutils literal notranslate"><span class="pre">acc</span></code> pointers are not NULL.</p></li>
<li><p>It checks if the <code class="docutils literal notranslate"><span class="pre">value</span></code> is outside the defined range of the spline's x-values. If <code class="docutils literal notranslate"><span class="pre">value</span></code> is out of bounds, it clamps <code class="docutils literal notranslate"><span class="pre">value</span></code> to the nearest valid boundary (plus/minus a small MARGIN) before evaluation to prevent GSL domain errors. This robust approach ensures that spline evaluations do not cause crashes due to out-of-range inputs, which can occur due to floating-point inaccuracies or unexpected data.</p></li>
</ol>
</p>
<p></p>
</section>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spline</strong> -- [in] Pointer to the initialized GSL spline object. </p></li>
<li><p><strong>acc</strong> -- [in] Pointer to the GSL interpolation accelerator associated with the spline. </p></li>
<li><p><strong>value</strong> -- [in] The x-coordinate at which to evaluate the spline. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The interpolated y-value from the spline. Returns the boundary spline value if <code class="docutils literal notranslate"><span class="pre">value</span></code> was clamped. Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">spline</span></code> or <code class="docutils literal notranslate"><span class="pre">acc</span></code> is NULL (error logged). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411fEintegranddPv">
<span class="target" id="nsphere_8c_1aa5158e3d100422d6fe97a7914289bfe0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411fEintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for energy distribution function <code class="docutils literal notranslate"><span class="pre">f(E)</span></code> calculation using Eddington's formula. </p>
<p>Calculates the integrand for the distribution function calculation.</p>
<p>Computes <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">drho/dpsi</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">sqrt(E</span> <span class="pre">-</span> <span class="pre">Psi_min)</span></code>. Used in GSL integration to find the inner integral in Eddington's formula.</p>
<section id="nsphere_8c_1autotoc_md34_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md34_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md34">
<span id="nsphere_8c_1autotoc_md34_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md34" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md34">t : double Integration variable related to energy <code class="docutils literal notranslate"><span class="pre">E</span></code> and potential <code class="docutils literal notranslate"><span class="pre">Psi</span></code>. params : void* Pointer to a <code class="docutils literal notranslate"><a class="reference internal" href="#structf_eintegrand__params"><span class="std std-ref"><span class="pre">fEintegrand_params</span></span></a></code> struct containing splines and energy <code class="docutils literal notranslate"><span class="pre">E</span></code>.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md35_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md35_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md35">
<span id="nsphere_8c_1autotoc_md35_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md35" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md35">double Value of the integrand <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">drho/dpsi</span></code> at the corresponding <code class="docutils literal notranslate"><span class="pre">Psi</span></code>.</p>
<p>
Uses splines to evaluate the potential and mass at a given energy and radius, and computes the distribution function integrand according to Eddington's formula.<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#structf_eintegrand__params"><span class="std std-ref">fEintegrand_params</span></a></p>
</div>
</p>
<p></p>
</section>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> -- Integration variable </p></li>
<li><p><strong>params</strong> -- Structure containing necessary splines and energy value </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Value of the distribution function integrand at the specified point </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47cmp_LAIPKvPKv">
<span class="target" id="nsphere_8c_1a131102931747b4519a71bdb613523776"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cmp_LAI</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47cmp_LAIPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structures by the <code class="docutils literal notranslate"><span class="pre">L</span></code> member (ascending). </p>
<p>Comparison function for sorting <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structures by the L member.</p>
<section id="nsphere_8c_1autotoc_md36_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md36_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md36">
<span id="nsphere_8c_1autotoc_md36_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md36" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md36">a : const void* Pointer to the first <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structure. b : const void* Pointer to the second <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structure.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md37_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md37_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md37">
<span id="nsphere_8c_1autotoc_md37_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md37" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md37">int -1 if a-&gt;L &lt; b-&gt;L, 1 if a-&gt;L &gt; b-&gt;L, 0 if a-&gt;L == b-&gt;L.</p>
<p>
Sorts <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structures in ascending order based on their 'L' (angular momentum or squared difference from a reference L) value. Used with qsort for ordering particles by their L values, typically for selecting particles with lowest L or L closest to a target.<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a></p>
</div>
</p>
<p></p>
</section>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- [in] Pointer to the first <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structure. </p></li>
<li><p><strong>b</strong> -- [in] Pointer to the second <a class="reference internal" href="#struct_l_and_index"><span class="std std-ref">LAndIndex</span></a> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if a-&gt;L &lt; b-&gt;L, 1 if a-&gt;L &gt; b-&gt;L, 0 if equal. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49isIntegerPKc">
<span class="target" id="nsphere_8c_1a42b67ba97407675434b2e4a94e733f62"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isInteger</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">str</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49isIntegerPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a given string represents a valid integer. </p>
<p>Allows an optional leading '+' or '-' sign. Validates that all subsequent characters in the string are digits. Returns 0 (false) for empty strings, strings containing only a sign, or strings with non-digit characters after the optional sign.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str</strong> -- [in] The null-terminated string to check. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 if the string is a valid integer, 0 otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47isFloatPKc">
<span class="target" id="nsphere_8c_1a5b75ba4813fc53f0e959c9f67795a3b9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isFloat</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">str</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47isFloatPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a given string represents a valid floating-point number. </p>
<p>Validates if the input string conforms to common floating-point number formats, including an optional leading sign ('+' or '-'), digits, at most one decimal point (if not in exponent part), and an optional exponent part (e.g., &quot;e+10&quot;, &quot;E-5&quot;). The function requires at least one digit to be present for a number to be considered valid (e.g., &quot;.&quot; or &quot;+.&quot; are not valid floats).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str</strong> -- [in] The null-terminated string to check. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 if the string is a valid float, 0 otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410printUsagePKc">
<span class="target" id="nsphere_8c_1a85fda61d19f17f9567ee500e54d7e78e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">printUsage</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prog</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410printUsagePKc" title="Link to this definition"></a><br /></dt>
<dd><p>Displays detailed usage information for command-line arguments. </p>
<p>Prints a comprehensive help message to stderr showing all available command-line options, their default values, and brief descriptions. Includes information about integration methods, sorting algorithms, data saving modes, and basic usage examples.</p>
<section id="nsphere_8c_1autotoc_md38_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md38_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md38">
<span id="nsphere_8c_1autotoc_md38_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md38" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md38">prog : const char* The program name to display in the usage message (typically argv[0]).</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md39_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md39_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md39">
<span id="nsphere_8c_1autotoc_md39_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md39" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md39">None (prints to stderr).</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Called when the user specifies <code class="docutils literal notranslate"><span class="pre">--help</span></code> or when errors occur during argument parsing. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412errorAndExitPKcPKcPKc">
<span class="target" id="nsphere_8c_1acc053c8a565be9074d3a4abefc609b3f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">errorAndExit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">msg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">arg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prog</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412errorAndExitPKcPKcPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Displays an error message, suggests <code class="docutils literal notranslate"><span class="pre">--help</span></code>, and terminates the program. </p>
<p>Formats and prints an error message to stderr, includes a suggestion to use the <code class="docutils literal notranslate"><span class="pre">--help</span></code> flag for usage information, performs necessary cleanup of allocated resources, and then exits with a non-zero status.</p>
<section id="nsphere_8c_1autotoc_md40_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md40_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md40">
<span id="nsphere_8c_1autotoc_md40_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md40" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md40">msg : const char* The error message to display. arg : const char* Optional argument value that caused the error (shown in quotes), or NULL to omit this part of the message. prog : const char* The program name to display in the <code class="docutils literal notranslate"><span class="pre">--help</span></code> usage suggestion.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md41_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md41_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md41">
<span id="nsphere_8c_1autotoc_md41_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md41" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md41">None (calls exit(1) and never returns).</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls <a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a> before exiting to free allocated memory. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function does not return; execution is terminated. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411sort_by_radP8PartDatai">
<span class="target" id="nsphere_8c_1aa18960860d11c051e4088aac179282a7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_by_rad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv48PartData" title="PartData"><span class="n"><span class="pre">PartData</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411sort_by_radP8PartDatai" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data in ascending order by radial position. </p>
<p>Sorts an array of <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures by their radial position (<code class="docutils literal notranslate"><span class="pre">rad</span></code>).</p>
<p>Performs a quick sort of the particle data structure array, using the radial position as the primary sorting key. Preserves the original indices to allow tracking particles across time steps.</p>
<p>
Uses the standard library <code class="docutils literal notranslate"><span class="pre">qsort</span></code> function with <code class="docutils literal notranslate"><span class="pre">compare_partdata_by_rad</span></code> as the comparison function. Includes basic safety checks for NULL array or non-positive <code class="docutils literal notranslate"><span class="pre">npts</span></code>. The sort is performed in-place.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> -- Array of particle data structures to be sorted </p></li>
<li><p><strong>npts</strong> -- Number of particles in the array</p></li>
<li><p><strong>array</strong> -- [in,out] Array of <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures to be sorted. </p></li>
<li><p><strong>npts</strong> -- [in] Number of elements in the array. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf">
<span class="target" id="nsphere_8c_1acf35e9a785fb4599bd9de42d4d36b58c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">append_all_particle_data_chunk_to_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">L_block</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Rank_block</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">R_block</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Vrad_block</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf" title="Link to this definition"></a><br /></dt>
<dd><p>Appends a block of full particle data to the specified output file. </p>
<p>This function writes a chunk of particle data, corresponding to <code class="docutils literal notranslate"><span class="pre">block_size</span></code> timesteps, to the given binary file. The data for each particle (rank, radius, radial velocity, angular momentum) is written sequentially for each timestep within the block (step-major order). This means all particle data for step <code class="docutils literal notranslate"><span class="pre">s</span></code> is contiguous, followed by all data for step <code class="docutils literal notranslate"><span class="pre">s+1</span></code>, etc., within the block. The file is opened in append binary mode (&quot;ab&quot;). This is used for creating the <code class="docutils literal notranslate"><span class="pre">all_particle_data.dat</span></code> file which stores the complete evolution history when <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is enabled.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref"><span class="pre">CLEAN_EXIT(1)</span></span></a></code> if the file cannot be opened for appending. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the output binary file (e.g., &quot;data/all_particle_data&lt;suffix&gt;.dat&quot;). </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles. </p></li>
<li><p><strong>block_size</strong> -- [in] Number of timesteps of data contained in the provided <code class="docutils literal notranslate"><span class="pre">_block</span></code> arrays. </p></li>
<li><p><strong>L_block</strong> -- [in] Pointer to the block of angular momentum data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
<li><p><strong>Rank_block</strong> -- [in] Pointer to the block of particle rank data (int array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
<li><p><strong>R_block</strong> -- [in] Pointer to the block of radial position data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
<li><p><strong>Vrad_block</strong> -- [in] Pointer to the block of radial velocity data (float array). Assumed to be <code class="docutils literal notranslate"><span class="pre">[step_in_block</span> <span class="pre">*</span> <span class="pre">npts</span> <span class="pre">+</span> <span class="pre">particle_orig_id]</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf">
<span class="target" id="nsphere_8c_1acce6775e508269e301b9fdc90f71babf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">retrieve_all_particle_snapshot</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snap</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">L_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Rank_out</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">R_out</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Vrad_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf" title="Link to this definition"></a><br /></dt>
<dd><p>Retrieves particle data for a specific snapshot from the <code class="docutils literal notranslate"><span class="pre">all_particle_data.dat</span></code> binary file. </p>
<p>This function reads the data (rank, radius, radial velocity, angular momentum) for all <code class="docutils literal notranslate"><span class="pre">npts</span></code> particles corresponding to a single snapshot number (<code class="docutils literal notranslate"><span class="pre">snap</span></code>) from the specified binary file. The file is expected to be in step-major order, where each record per particle consists of an int (rank) and three floats (R, Vrad, L). It calculates the correct file offset to seek to the desired snapshot. To ensure thread safety when called in parallel (e.g., during post-processing of snapshots), file I/O (seeking and reading) is performed within an OpenMP critical section named <code class="docutils literal notranslate"><span class="pre">file_access</span></code>. Temporary local buffers are used for reading, and data is then copied to the caller-provided output arrays.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits via <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"><span class="std std-ref"><span class="pre">CLEAN_EXIT(1)</span></span></a></code> on memory allocation failure, file open failure, fseek failure, or unexpected EOF. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> -- [in] Path to the binary data file (e.g., &quot;data/all_particle_data&lt;suffix&gt;.dat&quot;). </p></li>
<li><p><strong>snap</strong> -- [in] The snapshot number (0-indexed, corresponding to write events) to retrieve. </p></li>
<li><p><strong>npts</strong> -- [in] Number of particles per snapshot. </p></li>
<li><p><strong>block_size</strong> -- [in] The number of snapshots that were written per block to the file by <code class="docutils literal notranslate"><span class="pre">append_all_particle_data_chunk_to_file</span></code>. Used for calculating seek offset. </p></li>
<li><p><strong>L_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved angular momentum values. </p></li>
<li><p><strong>Rank_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved particle ranks. </p></li>
<li><p><strong>R_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved radial positions. </p></li>
<li><p><strong>Vrad_out</strong> -- [out] Pointer to an array (size <code class="docutils literal notranslate"><span class="pre">npts</span></code>) to store the retrieved radial velocities. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417adjust_ntimestepsiii">
<span class="target" id="nsphere_8c_1a42bd334c6038615033c8df68f17aed7b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">adjust_ntimesteps</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Ntimes_initial</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nout</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dtwrite</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417adjust_ntimestepsiii" title="Link to this definition"></a><br /></dt>
<dd><p>Adjusts the total number of timesteps to align with desired output snapshot intervals. </p>
<p>This function calculates an adjusted number of total simulation timesteps, <span class="math notranslate nohighlight">\(N'_{times}\)</span>, such that it is greater than or equal to the initially requested <code class="docutils literal notranslate"><span class="pre">Ntimes_initial</span></code> ( <span class="math notranslate nohighlight">\(N\)</span>) and satisfies the constraint: <span class="math notranslate nohighlight">\((N'_{times} - 1)\)</span> must be an integer multiple of <span class="math notranslate nohighlight">\((M - 1) \times p\)</span>. Here, <span class="math notranslate nohighlight">\(M\)</span> is <code class="docutils literal notranslate"><span class="pre">nout</span></code> (number of desired output snapshot points, which means <span class="math notranslate nohighlight">\(M-1\)</span> intervals) and <span class="math notranslate nohighlight">\(p\)</span> is <code class="docutils literal notranslate"><span class="pre">dtwrite</span></code> (the low-level write interval in terms of simulation timesteps). This alignment ensures that exactly <code class="docutils literal notranslate"><span class="pre">nout</span></code> snapshots can be produced at intervals that are multiples of <code class="docutils literal notranslate"><span class="pre">dtwrite</span></code> and that also evenly span the total adjusted simulation duration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ntimes_initial</strong> -- [in] Initially requested total number of simulation timesteps ( <span class="math notranslate nohighlight">\(N\)</span>). </p></li>
<li><p><strong>nout</strong> -- [in] Number of desired output snapshot points ( <span class="math notranslate nohighlight">\(M\)</span>). Must be &gt;= 2 for adjustment to apply. </p></li>
<li><p><strong>dtwrite</strong> -- [in] The interval (in timesteps) at which low-level data is potentially written ( <span class="math notranslate nohighlight">\(p\)</span>). Must be &gt;= 1. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int The adjusted total number of timesteps ( <span class="math notranslate nohighlight">\(N'_{times}\)</span>). Returns <code class="docutils literal notranslate"><span class="pre">Ntimes_initial</span></code> if <code class="docutils literal notranslate"><span class="pre">nout</span> <span class="pre">&lt;</span> <span class="pre">2</span></code> or <code class="docutils literal notranslate"><span class="pre">dtwrite</span> <span class="pre">&lt;</span> <span class="pre">1</span></code> or other edge cases where the constraint cannot be met. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415doMicroLeapfrogiiddddiidPdPd">
<span class="target" id="nsphere_8c_1a31ec81f5740bfad5a550b8c27f5777f1"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doMicroLeapfrog</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subSteps</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415doMicroLeapfrogiiddddiidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a leapfrog integration step using a fixed number of micro-steps. </p>
<p>This helper function implements the leapfrog (Kick-Drift-Kick) integration over a total time interval <code class="docutils literal notranslate"><span class="pre">h</span></code> by dividing it into a sequence of micro-steps. The number of micro-steps is <code class="docutils literal notranslate"><span class="pre">subSteps</span></code> (e.g., <span class="math notranslate nohighlight">\(2N+1\)</span> for a &quot;coarse&quot; pass or <span class="math notranslate nohighlight">\(4N+1\)</span> for a &quot;fine&quot; pass in an adaptive scheme, where <span class="math notranslate nohighlight">\(N\)</span> is <code class="docutils literal notranslate"><span class="pre">N_subdivision_factor</span></code>). The micro-timestep sizes for kicks and drifts are adjusted based on <code class="docutils literal notranslate"><span class="pre">N_subdivision_factor</span></code> and whether it's a coarse or fine integration sequence. Sequence: Initial half-kick, <span class="math notranslate nohighlight">\(((\text{subSteps}-1)/2 - 1)\)</span> full Drift-Kick pairs, a final full Drift, and a final half-Kick.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in gravitational force. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>r_in</strong> -- [in] Input radial position (kpc) at the start of the total interval <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Input radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr). </p></li>
<li><p><strong>h</strong> -- [in] Total physical time interval for this leapfrog sequence (Myr). </p></li>
<li><p><strong>N_subdivision_factor</strong> -- [in] Base subdivision factor <span class="math notranslate nohighlight">\(N\)</span> used to determine micro-timestep sizes. </p></li>
<li><p><strong>subSteps</strong> -- [in] Total number of Kicks/Drifts (e.g., <span class="math notranslate nohighlight">\(2N+1\)</span> or <span class="math notranslate nohighlight">\(4N+1\)</span>). </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the output radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the output radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418doAdaptiveFullLeapiiddddddidiPdPd">
<span class="target" id="nsphere_8c_1aaeff56e8db1ae13e4536e2be4e53830e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doAdaptiveFullLeap</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418doAdaptiveFullLeapiiddddddidiPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs an adaptive full leapfrog step with error control over a physical timestep <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p>
<p>This function implements an adaptive leapfrog algorithm to advance a particle's state <span class="math notranslate nohighlight">\((r, v_{rad})\)</span> over a full physical timestep <code class="docutils literal notranslate"><span class="pre">h</span></code> ( <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span>). It iteratively refines the integration by comparing a &quot;coarse&quot; integration (using <span class="math notranslate nohighlight">\(2N+1\)</span> micro-steps via <code class="docutils literal notranslate"><span class="pre">doMicroLeapfrog</span></code>) with a &quot;fine&quot; integration (using <span class="math notranslate nohighlight">\(4N+1\)</span> micro-steps). The subdivision factor <span class="math notranslate nohighlight">\(N\)</span> starts at 1 and is doubled if the relative differences in final radius and velocity between coarse and fine passes exceed <code class="docutils literal notranslate"><span class="pre">radius_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity_tol</span></code>, respectively. This process repeats up to a maximum subdivision factor <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>. The final state <span class="math notranslate nohighlight">\((r_{out}, v_{out})\)</span> for the step <code class="docutils literal notranslate"><span class="pre">h</span></code> is chosen based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code> (coarse, fine, or Richardson extrapolation) once convergence is met or <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code> is reached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in gravitational force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles in the simulation. </p></li>
<li><p><strong>r_in</strong> -- [in] Initial radial position (kpc) at the start of the step <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr), conserved. </p></li>
<li><p><strong>h</strong> -- [in] Full physical timestep size <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span> (Myr). </p></li>
<li><p><strong>radius_tol</strong> -- [in] Relative convergence tolerance for radius comparison. </p></li>
<li><p><strong>velocity_tol</strong> -- [in] Relative convergence tolerance for velocity comparison. </p></li>
<li><p><strong>max_subdiv</strong> -- [in] Maximum allowed subdivision factor <span class="math notranslate nohighlight">\(N\)</span> for micro-steps. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units, e.g., G_CONST). </p></li>
<li><p><strong>out_type</strong> -- [in] Result selection mode for converged integration: 0 for coarse result, 1 for fine result, 2 for Richardson extrapolation. </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the final radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">h</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411dRhoDtaufundd">
<span class="target" id="nsphere_8c_1a8de62bf1b56586a24266b2c9788f2995"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dRhoDtaufun</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rhoVal</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vVal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411dRhoDtaufundd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates <span class="math notranslate nohighlight">\(d\rho/d\tau\)</span>, the derivative of the regularized coordinate <span class="math notranslate nohighlight">\(\rho\)</span> with respect to fictitious time <span class="math notranslate nohighlight">\(\tau\)</span>. </p>
<p>In Levi-Civita regularization, <span class="math notranslate nohighlight">\(d\rho/d\tau = \frac{1}{2} \rho v_{rad}\)</span>, where <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span> and <span class="math notranslate nohighlight">\(v_{rad}\)</span> is the radial velocity in physical units (though often represented as <span class="math notranslate nohighlight">\(v\)</span> or <span class="math notranslate nohighlight">\(v_{\rho}\)</span> in transformed equations of motion depending on the specific formulation). This function implements this relationship.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhoVal</strong> -- [in] The current value of the regularized radial coordinate <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span>. </p></li>
<li><p><strong>vVal</strong> -- [in] The current radial velocity <span class="math notranslate nohighlight">\(v_{rad}\)</span> (kpc/Myr). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of <span class="math notranslate nohighlight">\(d\rho/d\tau\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410forceLCfuniidddd">
<span class="target" id="nsphere_8c_1ad782ca225e103de69acd7a2ed0b6e9d9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">forceLCfun</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">totalmass</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rhoVal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410forceLCfuniidddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the total effective force per unit mass in Levi-Civita transformed coordinates. </p>
<p>This function computes <span class="math notranslate nohighlight">\(F_{\rho}/m = (F_{grav,\rho} + F_{centrifugal,\rho})/m\)</span>, where <span class="math notranslate nohighlight">\(F_{grav,\rho}\)</span> is the gravitational force and <span class="math notranslate nohighlight">\(F_{centrifugal,\rho}\)</span> is the effective centrifugal force, both expressed in the regularized radial coordinate <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span>. It calls <code class="docutils literal notranslate"><span class="pre">gravitational_force_rho_v</span></code> and <code class="docutils literal notranslate"><span class="pre">effective_angular_force_rho_v</span></code>. This combined force is used in the equations of motion for Levi-Civita regularization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in gravitational force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>totalmass</strong> -- [in] Total halo mass of the system (Msun) used for gravitational force. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr). </p></li>
<li><p><strong>rhoVal</strong> -- [in] Current value of the regularized radial coordinate <span class="math notranslate nohighlight">\(\rho = \sqrt{r}\)</span>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The total transformed force per unit mass <span class="math notranslate nohighlight">\(F_{\rho}/m\)</span>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420doLeviCivitaLeapfrogiiddddidPdPd">
<span class="target" id="nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doLeviCivitaLeapfrog</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N_taumin</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420doLeviCivitaLeapfrogiiddddidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs integration of particle motion over a physical time <code class="docutils literal notranslate"><span class="pre">dt</span></code> using Levi-Civita regularization. </p>
<p>This function implements a leapfrog-like integration scheme in Levi-Civita regularized coordinates <span class="math notranslate nohighlight">\((ρ, v_{rad})\)</span> and fictitious time <span class="math notranslate nohighlight">\(τ\)</span>. The physical coordinates are <span class="math notranslate nohighlight">\(r = ρ^2\)</span>, and physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> is related to <span class="math notranslate nohighlight">\(τ\)</span> by <span class="math notranslate nohighlight">\(dt_{phys} = ρ^2 dτ\)</span>. The integration proceeds by taking variable <span class="math notranslate nohighlight">\(Δτ\)</span> steps (estimated based on <code class="docutils literal notranslate"><span class="pre">N_taumin</span></code>) until the accumulated physical time <code class="docutils literal notranslate"><span class="pre">t_phys</span></code> reaches or exceeds the target physical timestep <code class="docutils literal notranslate"><span class="pre">dt</span></code>. If a step overshoots <code class="docutils literal notranslate"><span class="pre">dt</span></code>, linear interpolation is used to obtain the state precisely at the target physical time. This method is particularly effective for handling close encounters where <span class="math notranslate nohighlight">\(r → 0\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>r_in</strong> -- [in] Initial physical radial position (kpc) at the start of the physical step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial physical radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr) for the force calculation. </p></li>
<li><p><strong>dt</strong> -- [in] The full physical timestep <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span> (Myr) to advance the particle. </p></li>
<li><p><strong>N_taumin</strong> -- [in] Target number of fictitious <span class="math notranslate nohighlight">\(τ\)</span>-steps within the <code class="docutils literal notranslate"><span class="pre">dt</span></code> interval; influences the initial guess for <span class="math notranslate nohighlight">\(Δτ\)</span>. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the final physical radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final physical radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417doMicroLeviCivitaiidddidddPdPdPd">
<span class="target" id="nsphere_8c_1a43b4fbd8f6dec345978f0bcc2e7d3b9d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doMicroLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_in</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subSteps</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h_tau</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rho_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417doMicroLeviCivitaiidddidddPdPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs Levi-Civita regularized integration using a fixed number of micro-steps. </p>
<p>This helper function advances the particle state in regularized coordinates <span class="math notranslate nohighlight">\((ρ, v_{rad}, t_{phys})\)</span> over a total fictitious time interval <code class="docutils literal notranslate"><span class="pre">h_tau</span></code> ( <span class="math notranslate nohighlight">\(Δτ_{total}\)</span>) by taking a specified number of <code class="docutils literal notranslate"><span class="pre">subSteps</span></code> fixed-size micro-steps ( <span class="math notranslate nohighlight">\(δτ = Δτ_{total} / \text{subSteps}\)</span>). Each micro-step uses a leapfrog-like scheme (Kick-Drift-Kick for <span class="math notranslate nohighlight">\(ρ, v_{rad}\)</span>) and updates the accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> using <span class="math notranslate nohighlight">\(dt_{phys} = δτ \cdot ρ_{mid}^2\)</span>. This function is called by <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> for its coarse and fine passes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>rho_in</strong> -- [in] Initial <span class="math notranslate nohighlight">\(ρ = \sqrt{r}\)</span> at the start of the <code class="docutils literal notranslate"><span class="pre">h_tau</span></code> interval. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial radial velocity <span class="math notranslate nohighlight">\(v_{rad}\)</span> at the start of <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>t_in</strong> -- [in] Initial accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> at the start of <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>subSteps</strong> -- [in] Number of fixed micro-steps to perform over <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>h_tau</strong> -- [in] Total fictitious time interval <span class="math notranslate nohighlight">\(Δτ_{total}\)</span> for this integration sequence. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr). </p></li>
<li><p><strong>rho_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(ρ\)</span> after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(v_{rad}\)</span> after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
<li><p><strong>t_out</strong> -- [out] Pointer to store the final accumulated <span class="math notranslate nohighlight">\(t_{phys}\)</span> after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd">
<span class="target" id="nsphere_8c_1a5b4db770ebecaeb708ae7b16a73d3e37"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h_guess</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rho_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a single adaptive step in Levi-Civita coordinates over a proposed fictitious time <code class="docutils literal notranslate"><span class="pre">h_guess</span></code>. </p>
<p>This function integrates the equations of motion in regularized <span class="math notranslate nohighlight">\((ρ, v_{rad}, t_{phys})\)</span> coordinates over a proposed fictitious time interval <code class="docutils literal notranslate"><span class="pre">h_guess</span></code> ( <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span>). It employs an adaptive refinement strategy by comparing a &quot;coarse&quot; integration (using <span class="math notranslate nohighlight">\(2N+1\)</span> micro-steps via <code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita</span></code>) with a &quot;fine&quot; integration (using <span class="math notranslate nohighlight">\(4N+1\)</span> micro-steps). The subdivision factor <span class="math notranslate nohighlight">\(N\)</span> starts at 1 and is doubled if the relative differences in <span class="math notranslate nohighlight">\(ρ\)</span> and <span class="math notranslate nohighlight">\(v_{rad}\)</span> between coarse and fine results exceed <code class="docutils literal notranslate"><span class="pre">radius_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity_tol</span></code>, respectively. This continues up to <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>. The final state for the <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span> step is chosen based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code> (coarse, fine, or Richardson extrapolation). The function outputs the final <span class="math notranslate nohighlight">\(ρ_{out}\)</span>, <span class="math notranslate nohighlight">\(v_{out}\)</span> (radial velocity), and accumulated physical time <span class="math notranslate nohighlight">\(t_{out}\)</span> corresponding to this adaptive <span class="math notranslate nohighlight">\(Δτ\)</span> step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), for rank in force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>rho_in</strong> -- [in] Initial regularized radial coordinate <span class="math notranslate nohighlight">\(ρ = \sqrt{r}\)</span> at the start of <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial radial velocity <span class="math notranslate nohighlight">\(v_{rad}\)</span> at the start of <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span>. </p></li>
<li><p><strong>t_in</strong> -- [in] Initial accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> at the start of <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span>. </p></li>
<li><p><strong>h_guess</strong> -- [in] The proposed total fictitious time step <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span> for this adaptive step. </p></li>
<li><p><strong>radius_tol</strong> -- [in] Relative convergence tolerance for <span class="math notranslate nohighlight">\(ρ\)</span> comparison. </p></li>
<li><p><strong>velocity_tol</strong> -- [in] Relative convergence tolerance for <span class="math notranslate nohighlight">\(v_{rad}\)</span> comparison. </p></li>
<li><p><strong>max_subdiv</strong> -- [in] Maximum subdivision factor <span class="math notranslate nohighlight">\(N\)</span> for micro-steps within <code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita</span></code>. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units). </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr). </p></li>
<li><p><strong>out_type</strong> -- [in] Result selection for converged micro-integration: 0=coarse, 1=fine, 2=Richardson. </p></li>
<li><p><strong>rho_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(ρ\)</span> after the adaptive <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span> step. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final <span class="math notranslate nohighlight">\(v_{rad}\)</span> after the adaptive <span class="math notranslate nohighlight">\(Δτ_{guess}\)</span> step. </p></li>
<li><p><strong>t_out</strong> -- [out] Pointer to store the final accumulated physical time <span class="math notranslate nohighlight">\(t_{phys}\)</span> after this step. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd">
<span class="target" id="nsphere_8c_1a4d600bde20d7b1720839965824a8f800"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doAdaptiveFullLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N_taumin</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a full adaptive leapfrog step using Levi-Civita regularization over a physical time interval <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p>
<p>This function integrates a particle's motion over a physical timestep <code class="docutils literal notranslate"><span class="pre">dt</span></code> ( <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span>) by taking multiple adaptive steps in fictitious Levi-Civita time <span class="math notranslate nohighlight">\(τ\)</span>. It repeatedly calls <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> to advance the state in <span class="math notranslate nohighlight">\((ρ, v_{rad}, t_{phys})\)</span> coordinates, where <span class="math notranslate nohighlight">\(ρ = \sqrt{r}\)</span>. Each call to <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> takes an adaptive <span class="math notranslate nohighlight">\(Δτ\)</span> step. The loop continues until the accumulated physical time <code class="docutils literal notranslate"><span class="pre">t_cur</span></code> (from summing <span class="math notranslate nohighlight">\(Δt_{phys}\)</span> corresponding to each <span class="math notranslate nohighlight">\(Δτ\)</span>) reaches or exceeds the target <code class="docutils literal notranslate"><span class="pre">dt</span></code>. If a <span class="math notranslate nohighlight">\(Δτ\)</span> step overshoots <code class="docutils literal notranslate"><span class="pre">dt</span></code>, linear interpolation is used to find the state precisely at <code class="docutils literal notranslate"><span class="pre">t_cur</span> <span class="pre">=</span> <span class="pre">dt</span></code>. The final regularized state <span class="math notranslate nohighlight">\((ρ_f, v_f)\)</span> is then transformed back to physical coordinates <span class="math notranslate nohighlight">\((r_{out}, v_{out})\)</span>. An initial guess for <span class="math notranslate nohighlight">\(Δτ\)</span> is made based on <code class="docutils literal notranslate"><span class="pre">N_taumin</span></code> and the initial radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> -- [in] Particle index (0 to npts-1), used for rank in gravitational force calculation. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles in the simulation. </p></li>
<li><p><strong>r_in</strong> -- [in] Initial physical radial position (kpc) at the start of the physical step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_in</strong> -- [in] Initial physical radial velocity (kpc/Myr) at the start of <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>ell</strong> -- [in] Angular momentum per unit mass (kpc^2/Myr), conserved during integration. </p></li>
<li><p><strong>dt</strong> -- [in] The full physical timestep <span class="math notranslate nohighlight">\(\Delta T_{phys}\)</span> (Myr) to advance the particle. </p></li>
<li><p><strong>N_taumin</strong> -- [in] Target number of fictitious <span class="math notranslate nohighlight">\(τ\)</span>-steps within <code class="docutils literal notranslate"><span class="pre">dt</span></code>; influences the initial <span class="math notranslate nohighlight">\(Δτ\)</span> guess. </p></li>
<li><p><strong>radius_tol</strong> -- [in] Relative convergence tolerance for <span class="math notranslate nohighlight">\(ρ\)</span> comparison within each adaptive <span class="math notranslate nohighlight">\(τ\)</span>-step. </p></li>
<li><p><strong>velocity_tol</strong> -- [in] Relative convergence tolerance for velocity comparison within each adaptive <span class="math notranslate nohighlight">\(τ\)</span>-step. </p></li>
<li><p><strong>max_subdiv</strong> -- [in] Maximum allowed subdivision factor N for micro-steps within each adaptive <span class="math notranslate nohighlight">\(τ\)</span>-step. </p></li>
<li><p><strong>grav</strong> -- [in] Gravitational constant G (simulation units, e.g., G_CONST). </p></li>
<li><p><strong>out_type</strong> -- [in] Result selection mode for micro-steps within <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code>: 0 for coarse, 1 for fine, 2 for Richardson extrapolation. </p></li>
<li><p><strong>r_out</strong> -- [out] Pointer to store the final physical radial position (kpc) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_out</strong> -- [out] Pointer to store the final physical radial velocity (kpc/Myr) after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424write_initial_conditionsPPdiPKc">
<span class="target" id="nsphere_8c_1aca344a26cf5ac4e75f3e48f402260df8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_initial_conditions</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424write_initial_conditionsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Writes particle initial conditions to a binary file. </p>
<p>Stores the complete initial particle state (radius, velocity, angular momentum, original index, orientation parameter mu) and the particle count (<code class="docutils literal notranslate"><span class="pre">npts</span></code>) to a binary file for later retrieval via <code class="docutils literal notranslate"><span class="pre">read_initial_conditions</span></code>. Opens the file in write binary mode (&quot;wb&quot;). First writes the integer <code class="docutils literal notranslate"><span class="pre">npts</span></code>, then writes the 5 double-precision values for each particle sequentially.</p>
<section id="nsphere_8c_1autotoc_md42_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md42_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md42">
<span id="nsphere_8c_1autotoc_md42_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md42" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md42">particles : double** 2D array containing particle properties [component][particle_index]. Expected components: 0=rad, 1=vel, 2=angmom, 3=orig_idx, 4=mu. npts : int Number of particles to write. filename : const char* Path to the output binary file.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md43_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md43_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md43">
<span id="nsphere_8c_1autotoc_md43_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md43" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md43">None</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a5dd148939766228831427e02bb7e122d"><span class="std std-ref">read_initial_conditions</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The binary file format is: <code class="docutils literal notranslate"><span class="pre">npts</span></code> (int32), followed by <code class="docutils literal notranslate"><span class="pre">npts</span></code> records, each consisting of 5 <code class="docutils literal notranslate"><span class="pre">double</span></code> values (radius, velocity, ang. mom., orig. index, mu). </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the file cannot be opened.</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423read_initial_conditionsPPdiPKc">
<span class="target" id="nsphere_8c_1a5dd148939766228831427e02bb7e122d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_initial_conditions</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423read_initial_conditionsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Reads particle initial conditions from a binary file. </p>
<p>Loads the complete particle state (radius, velocity, angular momentum, original index, orientation parameter mu) from a binary file previously created by <code class="docutils literal notranslate"><span class="pre">write_initial_conditions</span></code>. Verifies that the number of particles read from the file matches the expected count <code class="docutils literal notranslate"><span class="pre">npts</span></code>. Opens the file in read binary mode (&quot;rb&quot;).</p>
<section id="nsphere_8c_1autotoc_md44_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md44_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md44">
<span id="nsphere_8c_1autotoc_md44_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md44" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md44">particles : double** 2D array to store the loaded particle properties [component][particle_index]. Must be pre-allocated with dimensions [5][npts]. npts : int Expected number of particles to read. filename : const char* Path to the input binary file.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md45_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md45_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md45">
<span id="nsphere_8c_1autotoc_md45_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md45" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md45">None (populates the <code class="docutils literal notranslate"><span class="pre">particles</span></code> array).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1aca344a26cf5ac4e75f3e48f402260df8"><span class="std std-ref">write_initial_conditions</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <code class="docutils literal notranslate"><span class="pre">write_initial_conditions</span></code> for file format details. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the file cannot be opened, if the particle count doesn't match <code class="docutils literal notranslate"><span class="pre">npts</span></code> (returns early), or if a read error occurs.</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420get_sort_descriptionPKc">
<span class="target" id="nsphere_8c_1a2ae9c69e89df65eb9ddc9c3edd6e2422"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_sort_description</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sort_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420get_sort_descriptionPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Returns a human-readable description for a sort algorithm identifier string. </p>
<p>Maps internal sort algorithm identifiers (e.g., &quot;quadsort_parallel&quot;) to user-friendly descriptive names (e.g., &quot;Parallel Quadsort&quot;). This is primarily used for display purposes in command-line output or logs, providing more context than the internal short string identifiers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sort_alg</strong> -- [in] The internal algorithm identifier string. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>const char* A descriptive name for the algorithm. If no match is found, the input <code class="docutils literal notranslate"><span class="pre">sort_alg</span></code> string itself is returned as a fallback. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413parseSaveArgsiA_PcPi">
<span class="target" id="nsphere_8c_1a344694a6ad4d30409cb375f274e47199"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parseSaveArgs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">argc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">argv</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pIndex</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413parseSaveArgsiA_PcPi" title="Link to this definition"></a><br /></dt>
<dd><p>Parses sub-arguments for the <code class="docutils literal notranslate"><span class="pre">--save</span></code> command-line option. </p>
<p>This function is called when the <code class="docutils literal notranslate"><span class="pre">--save</span></code> option is encountered during command-line argument parsing. It reads subsequent arguments (until another option starting with '-' is found, or arguments end) which specify the level or type of data to save. It then sets the corresponding global data output flags (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>) based on the highest priority valid sub-argument encountered. Valid sub-arguments and their priority (lowest to highest):<ul class="simple">
<li><p>&quot;raw-data&quot;: Enables <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>.</p></li>
<li><p>&quot;psi-snaps&quot;: Enables <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>.</p></li>
<li><p>&quot;full-snaps&quot;: Enables <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>.</p></li>
<li><p>&quot;all&quot; or &quot;debug-energy&quot;: Enables all flags (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>).</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Exits the program with an error message if an unknown sub-argument to <code class="docutils literal notranslate"><span class="pre">--save</span></code> is found. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argc</strong> -- [in] The total argument count from <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a0ddf1224851353fc92bfbff6f499fa97"><span class="std std-ref"><span class="pre">main()</span></span></a></code>. </p></li>
<li><p><strong>argv</strong> -- [in] The argument array from <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a0ddf1224851353fc92bfbff6f499fa97"><span class="std std-ref"><span class="pre">main()</span></span></a></code>. </p></li>
<li><p><strong>pIndex</strong> -- [in,out] Pointer to the current index in <code class="docutils literal notranslate"><span class="pre">argv</span></code>. On input, it points to the <code class="docutils literal notranslate"><span class="pre">--save</span></code> option. On output, it is updated to point to the last sub-argument consumed by this function. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427reassign_orig_ids_with_rankPdi">
<span class="target" id="nsphere_8c_1aa4b092fc3980d0bddf5571fb4e2ea26c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reassign_orig_ids_with_rank</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">orig_ids</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427reassign_orig_ids_with_rankPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Remaps original particle IDs to their zero-based rank among a given set of particles. </p>
<p>This function is typically used after a process like tidal stripping, where a subset of particles remains. The <code class="docutils literal notranslate"><span class="pre">orig_ids</span></code> array at this point contains the original, potentially non-contiguous, IDs of these remaining <code class="docutils literal notranslate"><span class="pre">n</span></code> particles. The function sorts these original IDs and then replaces each ID in the input array with its new rank (0 to n-1) within this sorted sequence. This effectively transforms arbitrary original ID values into a compact, contiguous sequence of rank IDs for the final set of particles. The input <code class="docutils literal notranslate"><span class="pre">orig_ids</span></code> array (which is <code class="docutils literal notranslate"><span class="pre">particles[3]</span></code> in <code class="docutils literal notranslate"><span class="pre">main</span></code>) is modified in-place.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses <code class="docutils literal notranslate"><span class="pre">qsort</span></code> and a temporary array for sorting. Exits via <code class="docutils literal notranslate"><span class="pre">exit(1)</span></code> if memory allocation for the temporary array fails. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orig_ids</strong> -- [in,out] Pointer to an array of particle IDs (stored as doubles). These are modified in-place to become rank IDs. </p></li>
<li><p><strong>n</strong> -- [in] The number of elements in the <code class="docutils literal notranslate"><span class="pre">orig_ids</span></code> array (i.e., <code class="docutils literal notranslate"><span class="pre">npts</span></code> after stripping). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424fft_gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fft_gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424fft_gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Applies Gaussian smoothing using FFT-based convolution (thread-safe via critical section). </p>
<p>Smooths a density field defined on a potentially non-uniform grid (<code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>) using FFT convolution with a Gaussian kernel of width <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code> (defined in log-space). Uses zero-padding to avoid wrap-around artifacts. This is generally faster than direct convolution for large <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>. Assumes log_r_grid is uniformly spaced.</p>
<section id="nsphere_8c_1autotoc_md50_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md50_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md50">
<span id="nsphere_8c_1autotoc_md50_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md50" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md50">density_grid : const double* Input density grid array (values corresponding to <code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>). grid_size : int Number of points in the input grid and density arrays. log_r_grid : const double* Array of logarithmic radial grid coordinates (log10(r)). Must be uniformly spaced. sigma_log : double Width (standard deviation) of the Gaussian kernel in log10-space. result : double* Output array (pre-allocated, size <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>) for the smoothed density field.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md51_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md51_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md51">
<span id="nsphere_8c_1autotoc_md51_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md51" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md51">None (populates the <code class="docutils literal notranslate"><span class="pre">result</span></code> array).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"><span class="std std-ref">direct_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses FFTW library for Fast Fourier Transforms (<code class="docutils literal notranslate"><span class="pre">fftw_malloc</span></code>, <code class="docutils literal notranslate"><span class="pre">fftw_plan_dft_r2c_1d</span></code>, etc.). Requires FFTW to be installed. FFTW operations are protected by <code class="docutils literal notranslate"><span class="pre">omp</span> <span class="pre">critical(fftw)</span></code>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resulting smoothed density is clamped to a minimum value of 1e-10. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints errors to stderr and returns early on memory allocation failures or FFTW plan creation failures. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427direct_gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">direct_gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427direct_gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Applies Gaussian smoothing using direct convolution. </p>
<p>Smooths a density field defined on a potentially non-uniform grid (<code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>) using direct spatial convolution with a Gaussian kernel of width <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code> (defined in log-space). For each point <code class="docutils literal notranslate"><span class="pre">i</span></code> in the output <code class="docutils literal notranslate"><span class="pre">result</span></code> array, it computes a weighted sum of the input <code class="docutils literal notranslate"><span class="pre">density_grid</span></code> values: <code class="docutils literal notranslate"><span class="pre">result[i]</span> <span class="pre">=</span> <span class="pre">sum(density_grid[j]</span> <span class="pre">*</span> <span class="pre">kernel(log_r_grid[i]</span> <span class="pre">-</span> <span class="pre">log_r_grid[j]))</span> <span class="pre">/</span> <span class="pre">sum(kernel(...))</span></code> where the <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is a Gaussian function <code class="docutils literal notranslate"><span class="pre">G(x)</span> <span class="pre">=</span> <span class="pre">(1/(σ√2π))</span> <span class="pre">*</span> <span class="pre">exp(-0.5*(x/σ)²)</span></code>, with <code class="docutils literal notranslate"><span class="pre">x</span></code> being the distance <code class="docutils literal notranslate"><span class="pre">log_r_grid[i]</span> <span class="pre">-</span> <span class="pre">log_r_grid[j]</span></code> and <code class="docutils literal notranslate"><span class="pre">σ</span> <span class="pre">=</span> <span class="pre">sigma_log</span></code>. This method is generally more accurate than FFT-based convolution, especially for non-uniform grids or near boundaries, but has a higher computational cost (O(N²)) which makes it slower for large <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>.</p>
<section id="nsphere_8c_1autotoc_md52_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md52_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md52">
<span id="nsphere_8c_1autotoc_md52_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md52" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md52">density_grid : const double* Input density grid array (values corresponding to <code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>). grid_size : int Number of points in the input grid and density arrays. log_r_grid : const double* Array of logarithmic radial grid coordinates (log10(r)). Can be non-uniformly spaced. sigma_log : double Width (standard deviation) of the Gaussian kernel in log10-space. result : double* Output array (pre-allocated, size <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>) for the smoothed density field.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md53_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md53_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md53">
<span id="nsphere_8c_1autotoc_md53_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md53" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md53">None (populates the <code class="docutils literal notranslate"><span class="pre">result</span></code> array).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"><span class="std std-ref">fft_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resulting smoothed density is clamped to a minimum value of 1e-10. This function is inherently thread-safe as it only reads inputs and writes to distinct elements of the output array without shared intermediate state. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs Gaussian smoothing by selecting the appropriate convolution method. </p>
<p>Acts as a routing function that delegates density smoothing to either <code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution</span></code> or <code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution</span></code> based on the value of the global <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> flag.<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> is non-zero, <code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution</span></code> is called (more accurate, O(N²) complexity, suitable for smaller or non-uniform grids).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> is zero (default), <code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution</span></code> is called (faster for large grids, O(N log N) complexity, requires uniformly spaced logarithmic grid).</p></li>
</ul>
</p>
<section id="nsphere_8c_1autotoc_md54_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md54_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md54">
<span id="nsphere_8c_1autotoc_md54_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md54" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md54">density_grid : const double* Input density grid array (values corresponding to <code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>). grid_size : int Number of points in the input grid and density arrays. log_r_grid : const double* Array of logarithmic radial grid coordinates (log10(r)). Must be uniform if FFT is used. sigma_log : double Width (standard deviation) of the Gaussian kernel in log10-space. result : double* Output array (pre-allocated, size <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>) for the smoothed density field.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md55_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md55_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md55">
<span id="nsphere_8c_1autotoc_md55_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md55" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md55">None (populates the <code class="docutils literal notranslate"><span class="pre">result</span></code> array).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"><span class="std std-ref">direct_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"><span class="std std-ref">fft_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a4a1f369af4feb2852a5bddbace1948b9"><span class="std std-ref">debug_direct_convolution</span></a></p>
</div>
</p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428find_last_processed_snapshotPii">
<span class="target" id="nsphere_8c_1a8f1878f89cdeb5134aa413a021e301ec"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">find_last_processed_snapshot</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">snapshot_steps</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">noutsnaps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428find_last_processed_snapshotPii" title="Link to this definition"></a><br /></dt>
<dd><p>Finds the index of the last successfully processed and written snapshot in restart mode. </p>
<p>This function is called when <code class="docutils literal notranslate"><span class="pre">--restart</span></code> is active. It checks for the existence and basic integrity of snapshot data files (e.g., <code class="docutils literal notranslate"><span class="pre">Rank_Mass_Rad_VRad_unsorted_t%05d.dat</span></code> and <code class="docutils literal notranslate"><span class="pre">Rank_Mass_Rad_VRad_sorted_t%05d.dat</span></code>) corresponding to the timesteps listed in <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code>. Integrity is checked by comparing file sizes against those of the first snapshot's files (snapshot_steps[0]), allowing for a small percentage tolerance (typically +/- 5%). The function aims to determine from which snapshot index <code class="docutils literal notranslate"><span class="pre">s</span></code> (in <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code>) the post-processing (e.g., Rank file generation) should resume. It assumes <code class="docutils literal notranslate"><span class="pre">g_file_suffix</span></code> is correctly set to identify the relevant run's files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_steps</strong> -- [in] Array of integer timestep numbers for which snapshot data was expected to be written (often these are the <code class="docutils literal notranslate"><span class="pre">dtwrite</span></code> intervals). </p></li>
<li><p><strong>noutsnaps</strong> -- [in] The total number of snapshot indices in the <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code> array.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int The index <code class="docutils literal notranslate"><span class="pre">s</span></code> into <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code> corresponding to the <em>first snapshot that needs to be processed</em> (i.e., last valid snapshot index + 1).<ul class="simple">
<li><p>Returns -1 if no valid snapshot files are found (implying processing should start from index 0).</p></li>
<li><p>Returns -2 if all expected snapshot files for all unique snapshot numbers exist and appear valid (implying no further snapshot processing is needed for this phase). Prints status messages to stdout and logs warnings/errors. </p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413compare_by_rrPKvPKv">
<span class="target" id="nsphere_8c_1a56d40dff8c3bb82e43ca11c357d1a572"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_by_rr</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413compare_by_rrPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for qsort to sort <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structures by the 'rr' member. </p>
<p>Used to sort an array of <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structures in ascending order based on their radial (<code class="docutils literal notranslate"><span class="pre">rr</span></code>) component. This is primarily used when preparing data for splines where the x-axis (e.g., radius or -Psi) must be strictly monotonic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- Pointer to the first <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structure. </p></li>
<li><p><strong>b</strong> -- Pointer to the second <a class="reference internal" href="#struct_rr_psi_pair"><span class="std std-ref">RrPsiPair</span></a> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if pa-&gt;rr &lt; pb-&gt;rr, 1 if pa-&gt;rr &gt; pb-&gt;rr, 0 otherwise. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425check_strict_monotonicityPKdiPKc">
<span class="target" id="nsphere_8c_1a6a7772eb5bcc88c4c20fca47220196ff"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">check_strict_monotonicity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">arr</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">name</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425check_strict_monotonicityPKdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Check if an array is strictly monotonically increasing. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> -- Array to check </p></li>
<li><p><strong>n</strong> -- Number of elements </p></li>
<li><p><strong>name</strong> -- Name of the array for debug messages </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if strictly monotonic, 0 otherwise </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416handle_sidm_stepPPdidddii">
<span class="target" id="nsphere_8c_1a8c0f3bd51c9af9053c95629e8a2e02c9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">handle_sidm_step</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_sim_time</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">active_profile_rc</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_method_display_num</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bootstrap_phase_active</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416handle_sidm_stepPPdidddii" title="Link to this definition"></a><br /></dt>
<dd><p>Handles the SIDM scattering phase for a single timestep. </p>
<p>Checks if SIDM is enabled and if not in a bootstrap phase that should skip SIDM. If proceeding, it resets particle scatter flags, selects serial or parallel execution based on <code class="docutils literal notranslate"><span class="pre">g_sidm_execution_mode</span></code>, calls the appropriate core scattering function (<code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_serial</span></code> or <code class="docutils literal notranslate"><span class="pre">perform_sidm_scattering_parallel</span></code>), updates the global total scatter count, and logs debug information if scatters occurred and debugging is enabled. The core scattering functions are responsible for updating the <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code> flags for particles that underwent scattering.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function modifies the <code class="docutils literal notranslate"><span class="pre">particles</span></code> array in-place. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It uses global variables: <code class="docutils literal notranslate"><span class="pre">g_enable_sidm_scattering</span></code>, <code class="docutils literal notranslate"><span class="pre">g_sidm_execution_mode</span></code>, <code class="docutils literal notranslate"><span class="pre">g_rng_per_thread</span></code>, <code class="docutils literal notranslate"><span class="pre">g_max_omp_threads_for_rng</span></code>, <code class="docutils literal notranslate"><span class="pre">g_rng</span></code>, <code class="docutils literal notranslate"><span class="pre">g_total_sidm_scatters</span></code>, <code class="docutils literal notranslate"><span class="pre">g_active_halo_mass</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, and <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] The main particle data array: <code class="docutils literal notranslate"><span class="pre">particles[component][current_sorted_index]</span></code>. Modified in-place with post-scattering velocities/angular momenta. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>dt</strong> -- [in] The simulation timestep (Myr). </p></li>
<li><p><strong>current_sim_time</strong> -- [in] The current simulation time at the beginning of this step (Myr). </p></li>
<li><p><strong>active_profile_rc</strong> -- [in] The scale radius (kpc) of the currently active profile (NFW or Cored), passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>current_method_display_num</strong> -- [in] The user-facing display number of the current integration method (for logging). </p></li>
<li><p><strong>bootstrap_phase_active</strong> -- [in] Flag (0 or 1) indicating if a bootstrap phase (e.g., for Adams-Bashforth) is active. If 1, SIDM scattering is skipped for this step. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424get_available_disk_spacePKc">
<span class="target" id="nsphere_8c_1a69a5382b45f88c0e827ededfec0cf9e1"></span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_available_disk_space</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">path</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424get_available_disk_spacePKc" title="Link to this definition"></a><br /></dt>
<dd><p>Gets the available disk space for the filesystem containing the given path. </p>
<p>This function uses platform-specific APIs to determine the free space available to the current user on the filesystem where <code class="docutils literal notranslate"><span class="pre">path</span></code> resides. On Windows, it uses <code class="docutils literal notranslate"><span class="pre">GetDiskFreeSpaceEx</span></code>. On POSIX-compliant systems (Linux, macOS), it uses <code class="docutils literal notranslate"><span class="pre">statvfs</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> -- <p>[in] A path to a file or directory on the filesystem to check. For Windows, this can be a root directory like &quot;C:\\&quot;.</p>
<p>For POSIX, any path within the target filesystem, e.g., &quot;data/&quot;.</p>
</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>long long Available disk space in bytes. Returns -1 on error or if the functionality is not implemented for the current platform. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413prompt_yes_noPKc">
<span class="target" id="nsphere_8c_1a96756bc10475202e578c85a8dbce8045"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">prompt_yes_no</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prompt</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413prompt_yes_noPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Prompts the user with a yes/no question and reads their response from stdin. </p>
<p>Displays the given <code class="docutils literal notranslate"><span class="pre">prompt</span></code> string followed by &quot;[y/N]: &quot;. Reads a line of input from the user.<ul class="simple">
<li><p>Returns 1 (yes) if the first character of the input is 'y' or 'Y'.</p></li>
<li><p>Returns 0 (no) if the first character is 'n', 'N', or if the input is an empty line (user just pressed Enter, defaulting to No).</p></li>
<li><p>If any other input is received, the prompt is repeated. Handles potential EOF or read errors by defaulting to No.</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prompt</strong> -- [in] The question/prompt message to display to the user. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int 1 if the user confirms (yes), 0 otherwise (no/default). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv44mainiA_Pc">
<span class="target" id="nsphere_8c_1a0ddf1224851353fc92bfbff6f499fa97"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">main</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">argc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">argv</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv44mainiA_Pc" title="Link to this definition"></a><br /></dt>
<dd><p>Main entry point for the n-sphere dark matter simulation program. </p>
<p>Orchestrates the overall simulation workflow:<ol class="loweralpha simple">
<li><p>Parses command-line arguments.</p></li>
<li><p>Sets up global parameters and logging.</p></li>
<li><p>Initializes random number generators.</p></li>
<li><p>Generates or loads initial conditions (ICs) for either NFW or Cored Plummer-like profiles.<ul class="simple">
<li><p>Includes theoretical calculations for density, mass, potential, and f(E) splines.</p></li>
<li><p>Includes a diagnostic loop to test IC generation with varied numerical parameters.</p></li>
<li><p>Performs particle sampling based on the derived distribution function.</p></li>
</ul>
</p></li>
<li><p>Optionally performs tidal stripping and re-assigns particle IDs.</p></li>
<li><p>Converts particle velocities to physical simulation units.</p></li>
<li><p>Executes the main N-body timestepping loop using a selected integration method.<ul class="simple">
<li><p>Performs gravitational updates.</p></li>
<li><p>Optionally performs SIDM scattering via <code class="docutils literal notranslate"><span class="pre">handle_sidm_step</span></code>.</p></li>
<li><p>Tracks particle trajectories and energies.</p></li>
<li><p>Periodically writes simulation data and progress.</p></li>
</ul>
</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is enabled, processes all particle data to generate snapshot files for Rank/Mass/Radius/Velocity/Potential/Energy/Density.</p></li>
<li><p>Writes final summary plots and theoretical profiles.</p></li>
<li><p>Cleans up allocated resources. Handles restart/resume functionality by checking for existing data products.</p></li>
</ol>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This application supports OpenMP for parallelization in various sections. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Large particle counts or long simulations can be memory and CPU intensive. Disk space requirements for full data output can also be significant. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>argc</strong> -- [in] Standard argument count from the command line. </p></li>
<li><p><strong>argv</strong> -- [in] Standard array of argument strings from the command line. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int Exit code: 0 for successful execution, non-zero for errors.</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1a66edb3d9254e7075824efdfeb375175a"></span><span class="sig-name descname"><span class="pre">double</span> <span class="pre">massintegrand</span> <span class="pre">(double</span> <span class="pre">r,</span> <span class="pre">void</span> <span class="pre">*params</span> <span class="pre">__attribute__((unused)))</span></span></dt>
<dd><p>GSL integrand <span class="math notranslate nohighlight">\(r^2 \rho_{shape}(r)\)</span> for Cored Plummer-like profile mass calculation. </p>
<p>Computes the term <span class="math notranslate nohighlight">\(r^2 \rho_{shape}(r)\)</span> for the Cored Plummer-like density profile, where <span class="math notranslate nohighlight">\(\rho_{shape}(r) = (1 + (r/RC)^2)^{-3}\)</span>. This integrand is used in GSL numerical integration routines (e.g., <code class="docutils literal notranslate"><span class="pre">gsl_integration_qag</span></code>) to calculate the normalization factor or the enclosed mass <span class="math notranslate nohighlight">\(M(&lt;r) = 4\pi \int_0^r r'^2 \rho_{physical}(r') dr'\)</span>. It directly uses the <code class="docutils literal notranslate"><span class="pre">RC</span></code> macro for the scale radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> -- [in] Radial coordinate <span class="math notranslate nohighlight">\(r\)</span> (kpc). </p></li>
<li><p><strong>params</strong> -- [in] Void pointer to parameters (unused in this version, hence <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a415c6d1c558074ad329697f2c01820fc"><span class="std std-ref"><span class="pre">__attribute__((unused))</span></span></a></code>). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double The value of the mass integrand <span class="math notranslate nohighlight">\(r^2 \rho_{shape}(r)\)</span> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414insertion_sortPPdi">
<span class="target" id="nsphere_8c_1a9f764a3b15f188a11747c55c91e3fea6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414insertion_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Implementation of classic insertion sort algorithm for particle data. </p>
<p>Sorts an array of particle data using the insertion sort algorithm. While not the fastest algorithm for large datasets, it is stable and works well for small arrays or nearly sorted data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420stdlib_qsort_wrapperPPdi">
<span class="target" id="nsphere_8c_1a5054402587a6df1b0a3eaf1b197fee26"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stdlib_qsort_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420stdlib_qsort_wrapperPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper for the standard C library quicksort function. </p>
<p>Provides a consistent interface to the standard library <code class="docutils literal notranslate"><span class="pre">qsort</span></code> function using the <code class="docutils literal notranslate"><span class="pre">compare_particles</span></code> function as the comparison callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted (passed as <code class="docutils literal notranslate"><span class="pre">double**</span></code>). </p></li>
<li><p><strong>n</strong> -- Number of elements (particles) to sort. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416quadsort_wrapperPPdi">
<span class="target" id="nsphere_8c_1ae61a8488ea1cc6e78d15b9a6412a7ac4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416quadsort_wrapperPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper for the external quadsort algorithm. </p>
<p>Provides a consistent interface to the external quadsort function, which is typically faster than standard quicksort for many distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418insertion_sort_subPPdii">
<span class="target" id="nsphere_8c_1ad333571f8f209b19896bc93e94643a61"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_sort_sub</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">end</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418insertion_sort_subPPdii" title="Link to this definition"></a><br /></dt>
<dd><p>Helper function that performs insertion sort on a subarray of particle data. </p>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> but operates on a specific range <code class="docutils literal notranslate"><span class="pre">[start..end]</span></code> inclusive. Used by the parallel sorting algorithms to sort individual chunks and seam regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data containing the target subarray (<code class="docutils literal notranslate"><span class="pre">double**</span></code>). </p></li>
<li><p><strong>start</strong> -- Starting index of the subarray (inclusive). </p></li>
<li><p><strong>end</strong> -- Ending index of the subarray (inclusive). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423insertion_parallel_sortPPdi">
<span class="target" id="nsphere_8c_1a333ac7a494bba72619fb98750fe69634"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_parallel_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423insertion_parallel_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Parallel insertion sort implementation using chunk-based approach with overlap. </p>
<p>Divides the data into num_sort_sections chunks, sorts each chunk in parallel, then fixes the boundaries between chunks by re-sorting overlap regions. This approach balances parallelism with the need to ensure properly sorted output.</p>
<p>
Parallel implementation of insertion sort algorithm optimized for particle sorting.</p>
<p>Uses multiple OpenMP threads to sort sections of particle data in parallel, followed by seam-fixing operations to ensure global ordering. Includes dynamic section calculation and optimized overlap sizing based on chunk characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort</p></li>
<li><p><strong>columns</strong> -- Column-major data array [particle][component] </p></li>
<li><p><strong>n</strong> -- Number of particles to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422quadsort_parallel_sortPPdi">
<span class="target" id="nsphere_8c_1af20d2b892dfa310cbf845403a905796e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_parallel_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422quadsort_parallel_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Parallel quadsort implementation using chunk-based approach with overlap. </p>
<p>Similar to insertion_parallel_sort but uses the quadsort algorithm for both the initial chunk sorting and the seam fixing. Quadsort is generally faster than insertion sort for larger datasets while maintaining stability.</p>
<p>
Parallel implementation of quadsort algorithm optimized for particle sorting.</p>
<p>Uses multiple OpenMP threads to sort sections of particle data in parallel, followed by seam-fixing operations to ensure global ordering. Includes dynamic section calculation and optimized overlap sizing based on chunk characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> -- Number of elements to sort</p></li>
<li><p><strong>columns</strong> -- Column-major data array [particle][component] </p></li>
<li><p><strong>n</strong> -- Number of particles to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419verify_sort_resultsPPdiPKc">
<span class="target" id="nsphere_8c_1a7569fb12f08ce841608a7c3e54a0ad19"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">verify_sort_results</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">label</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419verify_sort_resultsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Validates sorting results by comparing with standard qsort. </p>
<p>Creates a copy of the input array, sorts it with standard qsort, then compares the results element by element to verify that the sorting algorithm produced the expected ordering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> -- 2D array of particle data that has been sorted </p></li>
<li><p><strong>n</strong> -- Number of elements in the array </p></li>
<li><p><strong>label</strong> -- Name of the sorting algorithm for diagnostic output </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423compare_partdata_by_radPKvPKv">
<span class="target" id="nsphere_8c_1a894769c574fe85ecef41c7741e2a1a55"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_partdata_by_rad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423compare_partdata_by_radPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for qsort to sort <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures by radius. </p>
<p>Compares two <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structures based on their <code class="docutils literal notranslate"><span class="pre">rad</span></code> (radius) member for sorting in ascending order. Handles NaN values by placing them consistently (e.g., at the beginning or end, behavior might depend on qsort NaN handling).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- Pointer to the first <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structure. </p></li>
<li><p><strong>b</strong> -- Pointer to the second <a class="reference internal" href="#struct_part_data"><span class="std std-ref">PartData</span></a> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int -1 if pa-&gt;rad &lt; pb-&gt;rad, 1 if pa-&gt;rad &gt; pb-&gt;rad, 0 otherwise. Specific return for NaNs ensures consistent ordering. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1a31665a75ff29f617cf56886c1b1498f9"></span><span class="sig-name descname"><span class="pre">double</span> <span class="pre">sigmatotal</span> <span class="pre">(double</span> <span class="pre">vrel</span> <span class="pre">__attribute__((unused)),</span> <span class="pre">int</span> <span class="pre">npts,</span> <span class="pre">double</span> <span class="pre">halo_mass_for_calc,</span> <span class="pre">double</span> <span class="pre">rc_for_calc</span> <span class="pre">__attribute__((unused)))</span></span></dt>
<dd><p>Calculates self-interacting dark matter (SIDM) scattering cross-section. </p>
<p>Implements a velocity-independent cross-section model where the opacity <span class="math notranslate nohighlight">\(\sigma/m = \kappa\)</span> is constant. The default value for <span class="math notranslate nohighlight">\(\kappa\)</span> is taken from the global variable <code class="docutils literal notranslate"><span class="pre">g_sidm_kappa</span></code>. The total cross-section <span class="math notranslate nohighlight">\(\sigma\)</span> then scales with the individual particle mass, <span class="math notranslate nohighlight">\(m_{particle}\)</span>, which is derived from the total <code class="docutils literal notranslate"><span class="pre">halo_mass_for_calc</span></code> and the number of particles <code class="docutils literal notranslate"><span class="pre">npts</span></code>. The function includes necessary unit conversions to return the cross-section in simulation units (kpc²).</p>
<p>Unit Conversion Detail: <span class="math notranslate nohighlight">\(\kappa\)</span> (cm²/g) <span class="math notranslate nohighlight">\(\times m_{particle}\)</span> (Msun) <span class="math notranslate nohighlight">\(\rightarrow \sigma\)</span> (kpc²) The conversion factor used is <span class="math notranslate nohighlight">\(2.089 \times 10^{-10} \text{ (kpc}^2 \text{ Msun}^{-1}) / (\text{cm}^2 \text{ g}^{-1})\)</span>, derived from <span class="math notranslate nohighlight">\((1.989 \times 10^{33} \text{ g/Msun}) / (3.086 \times 10^{21} \text{ cm/kpc})^2\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>vrel</strong> -- [in] Relative velocity between particles (kpc/Myr). Currently unused as the implemented model is velocity-independent. Marked with <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a415c6d1c558074ad329697f2c01820fc"><span class="std std-ref"><span class="pre">__attribute__((unused))</span></span></a></code>. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of simulation particles, used for calculating <span class="math notranslate nohighlight">\(m_{particle}\)</span>. </p></li>
<li><p><strong>halo_mass_for_calc</strong> -- [in] Total halo mass (Msun) for the active profile, used for <span class="math notranslate nohighlight">\(m_{particle}\)</span>. </p></li>
<li><p><strong>rc_for_calc</strong> -- [in] Scale radius (kpc) of the active profile. Currently unused in this velocity-independent cross-section model. Marked with <code class="docutils literal notranslate"><a class="reference internal" href="#nsphere_8c_1a415c6d1c558074ad329697f2c01820fc"><span class="std std-ref"><span class="pre">__attribute__((unused))</span></span></a></code>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>double Total scattering cross-section <span class="math notranslate nohighlight">\(\sigma\)</span> in kpc². Returns 0.0 if <code class="docutils literal notranslate"><span class="pre">npts</span></code> or the calculated <code class="docutils literal notranslate"><span class="pre">particle_mass_Msun</span></code> is non-positive to prevent errors. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1af74e8d1dd62cf65018e746cf4bac584b"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">perform_sidm_scattering_serial</span> <span class="pre">(double</span> <span class="pre">**particles,</span> <span class="pre">int</span> <span class="pre">npts,</span> <span class="pre">double</span> <span class="pre">dt,</span> <span class="pre">double</span> <span class="pre">current_time</span> <span class="pre">__attribute__((unused)),</span> <span class="pre">gsl_rng</span> <span class="pre">*rng,</span> <span class="pre">long</span> <span class="pre">long</span> <span class="pre">*Nscatter_total_step,</span> <span class="pre">double</span> <span class="pre">halo_mass_for_sidm</span> <span class="pre">__attribute__((unused)),</span> <span class="pre">double</span> <span class="pre">rc_for_sidm</span> <span class="pre">__attribute__((unused)))</span></span></dt>
<dd><p>Executes self-interacting dark matter (SIDM) scattering for one simulation timestep (Serial version). </p>
<p>Implements a serial SIDM scattering algorithm. For each particle <code class="docutils literal notranslate"><span class="pre">i</span></code> (the primary scatterer), it considers up to <code class="docutils literal notranslate"><span class="pre">nscat</span></code> (typically 10) subsequent particles in the array as potential scattering partners. (The <code class="docutils literal notranslate"><span class="pre">particles</span></code> array is assumed to be sorted by radius, so these are spatially nearby neighbors). The algorithm proceeds as follows for each primary particle <code class="docutils literal notranslate"><span class="pre">i</span></code>:<ol class="loweralpha simple">
<li><p>Constructs 3D velocity for particle <code class="docutils literal notranslate"><span class="pre">i</span></code>, assigning a random azimuthal angle to its perpendicular component.</p></li>
<li><p>For each of the <code class="docutils literal notranslate"><span class="pre">nscat</span></code> potential partners <code class="docutils literal notranslate"><span class="pre">m</span></code>: a. Constructs 3D velocity for partner <code class="docutils literal notranslate"><span class="pre">m</span></code> (assuming a fixed azimuthal orientation for simplicity). b. Calculates relative velocity <span class="math notranslate nohighlight">\(v_{rel}\)</span> and interaction rate <span class="math notranslate nohighlight">\(\Gamma_m = \sigma(v_{rel}) v_{rel}\)</span>. c. Accumulates total interaction rate <span class="math notranslate nohighlight">\(\Gamma_{tot} = \sum \Gamma_m\)</span>.</p></li>
<li><p>Estimates local particle number density using a shell volume. The shell is defined by particle <code class="docutils literal notranslate"><span class="pre">i</span></code> and an outer radius typically determined by particle <code class="docutils literal notranslate"><span class="pre">i</span> <span class="pre">+</span> <span class="pre">nscat</span> <span class="pre">+</span> <span class="pre">1</span></code>.</p></li>
<li><p>Calculates the total scattering probability for particle <code class="docutils literal notranslate"><span class="pre">i</span></code> in timestep <code class="docutils literal notranslate"><span class="pre">dt</span></code>: <span class="math notranslate nohighlight">\(P_{scatter} \approx \Gamma_{tot} \times (0.5 \times dt / \text{Volume}_{shell})\)</span>. The 0.5 factor accounts for double counting pairs.</p></li>
<li><p>A random number is drawn. If it's less than <span class="math notranslate nohighlight">\(P_{scatter}\)</span>, a scatter occurs: a. One partner <code class="docutils literal notranslate"><span class="pre">m_scatter</span></code> is stochastically chosen from the <code class="docutils literal notranslate"><span class="pre">nscat</span></code> candidates, weighted by their individual <span class="math notranslate nohighlight">\(\Gamma_m\)</span>. b. Isotropic scattering is performed in the center-of-mass frame of the pair <span class="math notranslate nohighlight">\((i, m_{scatter})\)</span>. c. The 3D velocities of both particles are updated. d. New radial velocities and angular momenta are calculated from the updated 3D velocities and stored back into the <code class="docutils literal notranslate"><span class="pre">particles</span></code> array, modifying it in-place. e. The <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code> flags are set for the scattered particles. The total number of scattering events in this timestep is accumulated.</p></li>
</ol>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] Main particle data array: <code class="docutils literal notranslate"><span class="pre">particles[component][current_sorted_index]</span></code>. Modified in-place with post-scattering velocities/angular momenta. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of simulation particles. </p></li>
<li><p><strong>dt</strong> -- [in] Integration timestep (Myr). </p></li>
<li><p><strong>current_time</strong> -- [in] Current simulation time (Myr). Marked <code class="docutils literal notranslate"><span class="pre">unused</span></code> but available. </p></li>
<li><p><strong>rng</strong> -- [in] GSL random number generator instance for all stochastic processes. </p></li>
<li><p><strong>Nscatter_total_step</strong> -- [out] Pointer to a long long to accumulate total scattering events this timestep. </p></li>
<li><p><strong>halo_mass_for_sidm</strong> -- [in] Total halo mass (Msun) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>rc_for_sidm</strong> -- [in] Scale radius (kpc) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422compare_scatter_eventsPKvPKv">
<span class="target" id="nsphere_8c_1ab42b84166864920fb6e8b03da1aad2e7"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_scatter_events</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422compare_scatter_eventsPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for <code class="docutils literal notranslate"><span class="pre">qsort</span></code> to order <code class="docutils literal notranslate"><a class="reference internal" href="#struct_scatter_event"><span class="std std-ref"><span class="pre">ScatterEvent</span></span></a></code> structures. </p>
<p>Sorts an array of <code class="docutils literal notranslate"><a class="reference internal" href="#struct_scatter_event"><span class="std std-ref"><span class="pre">ScatterEvent</span></span></a></code> structures primarily by the first particle's original index (<code class="docutils literal notranslate"><span class="pre">i</span></code>) in ascending order. If two events have the same primary particle index <code class="docutils literal notranslate"><span class="pre">i</span></code>, they are then secondarily sorted by the partner's offset (<code class="docutils literal notranslate"><span class="pre">m_offset</span></code>) in ascending order. This ensures a deterministic (and efficient for potential cache effects) order when applying buffered scatter updates to the main particle array, preventing race conditions or non-deterministic outcomes if multiple scatters involve the same primary particle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> -- [in] Pointer to the first <code class="docutils literal notranslate"><a class="reference internal" href="#struct_scatter_event"><span class="std std-ref"><span class="pre">ScatterEvent</span></span></a></code> structure. </p></li>
<li><p><strong>b</strong> -- [in] Pointer to the second <code class="docutils literal notranslate"><a class="reference internal" href="#struct_scatter_event"><span class="std std-ref"><span class="pre">ScatterEvent</span></span></a></code> structure. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>int - An integer less than, equal to, or greater than zero if the first argument is considered to be respectively less than, equal to, or greater than the second. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1acb17244299161c49b71c970ce5b639bd"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">perform_sidm_scattering_parallel</span> <span class="pre">(double</span> <span class="pre">**particles,</span> <span class="pre">int</span> <span class="pre">npts,</span> <span class="pre">double</span> <span class="pre">dt,</span> <span class="pre">double</span> <span class="pre">current_time</span> <span class="pre">__attribute__((unused)),</span> <span class="pre">gsl_rng</span> <span class="pre">**rng_per_thread_list,</span> <span class="pre">int</span> <span class="pre">num_threads_for_rng,</span> <span class="pre">long</span> <span class="pre">long</span> <span class="pre">*Nscatter_total_step,</span> <span class="pre">double</span> <span class="pre">halo_mass_for_sidm,</span> <span class="pre">double</span> <span class="pre">rc_for_sidm)</span></span></dt>
<dd><p>Performs SIDM scattering calculations for one timestep using OpenMP for parallelism. </p>
<p>This function implements a two-phase parallel algorithm for SIDM scattering: Phase 1 (Parallel Particle Evaluation):<ul class="simple">
<li><p>The main particle loop (over <code class="docutils literal notranslate"><span class="pre">i</span></code>) is parallelized using OpenMP.</p></li>
<li><p>Each thread processes its assigned subset of primary particles (<code class="docutils literal notranslate"><span class="pre">i</span></code>).</p></li>
<li><p>For each particle <code class="docutils literal notranslate"><span class="pre">i</span></code>, it considers <code class="docutils literal notranslate"><span class="pre">nscat</span></code> neighbors (by sorted rank) as potential scattering partners.</p></li>
<li><p>Interaction rates and total scattering probability for particle <code class="docutils literal notranslate"><span class="pre">i</span></code> with its neighbors are calculated using a shell volume approximation for local density.</p></li>
<li><p>A per-thread GSL RNG (<code class="docutils literal notranslate"><span class="pre">local_rng</span></code> from <code class="docutils literal notranslate"><span class="pre">rng_per_thread_list</span></code>) is used for all stochastic decisions (scatter occurrence, partner selection, scattering angles).</p></li>
<li><p>If a scatter occurs for particle <code class="docutils literal notranslate"><span class="pre">i</span></code> with a chosen partner <code class="docutils literal notranslate"><span class="pre">i+m_scatter</span></code>, the resulting final 3D velocities for both particles are computed.</p></li>
<li><p>These outcomes (indices <code class="docutils literal notranslate"><span class="pre">i</span></code>, <code class="docutils literal notranslate"><span class="pre">m_offset</span></code>, and final velocities) are stored in a <code class="docutils literal notranslate"><a class="reference internal" href="#struct_scatter_event"><span class="std std-ref"><span class="pre">ScatterEvent</span></span></a></code> structure and added to a dynamically resizing global buffer (<code class="docutils literal notranslate"><span class="pre">global_scatter_results</span></code>) under an OpenMP critical section to ensure thread-safe appending. Phase 2 (Serial Update from Buffered Results):</p></li>
<li><p>After the parallel loop completes, a single thread sorts the <code class="docutils literal notranslate"><span class="pre">global_scatter_results</span></code> (by primary particle index, then partner offset) to ensure deterministic application order.</p></li>
<li><p>It then iterates through the sorted scatter events and updates the main <code class="docutils literal notranslate"><span class="pre">particles</span></code> array (radial velocity <code class="docutils literal notranslate"><span class="pre">particles[1]</span></code> and angular momentum <code class="docutils literal notranslate"><span class="pre">particles[2]</span></code>) with the final post-scatter velocities.</p></li>
<li><p>Updates the <code class="docutils literal notranslate"><span class="pre">g_particle_scatter_state</span></code> flags for particles involved in scattering. The <code class="docutils literal notranslate"><span class="pre">particles</span></code> array is assumed to be sorted by radius prior to calling this function.</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>particles</strong> -- [in,out] Main particle data array: <code class="docutils literal notranslate"><span class="pre">particles[component][current_sorted_index]</span></code>. Modified in-place with post-scattering velocities/angular momenta. </p></li>
<li><p><strong>npts</strong> -- [in] Total number of particles. </p></li>
<li><p><strong>dt</strong> -- [in] Simulation timestep (Myr), used in probability calculation. </p></li>
<li><p><strong>current_time</strong> -- [in] Current simulation time (Myr). Marked <code class="docutils literal notranslate"><span class="pre">unused</span></code> but available for future use. </p></li>
<li><p><strong>rng_per_thread_list</strong> -- [in] Array of GSL RNG states, one for each OpenMP thread. </p></li>
<li><p><strong>num_threads_for_rng</strong> -- [in] The number of allocated RNGs in <code class="docutils literal notranslate"><span class="pre">rng_per_thread_list</span></code> (should match max threads). </p></li>
<li><p><strong>Nscatter_total_step</strong> -- [out] Pointer to a long long to accumulate the total number of scatter events that occurred in this timestep. </p></li>
<li><p><strong>halo_mass_for_sidm</strong> -- [in] Total halo mass (Msun) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
<li><p><strong>rc_for_sidm</strong> -- [in] Scale radius (kpc) for the active profile, passed to <code class="docutils literal notranslate"><span class="pre">sigmatotal</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-variables">Variables</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_file_suffix">
<span class="target" id="nsphere_8c_1a2849b95526a209a1c2bef7450ec4fb6e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_file_suffix</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">256</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;&quot;</span></span><a class="headerlink" href="#_CPPv413g_file_suffix" title="Link to this definition"></a><br /></dt>
<dd><p>Global file suffix string. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv45g_rng">
<span class="target" id="nsphere_8c_1a4ea0ea00d950a3956c6c25bb9fcc02a5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_rng</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv45g_rng" title="Link to this definition"></a><br /></dt>
<dd><p>GSL Random Number Generator state. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_rng_per_thread">
<span class="target" id="nsphere_8c_1af433507ee400c9d9bcd4b617c2c84804"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_rng</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_rng_per_thread</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416g_rng_per_thread" title="Link to this definition"></a><br /></dt>
<dd><p>Array of GSL RNG states, one per OpenMP thread. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_max_omp_threads_for_rng">
<span class="target" id="nsphere_8c_1a0a4df77325009702c030ed07684f6293"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_max_omp_threads_for_rng</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv425g_max_omp_threads_for_rng" title="Link to this definition"></a><br /></dt>
<dd><p>Number of threads for which RNGs are allocated. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_sort_columns_buffer">
<span class="target" id="nsphere_8c_1ac09f4032c74dc2d9655c3463813e5917"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_sort_columns_buffer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv421g_sort_columns_buffer" title="Link to this definition"></a><br /></dt>
<dd><p>Global persistent buffer for particle data transposition during sorting. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_sort_columns_buffer_npts">
<span class="target" id="nsphere_8c_1ababf87c8f003f632fa0a44ec44b9f5ff"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sort_columns_buffer_npts</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_sort_columns_buffer_npts" title="Link to this definition"></a><br /></dt>
<dd><p>Number of particles the persistent buffer was allocated for; updated if npts changes. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_nfw_splinemass_for_force">
<span class="target" id="nsphere_8c_1a937102f6f1e52d0779a9c5bccf1515dd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_splinemass_for_force</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv426g_nfw_splinemass_for_force" title="Link to this definition"></a><br /></dt>
<dd><p>Global NFW mass spline for force calculations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv434g_nfw_enclosedmass_accel_for_force">
<span class="target" id="nsphere_8c_1a0fe5909f698cffd2135b7d59aac1fb2d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_enclosedmass_accel_for_force</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv434g_nfw_enclosedmass_accel_for_force" title="Link to this definition"></a><br /></dt>
<dd><p>Global NFW mass spline accelerator for force calculations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv430PARALLEL_SORT_DEFAULT_SECTIONS">
<span class="target" id="nsphere_8c_1a450ec57c21c7f482f7eeec7d631b48b9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_DEFAULT_SECTIONS</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span><a class="headerlink" href="#_CPPv430PARALLEL_SORT_DEFAULT_SECTIONS" title="Link to this definition"></a><br /></dt>
<dd><p>Default number of sections when OpenMP is unavailable or reports few threads. </p>
<p>Provides a baseline level of partitioning even in limited thread environments. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv433PARALLEL_SORT_SECTIONS_PER_THREAD">
<span class="target" id="nsphere_8c_1aaf5d4e71f8c1282ec7aba67fda14bc5c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_SECTIONS_PER_THREAD</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><a class="headerlink" href="#_CPPv433PARALLEL_SORT_SECTIONS_PER_THREAD" title="Link to this definition"></a><br /></dt>
<dd><p>Number of sort sections per OpenMP thread for workload distribution. </p>
<p>Multiplier used to determine total section count from available threads. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv429PARALLEL_SORT_OVERLAP_DIVISOR">
<span class="target" id="nsphere_8c_1a334eba1f65f9472e102be3d19d5a26ca"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_OVERLAP_DIVISOR</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span><a class="headerlink" href="#_CPPv429PARALLEL_SORT_OVERLAP_DIVISOR" title="Link to this definition"></a><br /></dt>
<dd><p>Divisor for calculating proportional overlap between sort sections. </p>
<p>Overlap is calculated as chunk_size / OVERLAP_DIVISOR to scale with data size. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv437PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP">
<span class="target" id="nsphere_8c_1aa88fd6b05f2f7010aed9a16a1deaa0b5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><a class="headerlink" href="#_CPPv437PARALLEL_SORT_MIN_CORRECTNESS_OVERLAP" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum required overlap between adjacent sort sections (in elements). </p>
<p>This ensures sufficient overlap for correct merging of sorted sections, even with sparse data distributions and when calculated proportional overlap would be too small. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv438PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD">
<span class="target" id="nsphere_8c_1ae86f18d529275ccb0f9833f71280ff39"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">128</span></span><a class="headerlink" href="#_CPPv438PARALLEL_SORT_MIN_CHUNK_SIZE_THRESHOLD" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum average chunk size threshold for parallel sort operation. </p>
<p>If the calculated size of each chunk (total elements / number of sections) falls below this threshold, the algorithm reverts to serial sorting to avoid overhead from managing very small parallel tasks. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_enable_logging">
<span class="target" id="nsphere_8c_1ae577daedc1b00c1bb2e11dba4f69a64c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_enable_logging</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_enable_logging" title="Link to this definition"></a><br /></dt>
<dd><p>Writes a formatted message to the log file with timestamp and severity level. </p>
<p>Enable logging to file (controlled by <code class="docutils literal notranslate"><span class="pre">--log</span></code> flag).</p>
<section id="nsphere_8c_1autotoc_md2_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md2_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md2">
<span id="nsphere_8c_1autotoc_md2_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md2" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md2">level : const char* Severity level (e.g., &quot;INFO&quot;, &quot;WARNING&quot;, &quot;ERROR&quot;). format : const char* Printf-style format string. ... : Variable arguments for the format string.</p>
</section>
</section>
<section id="nsphere_8c_1autotoc_md3_1s1">
<h3><a class="headerlink" href="#nsphere_8c_1autotoc_md3_1s1" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md3">
<span id="nsphere_8c_1autotoc_md3_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md3" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md3">None</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae577daedc1b00c1bb2e11dba4f69a64c"><span class="std std-ref">g_enable_logging</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Creates the &quot;log&quot; directory if it doesn't exist. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the log file cannot be opened. Logging only occurs if the global <code class="docutils literal notranslate"><span class="pre">g_enable_logging</span></code> flag is set. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49g_doDebug">
<span class="target" id="nsphere_8c_1a2763bb9f0f7f79afffeac48905e799fb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDebug</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv49g_doDebug" title="Link to this definition"></a><br /></dt>
<dd><p>Global simulation feature flags. </p>
<p>These control various optional behaviors and optimizations in the simulation. Each flag can be set via command line arguments. Enable detailed debug output (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410g_doDynPsi">
<span class="target" id="nsphere_8c_1ac14e6ad00493002d0af407252f07f3b1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDynPsi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv410g_doDynPsi" title="Link to this definition"></a><br /></dt>
<dd><p>Enable dynamic potential recalculation (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_doDynRank">
<span class="target" id="nsphere_8c_1a8b153c5c0087d5c9f2330cc7ada744e7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDynRank</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv411g_doDynRank" title="Link to this definition"></a><br /></dt>
<dd><p>Enable dynamic rank calculation per step (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419g_doAllParticleData">
<span class="target" id="nsphere_8c_1a90ac17f8099c6a91249c330a7a45dcb5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doAllParticleData</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv419g_doAllParticleData" title="Link to this definition"></a><br /></dt>
<dd><p>Save complete particle evolution history (default: on). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_doRestart">
<span class="target" id="nsphere_8c_1a74aece53e0af69f9a5537f139fa24f08"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doRestart</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411g_doRestart" title="Link to this definition"></a><br /></dt>
<dd><p>Enable simulation restart from checkpoint. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416skip_file_writes">
<span class="target" id="nsphere_8c_1acc92b9579ff43b04dd2277bf7d34dcdf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">skip_file_writes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416skip_file_writes" title="Link to this definition"></a><br /></dt>
<dd><p>Skip file writes during simulation restart. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424g_enable_sidm_scattering">
<span class="target" id="nsphere_8c_1a5212a272a63a7d445406d01f4a7376d6"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_enable_sidm_scattering</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv424g_enable_sidm_scattering" title="Link to this definition"></a><br /></dt>
<dd><p>Enable SIDM scattering physics (0=no, 1=yes). Default is OFF. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_sidm_execution_mode">
<span class="target" id="nsphere_8c_1a6792965561705eebe1e5f97a1bfd0a86"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_execution_mode</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv421g_sidm_execution_mode" title="Link to this definition"></a><br /></dt>
<dd><p>SIDM execution mode: 0 for serial, 1 for parallel (default). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_total_sidm_scatters">
<span class="target" id="nsphere_8c_1a6bf53edac8201b0f8eecf672e4071708"></span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_total_sidm_scatters</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv421g_total_sidm_scatters" title="Link to this definition"></a><br /></dt>
<dd><p>Global counter for total SIDM scatters. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv412g_sidm_kappa">
<span class="target" id="nsphere_8c_1ac86d3c67825f309cc2f48ef58f382818"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_kappa</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">50.0</span></span><a class="headerlink" href="#_CPPv412g_sidm_kappa" title="Link to this definition"></a><br /></dt>
<dd><p>SIDM opacity kappa (cm^2/g), default 50.0. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_sidm_kappa_provided">
<span class="target" id="nsphere_8c_1ae813c76b7cb1023356f7247f29a0362a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_kappa_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv421g_sidm_kappa_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--sidm-kappa</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424g_particle_scatter_state">
<span class="target" id="nsphere_8c_1a3c25f840da5e06f5e5055201eb94ce2e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_particle_scatter_state</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv424g_particle_scatter_state" title="Link to this definition"></a><br /></dt>
<dd><p>Tracks recent scatter history for Adams-Bashforth integrator state reset. Indexed by original particle ID. 0=normal AB, 1=just scattered (use AB1-like step), 2=one step after scatter (use AB2-like step). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_master_seed">
<span class="target" id="nsphere_8c_1a70f7730991da1fabb7c1e30e6c0dd496"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_master_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv413g_master_seed" title="Link to this definition"></a><br /></dt>
<dd><p>Master seed for the simulation, if provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419g_initial_cond_seed">
<span class="target" id="nsphere_8c_1a1499d38fe15c1ecf99e32837e8a32f84"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_initial_cond_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv419g_initial_cond_seed" title="Link to this definition"></a><br /></dt>
<dd><p>Seed used for generating initial conditions. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_sidm_seed">
<span class="target" id="nsphere_8c_1ad46cd695e6fd724a1274e9fdc41749ed"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">unsigned</span></span><span class="w"> </span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_seed</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411g_sidm_seed" title="Link to this definition"></a><br /></dt>
<dd><p>Seed used for SIDM calculations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_master_seed_provided">
<span class="target" id="nsphere_8c_1a4627e5cc97bd5b5041c6b778fb02c0b8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_master_seed_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv422g_master_seed_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--master-seed</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv428g_initial_cond_seed_provided">
<span class="target" id="nsphere_8c_1a90d748c2e2325d6ba2fea5e7a8df5c52"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_initial_cond_seed_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv428g_initial_cond_seed_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--init-cond-seed</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_sidm_seed_provided">
<span class="target" id="nsphere_8c_1ae77376af82313bcbdaa40bc29b66aa10"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_seed_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420g_sidm_seed_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--sidm-seed</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_attempt_load_seeds">
<span class="target" id="nsphere_8c_1abc5cb3a638545879af6d8a83cc2c6cf6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_attempt_load_seeds</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420g_attempt_load_seeds" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if we should try to load seeds from files if not provided. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv433g_initial_cond_seed_filename_base">
<span class="target" id="nsphere_8c_1abe62d0a2187049fff62f6a02288b1f5d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_initial_cond_seed_filename_base</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;data/last_initial_seed&quot;</span></span><a class="headerlink" href="#_CPPv433g_initial_cond_seed_filename_base" title="Link to this definition"></a><br /></dt>
<dd><p>Base name for IC seed file. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_sidm_seed_filename_base">
<span class="target" id="nsphere_8c_1ab08b4cd0c2b769f2d8615217b00988f4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_sidm_seed_filename_base</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;data/last_sidm_seed&quot;</span></span><a class="headerlink" href="#_CPPv425g_sidm_seed_filename_base" title="Link to this definition"></a><br /></dt>
<dd><p>Base name for SIDM seed file. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_use_nfw_profile">
<span class="target" id="nsphere_8c_1acf4619905747dd78be38c192c1cce1b0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_use_nfw_profile</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv417g_use_nfw_profile" title="Link to this definition"></a><br /></dt>
<dd><p>Flag to use NFW-like profile for ICs: 0 = Cored (default), 1 = NFW. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_nfw_profile_rc">
<span class="target" id="nsphere_8c_1aec9b994de512d155a4540635c15babd0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_rc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">RC_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv416g_nfw_profile_rc" title="Link to this definition"></a><br /></dt>
<dd><p>NFW-specific scale radius (kpc); set by <code class="docutils literal notranslate"><span class="pre">--scale-radius</span></code> if NFW active, else defaults to RC_NFW_DEFAULT. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423g_nfw_profile_halo_mass">
<span class="target" id="nsphere_8c_1aa358b93a9aeec3bf673da8095ab52403"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_halo_mass</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS_NFW</span></span><a class="headerlink" href="#_CPPv423g_nfw_profile_halo_mass" title="Link to this definition"></a><br /></dt>
<dd><p>NFW-specific halo mass (Msun); set by <code class="docutils literal notranslate"><span class="pre">--halo-mass</span></code> if NFW active, else defaults to HALO_MASS_NFW. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv430g_nfw_profile_rmax_norm_factor">
<span class="target" id="nsphere_8c_1a0837cffbd86824eb91cd573d8e5a72e6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_rmax_norm_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUTOFF_FACTOR_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv430g_nfw_profile_rmax_norm_factor" title="Link to this definition"></a><br /></dt>
<dd><p>NFW-specific r_max factor for IC norm/grid; set by <code class="docutils literal notranslate"><span class="pre">--cutoff-factor</span></code> if NFW active, else defaults to CUTOFF_FACTOR_NFW_DEFAULT. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv428g_nfw_profile_falloff_factor">
<span class="target" id="nsphere_8c_1a18f7fcd78e311127476cf0c2c2ce0e2a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_nfw_profile_falloff_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv428g_nfw_profile_falloff_factor" title="Link to this definition"></a><br /></dt>
<dd><p>NFW-specific falloff transition C factor; set by <code class="docutils literal notranslate"><span class="pre">--falloff-factor</span></code> if NFW active, else defaults to FALLOFF_FACTOR_NFW_DEFAULT. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420g_scale_radius_param">
<span class="target" id="nsphere_8c_1a3f2c2ee1f35f78ab4532e82d47dc7c31"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_scale_radius_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">RC</span></span><a class="headerlink" href="#_CPPv420g_scale_radius_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized scale radius (kpc), defaults to RC macro. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417g_halo_mass_param">
<span class="target" id="nsphere_8c_1a8d239e4b6b0c636620a61d6a2bd1800c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_halo_mass_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS</span></span><a class="headerlink" href="#_CPPv417g_halo_mass_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized halo mass (Msun), defaults to HALO_MASS macro. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv421g_cutoff_factor_param">
<span class="target" id="nsphere_8c_1ace43f213d0ce41c62f15b9054e4e4487"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cutoff_factor_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></span><a class="headerlink" href="#_CPPv421g_cutoff_factor_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized rmax factor, defaults to Cored's default. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_profile_type_str">
<span class="target" id="nsphere_8c_1a4f5fe613774e06dfd7674bdfafb5f0c3"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_profile_type_str</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">16</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;nfw&quot;</span></span><a class="headerlink" href="#_CPPv418g_profile_type_str" title="Link to this definition"></a><br /></dt>
<dd><p>Profile type string (&quot;nfw&quot; or &quot;cored&quot;), default &quot;nfw&quot;. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv429g_scale_radius_param_provided">
<span class="target" id="nsphere_8c_1ad54ba634a2f778c54de975e96c0b82f0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_scale_radius_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv429g_scale_radius_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--scale-radius</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv426g_halo_mass_param_provided">
<span class="target" id="nsphere_8c_1a5d7e61dee00c23721502c57139eb7527"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_halo_mass_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv426g_halo_mass_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--halo-mass</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv430g_cutoff_factor_param_provided">
<span class="target" id="nsphere_8c_1aa50274fc26ef6d1a63110f32b4336e7c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cutoff_factor_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv430g_cutoff_factor_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--cutoff-factor</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv422g_falloff_factor_param">
<span class="target" id="nsphere_8c_1a51e4192c713318eedeb97bb1a0f42e6e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_falloff_factor_param</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">FALLOFF_FACTOR_NFW_DEFAULT</span></span><a class="headerlink" href="#_CPPv422g_falloff_factor_param" title="Link to this definition"></a><br /></dt>
<dd><p>Generalized falloff factor, defaults to NFW's default. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv431g_falloff_factor_param_provided">
<span class="target" id="nsphere_8c_1ae763f1806ffe602bf10277c4442f732a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_falloff_factor_param_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv431g_falloff_factor_param_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--falloff-factor</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv427g_profile_type_str_provided">
<span class="target" id="nsphere_8c_1ab9481936f94c3926eaf57f060ccf6080"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_profile_type_str_provided</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv427g_profile_type_str_provided" title="Link to this definition"></a><br /></dt>
<dd><p>Flag: 1 if <code class="docutils literal notranslate"><span class="pre">--profile</span></code> was given by the user. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_cored_profile_rc">
<span class="target" id="nsphere_8c_1a4b496196531b3475aa03188149b89f19"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cored_profile_rc</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">RC</span></span><a class="headerlink" href="#_CPPv418g_cored_profile_rc" title="Link to this definition"></a><br /></dt>
<dd><p>Cored-profile-specific scale radius (kpc); set by <code class="docutils literal notranslate"><span class="pre">--scale-radius</span></code> if Cored active, else defaults to RC macro. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv425g_cored_profile_halo_mass">
<span class="target" id="nsphere_8c_1a392716ce8f5733c1325e0a979a85c12a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cored_profile_halo_mass</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS</span></span><a class="headerlink" href="#_CPPv425g_cored_profile_halo_mass" title="Link to this definition"></a><br /></dt>
<dd><p>Cored-profile-specific halo mass (Msun); set by <code class="docutils literal notranslate"><span class="pre">--halo-mass</span></code> if Cored active, else defaults to HALO_MASS macro. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv427g_cored_profile_rmax_factor">
<span class="target" id="nsphere_8c_1a8ba477b9aa943c64fb2426284cabe7fb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_cored_profile_rmax_factor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">CUTOFF_FACTOR_CORED_DEFAULT</span></span><a class="headerlink" href="#_CPPv427g_cored_profile_rmax_factor" title="Link to this definition"></a><br /></dt>
<dd><p>Cored-profile-specific r_max factor for IC norm/grid; set by <code class="docutils literal notranslate"><span class="pre">--cutoff-factor</span></code> if Cored active, else defaults to CUTOFF_FACTOR_CORED_DEFAULT. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424debug_direct_convolution">
<span class="target" id="nsphere_8c_1a4a1f369af4feb2852a5bddbace1948b9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">debug_direct_convolution</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv424debug_direct_convolution" title="Link to this definition"></a><br /></dt>
<dd><p>Convolution method selection for density smoothing. </p>
<p>Controls the convolution method selection for density smoothing.</p>
<p>0 = FFT-based convolution (default, faster for large datasets). 1 = Direct spatial convolution (more accurate but slower).</p>
<p>Global flag that determines whether to use direct convolution (1) or FFT-based convolution (0). Direct convolution is more accurate but slower for large grids, while FFT-based convolution is faster but may introduce artifacts.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External declaration, defined elsewhere. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418g_active_halo_mass">
<span class="target" id="nsphere_8c_1acf0dc082ece5bafee76cb9ea1b3b8933"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_active_halo_mass</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">HALO_MASS</span></span><a class="headerlink" href="#_CPPv418g_active_halo_mass" title="Link to this definition"></a><br /></dt>
<dd><p>Active halo mass for N-body force calculations. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423use_closest_to_Lcompare">
<span class="target" id="nsphere_8c_1aac9606b439f76709f7fe911236c020c0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_closest_to_Lcompare</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv423use_closest_to_Lcompare" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum selection configuration for particle filtering. </p>
<p>Mode 0: Select particles with the 5 lowest L values. Mode 1: Select particles with L values closest to Lcompare. Mode selector (0 or 1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48Lcompare">
<span class="target" id="nsphere_8c_1acf387feb573420c5639256a2e7485a52"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Lcompare</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.05</span></span><a class="headerlink" href="#_CPPv48Lcompare" title="Link to this definition"></a><br /></dt>
<dd><p>Reference L value for closest-match mode (Mode 1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418Rank_partdata_snap">
<span class="target" id="nsphere_8c_1a4114fc7f42bb6b1fc93edb9833bcb6ce"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Rank_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv418Rank_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Global particle data arrays for snapshot processing. </p>
<p>Particle rank (sorted position) data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415R_partdata_snap">
<span class="target" id="nsphere_8c_1a310bb3684fede6f13355b46e3940116f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">R_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415R_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Radial position data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418Vrad_partdata_snap">
<span class="target" id="nsphere_8c_1aa3a563971e30d251652519c4cb948b4b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Vrad_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv418Vrad_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Radial velocity data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415L_partdata_snap">
<span class="target" id="nsphere_8c_1ad4dd74edba84fea4874fa24d76d1911d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">L_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415L_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47L_block">
<span class="target" id="nsphere_8c_1ae2cf810c54ba0f579886bc7fa34e2a80"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">L_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47L_block" title="Link to this definition"></a><br /></dt>
<dd><p>Global arrays for particle data processing (block storage). </p>
<p>Angular momentum block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410Rank_block">
<span class="target" id="nsphere_8c_1aaead4d7d454a66bd595ee20411721b3a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Rank_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410Rank_block" title="Link to this definition"></a><br /></dt>
<dd><p>Particle rank (sorted position) block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47R_block">
<span class="target" id="nsphere_8c_1aac6f0b01f5fd9b6ae62ff0dcee03df09"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">R_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47R_block" title="Link to this definition"></a><br /></dt>
<dd><p>Radial position block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410Vrad_block">
<span class="target" id="nsphere_8c_1ac2d702a2edcaf84b4f5ad4195e676b5d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Vrad_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410Vrad_block" title="Link to this definition"></a><br /></dt>
<dd><p>Radial velocity block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47nlowest">
<span class="target" id="nsphere_8c_1ae89d6fccec017254c845f6c6e6e78d3b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nlowest</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5</span></span><a class="headerlink" href="#_CPPv47nlowest" title="Link to this definition"></a><br /></dt>
<dd><p>Variables for tracking low angular momentum particles. </p>
<p>Number of lowest angular momentum particles to track. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv46chosen">
<span class="target" id="nsphere_8c_1a01d2e68fbc1f506be8cc06e896b620e0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">chosen</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv46chosen" title="Link to this definition"></a><br /></dt>
<dd><p>Array of indices (original IDs) for selected low-L particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49lowestL_r">
<span class="target" id="nsphere_8c_1aef51927bdcad0e918d125ade409c9135"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">lowestL_r</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49lowestL_r" title="Link to this definition"></a><br /></dt>
<dd><p>Radial positions of tracked low-L particles over time [particle][time_step]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49lowestL_E">
<span class="target" id="nsphere_8c_1a0365bb5a431c80f22090421f87ae2b6d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">lowestL_E</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49lowestL_E" title="Link to this definition"></a><br /></dt>
<dd><p>Energy values of tracked low-L particles over time [particle][time_step]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49lowestL_L">
<span class="target" id="nsphere_8c_1aeb007f684444f9ecf355459c3516fec8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">lowestL_L</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49lowestL_L" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momenta of tracked low-L particles over time [particle][time_step]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420use_identity_gravity">
<span class="target" id="nsphere_8c_1a6936a69fecabe2fdcb93993ef527ba44"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_identity_gravity</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420use_identity_gravity" title="Link to this definition"></a><br /></dt>
<dd><p>Gravitational force calculation control flag. </p>
<p>Used for testing and debugging orbital dynamics:<ul class="simple">
<li><p>0 = Normal gravitational force calculation (default).</p></li>
<li><p>1 = Zero gravity (particles move in straight lines).</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting this to 1 is useful for validating the integration scheme independent of gravitational physics. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411dbg_approxE">
<span class="target" id="nsphere_8c_1a5bb6373db7244f6d2891a3221d366785"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_approxE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv411dbg_approxE" title="Link to this definition"></a><br /></dt>
<dd><p>Arrays for tracking energy components through simulation for debugging. </p>
<p>Theoretical model energy (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_dynE">
<span class="target" id="nsphere_8c_1ac9cbd2043d21d1cc89ff1fc00d2a1460"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_dynE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_dynE" title="Link to this definition"></a><br /></dt>
<dd><p>Actual dynamical energy (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_kinE">
<span class="target" id="nsphere_8c_1a88f1da0ce13577814bbeb1e1fc08feb4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_kinE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_kinE" title="Link to this definition"></a><br /></dt>
<dd><p>Kinetic energy component (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_potE">
<span class="target" id="nsphere_8c_1a05fb53ef0323425e63e369bb5bf02d37"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_potE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_potE" title="Link to this definition"></a><br /></dt>
<dd><p>Potential energy component (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_time">
<span class="target" id="nsphere_8c_1a5b8302c505609113d15735532f252bb5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_time</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_time" title="Link to this definition"></a><br /></dt>
<dd><p>Simulation time at each snapshot (Myr). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410dbg_radius">
<span class="target" id="nsphere_8c_1a3aa1bbdbd292c666a49c2c0414639c3a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_radius</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv410dbg_radius" title="Link to this definition"></a><br /></dt>
<dd><p>Particle radius at each snapshot (kpc). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49dbg_count">
<span class="target" id="nsphere_8c_1aa7285a020bc6f18e415d9537d2cdcfbe"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv49dbg_count" title="Link to this definition"></a><br /></dt>
<dd><p>Number of debug snapshots recorded. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413normalization">
<span class="target" id="nsphere_8c_1af30d254aedaf222a8f93118afc67a556"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">normalization</span></span></span><a class="headerlink" href="#_CPPv413normalization" title="Link to this definition"></a><br /></dt>
<dd><p>Mass normalization factor for energy calculations. Calculated based on the integral of the density profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410doReadInit">
<span class="target" id="nsphere_8c_1a65de5bd03df8f31858db0a013fac2455"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doReadInit</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv410doReadInit" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating whether to read initial conditions from file (1=yes, 0=no). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411doWriteInit">
<span class="target" id="nsphere_8c_1ad09412fe58e3233624b7877a2cb392fd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doWriteInit</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411doWriteInit" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating whether to write initial conditions to file (1=yes, 0=no). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416readInitFilename">
<span class="target" id="nsphere_8c_1a1a5e6187e6eed2330e7c5c2b12ed2104"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">readInitFilename</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416readInitFilename" title="Link to this definition"></a><br /></dt>
<dd><p>Filename to read initial conditions from (if doReadInit=1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417writeInitFilename">
<span class="target" id="nsphere_8c_1a83025b3961bbc4fee6db755755cd892c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">writeInitFilename</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv417writeInitFilename" title="Link to this definition"></a><br /></dt>
<dd><p>Filename to write initial conditions to (if doWriteInit=1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_defaultSortAlg">
<span class="target" id="nsphere_8c_1a6941efb3580a570bda2e5720545c0293"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_defaultSortAlg</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;quadsort_parallel&quot;</span></span><a class="headerlink" href="#_CPPv416g_defaultSortAlg" title="Link to this definition"></a><br /></dt>
<dd><p>&lt; Default sorting algorithm identifier string. Set based on command-line options. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv411threevector">
<span class="target" id="structthreevector"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">threevector</span></span></span><a class="headerlink" href="#_CPPv411threevector" title="Link to this definition"></a><br /></dt>
<dd><p>Three-dimensional vector structure for particle physics calculations. </p>
<p>Represents velocity and position vectors in 3D space for self-interacting dark matter simulations. Components are stored in Cartesian coordinates. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11threevector1xE">
<span class="target" id="structthreevector_1ae10f3b0baf38750c51085e860f59c470"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><a class="headerlink" href="#_CPPv4N11threevector1xE" title="Link to this definition"></a><br /></dt>
<dd><p>x-component of the vector. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11threevector1yE">
<span class="target" id="structthreevector_1acd143be9d252b1c65cdec417ce21e6b1"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">y</span></span></span><a class="headerlink" href="#_CPPv4N11threevector1yE" title="Link to this definition"></a><br /></dt>
<dd><p>y-component of the vector. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N11threevector1zE">
<span class="target" id="structthreevector_1ac9effd86f9ab947dfeceddcf1ab34c5a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">z</span></span></span><a class="headerlink" href="#_CPPv4N11threevector1zE" title="Link to this definition"></a><br /></dt>
<dd><p>z-component of the vector. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv412ScatterEvent">
<span class="target" id="struct_scatter_event"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ScatterEvent</span></span></span><a class="headerlink" href="#_CPPv412ScatterEvent" title="Link to this definition"></a><br /></dt>
<dd><p>Container for self-interacting dark matter scattering event data. </p>
<p>Stores particle indices and final velocity vectors for a single scattering interaction. Used to buffer scattering results before applying velocity updates, particularly useful for parallel implementations where race conditions must be avoided. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12ScatterEvent1iE">
<span class="target" id="struct_scatter_event_1ae1c976855437fd1cc2cb4569030040cb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">i</span></span></span><a class="headerlink" href="#_CPPv4N12ScatterEvent1iE" title="Link to this definition"></a><br /></dt>
<dd><p>Index of the first particle in the scattering pair. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12ScatterEvent8m_offsetE">
<span class="target" id="struct_scatter_event_1a13a3144ee25379b9f6f50457bd4e8f3d"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">m_offset</span></span></span><a class="headerlink" href="#_CPPv4N12ScatterEvent8m_offsetE" title="Link to this definition"></a><br /></dt>
<dd><p>Offset of the scattering partner relative to particle i (e.g., partner is i + m_offset). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12ScatterEvent7VifinalE">
<span class="target" id="struct_scatter_event_1a8d8033fbeaf5a96c373f476e8bca0486"></span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vifinal</span></span></span><a class="headerlink" href="#_CPPv4N12ScatterEvent7VifinalE" title="Link to this definition"></a><br /></dt>
<dd><p>Final 3D velocity vector of particle i. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N12ScatterEvent7VmfinalE">
<span class="target" id="struct_scatter_event_1ab657bc6c46175f4eefa546b9cd6b9e29"></span><a class="reference internal" href="#_CPPv411threevector" title="threevector"><span class="n"><span class="pre">threevector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vmfinal</span></span></span><a class="headerlink" href="#_CPPv4N12ScatterEvent7VmfinalE" title="Link to this definition"></a><br /></dt>
<dd><p>Final 3D velocity vector of the partner particle. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv425fE_integrand_params_NFW_t">
<span class="target" id="structf_e__integrand__params___n_f_w__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fE_integrand_params_NFW_t</span></span></span><a class="headerlink" href="#_CPPv425fE_integrand_params_NFW_t" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for the NFW distribution function integrand fEintegrand_nfw. </p>
<p>This structure passes all necessary data, including pre-computed splines for r(Psi) and M(r), physical constants, and profile-specific parameters, to the GSL integration routine for calculating I(E). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t15E_current_shellE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ac2837b6f19585e32fc8f14cf121e731e"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E_current_shell</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t15E_current_shellE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy E of the current shell for which I(E) is being computed. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t15spline_r_of_PsiE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ae4aea3ff3e49702e09630e9921192c04"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spline_r_of_Psi</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t15spline_r_of_PsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Spline for r(-Psi_true), i.e., radius as a function of negated true potential. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t14accel_r_of_PsiE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ad4d7e509dc5b98423646bcaa56c8f02e"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">accel_r_of_Psi</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t14accel_r_of_PsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for the r(-Psi_true) spline. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t13spline_M_of_rE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1abc3c2fe5222329edeaf1d00372309abb"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">spline_M_of_r</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t13spline_M_of_rE" title="Link to this definition"></a><br /></dt>
<dd><p>Spline for M(r), enclosed mass as a function of radius. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t12accel_M_of_rE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a73b425e7059c36c1053259338016c05e"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">accel_M_of_r</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t12accel_M_of_rE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for the M(r) spline. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t17const_G_universalE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a1653e9f5d38710b6651d774a1e1738f0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">const_G_universal</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t17const_G_universalE" title="Link to this definition"></a><br /></dt>
<dd><p>Universal gravitational constant G. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t16profile_rc_constE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a5d8ca195751221764d81af08b2f5de62"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">profile_rc_const</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t16profile_rc_constE" title="Link to this definition"></a><br /></dt>
<dd><p>Scale radius (rc) of the NFW profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t21profile_nt_norm_constE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1afa1031bd4f6fa8f6bfd8a9e04b9b3a9f"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">profile_nt_norm_const</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t21profile_nt_norm_constE" title="Link to this definition"></a><br /></dt>
<dd><p>Density normalization constant (nt_nfw) for the NFW profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t23profile_falloff_C_constE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1ab43a143997cc8101756ff4c2c000d169"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">profile_falloff_C_const</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t23profile_falloff_C_constE" title="Link to this definition"></a><br /></dt>
<dd><p>Falloff transition factor C for power-law cutoff in NFW profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t13Psimin_globalE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1adbc535d243213e6d99975f97fb82361d"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimin_global</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimin_globalE" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum potential value for physical range validation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25fE_integrand_params_NFW_t13Psimax_globalE">
<span class="target" id="structf_e__integrand__params___n_f_w__t_1a8292eb84ef05b670c509e3576f1c06e6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psimax_global</span></span></span><a class="headerlink" href="#_CPPv4N25fE_integrand_params_NFW_t13Psimax_globalE" title="Link to this definition"></a><br /></dt>
<dd><p>Maximum potential value for physical range validation. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv418fEintegrand_params">
<span class="target" id="structf_eintegrand__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand_params</span></span></span><a class="headerlink" href="#_CPPv418fEintegrand_params" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for energy integration calculations. </p>
<p>Used as <code class="docutils literal notranslate"><span class="pre">void*</span> <span class="pre">params</span></code> argument in GSL integration routines, specifically for distribution function calculations (<code class="docutils literal notranslate"><span class="pre">fEintegrand</span></code>). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params1EE">
<span class="target" id="structf_eintegrand__params_1a8148bf8c4b22bbfd93f59103abc163d6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params1EE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy value (relative energy). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params9splinePsiE">
<span class="target" id="structf_eintegrand__params_1ac2b33746e579217236e1dd75c998c7f2"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">splinePsi</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params9splinePsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolation spline for potential Psi(r). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params10splinemassE">
<span class="target" id="structf_eintegrand__params_1a08bb5a8a8de6922b3e77425fb03266c9"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">splinemass</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params10splinemassE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolation spline for enclosed mass M(r). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params11rofPsiarrayE">
<span class="target" id="structf_eintegrand__params_1a1760a14a28a84477a7a3444759efc592"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">rofPsiarray</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params11rofPsiarrayE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for radius lookup from potential r(Psi). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params9massarrayE">
<span class="target" id="structf_eintegrand__params_1a45ce775bb086d45e113c2c7106884ace"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">massarray</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params9massarrayE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for mass lookups M(r). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv419Psiintegrand_params">
<span class="target" id="struct_psiintegrand__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psiintegrand_params</span></span></span><a class="headerlink" href="#_CPPv419Psiintegrand_params" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for Psiintegrand to support profile-specific mass integrands. </p>
<p>Allows Psiintegrand to call the appropriate mass integrand function based on the selected density profile. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19Psiintegrand_params18massintegrand_funcE">
<span class="target" id="struct_psiintegrand__params_1a08f79ebbb4f859151c641942bee01199"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand_func</span></span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><a class="headerlink" href="#_CPPv4N19Psiintegrand_params18massintegrand_funcE" title="Link to this definition"></a><br /></dt>
<dd><p>Function pointer to profile-specific mass integrand. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19Psiintegrand_params24params_for_massintegrandE">
<span class="target" id="struct_psiintegrand__params_1a7129aef313bd4f27e37445aeca27bba3"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">params_for_massintegrand</span></span></span><a class="headerlink" href="#_CPPv4N19Psiintegrand_params24params_for_massintegrandE" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for the mass integrand function. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49LAndIndex">
<span class="target" id="struct_l_and_index"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LAndIndex</span></span></span><a class="headerlink" href="#_CPPv49LAndIndex" title="Link to this definition"></a><br /></dt>
<dd><p>Structure to track angular momentum with particle index and direction. </p>
<p>Used in sorting and selection of particles by angular momentum, especially when finding particles closest to a reference L. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex1LE">
<span class="target" id="struct_l_and_index_1a60d9f7a202ef0503d1115c40b58709da"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex1LE" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum value (or squared difference from Lcompare). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex3idxE">
<span class="target" id="struct_l_and_index_1a6138ce671f1ee01ee02e5a498daefddf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex3idxE" title="Link to this definition"></a><br /></dt>
<dd><p>Original particle index (before sorting by L). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex4signE">
<span class="target" id="struct_l_and_index_1a9ca1d244ef4fbe305a2abc2ee9b85f72"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sign</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex4signE" title="Link to this definition"></a><br /></dt>
<dd><p>Direction indicator (+1 or -1) or sign of (L - Lcompare). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv48PartData">
<span class="target" id="struct_part_data"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PartData</span></span></span><a class="headerlink" href="#_CPPv48PartData" title="Link to this definition"></a><br /></dt>
<dd><p>Compact data structure for particle properties used in sorting and analysis. </p>
<p>Contains essential physical properties (radial position, velocity, angular momentum) and tracking metadata (rank, original index) for each particle in the simulation. Used extensively for sorting, file I/O, and data analysis operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses compact <code class="docutils literal notranslate"><span class="pre">float</span></code> types for physical quantities to reduce memory usage when processing large particle counts. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rank</span></code> field is assigned during radial sorting, while <code class="docutils literal notranslate"><span class="pre">original_index</span></code> preserves the initial array position for tracking particles across snapshots. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData4rankE">
<span class="target" id="struct_part_data_1aceb7fe5a7c0942f79e068ce54ee91dcd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rank</span></span></span><a class="headerlink" href="#_CPPv4N8PartData4rankE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData3radE">
<span class="target" id="struct_part_data_1a378b215a66fde62b868dbaa582b7e0e2"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad</span></span></span><a class="headerlink" href="#_CPPv4N8PartData3radE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData4vradE">
<span class="target" id="struct_part_data_1a9fb91714a8d216cfa0bc8527bc2d24c7"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrad</span></span></span><a class="headerlink" href="#_CPPv4N8PartData4vradE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData6angmomE">
<span class="target" id="struct_part_data_1a19c621246e1220d18589f0fc3405bc80"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">angmom</span></span></span><a class="headerlink" href="#_CPPv4N8PartData6angmomE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData14original_indexE">
<span class="target" id="struct_part_data_1a03b0004349d68fcc4cf0fa32dace0d98"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">original_index</span></span></span><a class="headerlink" href="#_CPPv4N8PartData14original_indexE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49RrPsiPair">
<span class="target" id="struct_rr_psi_pair"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RrPsiPair</span></span></span><a class="headerlink" href="#_CPPv49RrPsiPair" title="Link to this definition"></a><br /></dt>
<dd><p>Main entry point for the n-sphere dark matter simulation program. </p>
<p>Orchestrates the overall simulation workflow:<ol class="loweralpha simple">
<li><p>Parses command-line arguments using a flexible option system</p></li>
<li><p>Sets up initial conditions (particle distribution, system parameters)</p></li>
<li><p>Executes the selected integration method for trajectory evolution</p></li>
<li><p>Outputs data products (particle states, phase diagrams, energy tracking)</p></li>
<li><p>Handles restart/resume functionality when requested</p></li>
</ol>
</p>
<section id="struct_rr_psi_pair_1autotoc_md56_1s1">
<h3><a class="headerlink" href="#struct_rr_psi_pair_1autotoc_md56_1s1" title="Link to this heading"></a></h3>
<section id="struct_rr_psi_pair_1autotoc_md56">
<span id="struct_rr_psi_pair_1autotoc_md56_1s1"></span><h4>Parameters<a class="headerlink" href="#struct_rr_psi_pair_1autotoc_md56" title="Link to this heading"></a></h4>
<p id="struct_rr_psi_pair_1autotoc_md56">argc : int Standard argument count from the command line. argv : char** Standard array of argument strings from the command line.</p>
</section>
</section>
<section id="struct_rr_psi_pair_1autotoc_md57_1s1">
<h3><a class="headerlink" href="#struct_rr_psi_pair_1autotoc_md57_1s1" title="Link to this heading"></a></h3>
<section id="struct_rr_psi_pair_1autotoc_md57">
<span id="struct_rr_psi_pair_1autotoc_md57_1s1"></span><h4>Returns<a class="headerlink" href="#struct_rr_psi_pair_1autotoc_md57" title="Link to this heading"></a></h4>
<p id="struct_rr_psi_pair_1autotoc_md57">int Exit code: 0 for successful execution, non-zero for errors.</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a highly parallelized application that takes advantage of OpenMP when available. Performance scales with the number of available cores. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Some simulation configurations can be very memory-intensive. For large particle counts (&gt;10^6), ensure sufficient RAM is available. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9RrPsiPair2rrE">
<span class="target" id="struct_rr_psi_pair_1ab8518b2772c88f6bafef91f3d8b1bdf8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rr</span></span></span><a class="headerlink" href="#_CPPv4N9RrPsiPair2rrE" title="Link to this definition"></a><br /></dt>
<dd><p>Radius value or x-axis value for sorting. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9RrPsiPair3psiE">
<span class="target" id="struct_rr_psi_pair_1aee931f7363bc481421578669c2d5663c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">psi</span></span></span><a class="headerlink" href="#_CPPv4N9RrPsiPair3psiE" title="Link to this definition"></a><br /></dt>
<dd><p>Corresponding potential value or y-axis value. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="nsphere-sort-nsphere-sort-h">
<h2>NSphere Sort (<cite>nsphere_sort.h</cite>)<a class="headerlink" href="#nsphere-sort-nsphere-sort-h" title="Link to this heading"></a></h2>
<p>Clean wrapper for quadsort to suppress warnings and add support for doubles. </p>
<p>This header provides a clean interface to quadsort by:<ol class="arabic simple">
<li><p>Containing all warnings through pragma directives</p></li>
<li><p>Adding support for double and long double types</p></li>
<li><p>Keeping the original quadsort implementation pristine</p></li>
</ol>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This wrapper is specifically designed for the NSphere simulation system to ensure consistent sorting behavior across all numerical types. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_array">
<span class="target" id="nsphere__sort_8h_1a3db7cbccd3725443ff37873bc5e9aa70"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_array</span></span></span><a class="headerlink" href="#c.ns_sort_array" title="Link to this definition"></a><br /></dt>
<dd><p>Restore warning settings to their previous state. </p>
<p>Pops the diagnostic pragma stack to restore compiler warning settings that were modified earlier in this header.</p>
<p>Define clean aliases to quadsort functions with zero overhead</p>
<p>These macros provide a consistent naming convention for sorting functions in the NSphere codebase, making it clear which functions are part of the NSphere API rather than direct quadsort calls. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_prim">
<span class="target" id="nsphere__sort_8h_1aaef0e0b6d9656a716d4cbae7855d445b"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_prim</span></span></span><a class="headerlink" href="#c.ns_sort_prim" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_size">
<span class="target" id="nsphere__sort_8h_1afeb553496649ee2b0aebd6068a386c61"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_size</span></span></span><a class="headerlink" href="#c.ns_sort_size" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_extended">
<span class="target" id="nsphere__sort_8h_1a28e85ab689573d5651876f06a1f63b58"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_extended</span></span></span><a class="headerlink" href="#c.ns_sort_extended" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420ns_quadsort_extendedPv6size_t6size_tP7CMPFUNC">
<span class="target" id="nsphere__sort_8h_1a9e16bdd3460662f1127056b02a6a30dd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ns_quadsort_extended</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv47CMPFUNC" title="CMPFUNC"><span class="n"><span class="pre">CMPFUNC</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420ns_quadsort_extendedPv6size_t6size_tP7CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd><p>Push current warning state and disable specific warnings. </p>
<p>These pragma directives are used to suppress compiler warnings that would otherwise be generated by the quadsort implementation. This allows us to use the original quadsort code without modification.</p>
<p>Include the original quadsort header with warnings suppressed</p>
<p>The GCC/Clang warning suppression includes &quot;-Wmacro-redefined&quot; to allow quadsort.h to define QUAD_CACHE even though it may be defined via compiler flags. This approach preserves dynamic cache sizing from Makefiles while allowing direct inclusion in other contexts.</p>
<p>NSphere extensions to quadsort - Support for double and long double types</p>
<p>These extensions add specialized sorting implementations for floating-point types that may not be efficiently handled by the standard quadsort. They are conditionally compiled based on compiler support.</p>
<p>Extended quadsort function with support for double and long double types</p>
<p>This function extends the standard quadsort implementation to handle double and long double types with specialized implementations. For other types, it falls back to the standard quadsort. This provides optimal performance for all data types used in the NSphere simulation system.</p>
<section id="nsphere__sort_8h_1autotoc_md59_1s1">
<h3><a class="headerlink" href="#nsphere__sort_8h_1autotoc_md59_1s1" title="Link to this heading"></a></h3>
<section id="nsphere__sort_8h_1autotoc_md59">
<span id="nsphere__sort_8h_1autotoc_md59_1s1"></span><h4>Parameters<a class="headerlink" href="#nsphere__sort_8h_1autotoc_md59" title="Link to this heading"></a></h4>
<p id="nsphere__sort_8h_1autotoc_md59">array : void* Pointer to the array to be sorted. nmemb : size_t Number of elements in the array. size : size_t Size of each element in bytes. cmp : CMPFUNC* Pointer to comparison function that returns negative, zero, or positive if first argument is less than, equal to, or greater than the second.</p>
</section>
</section>
<section id="nsphere__sort_8h_1autotoc_md60_1s1">
<h3><a class="headerlink" href="#nsphere__sort_8h_1autotoc_md60_1s1" title="Link to this heading"></a></h3>
<section id="nsphere__sort_8h_1autotoc_md60">
<span id="nsphere__sort_8h_1autotoc_md60_1s1"></span><h4>Returns<a class="headerlink" href="#nsphere__sort_8h_1autotoc_md60" title="Link to this heading"></a></h4>
<p id="nsphere__sort_8h_1autotoc_md60">None</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#quadsort_8c_1aa5334589d2edfc8333aa1bbcc21c5d6d"><span class="std std-ref">quadsort</span></a> - The original implementation used for standard types. </p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function automatically selects the appropriate sorting implementation based on the element size, providing optimized sorting for double and long double types when supported by the compiler. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The implementation for double and long double is only available when compiled with GCC or compatible compilers. </p>
</div>
</dd></dl>

</div>
</section>
<section id="quadsort-quadsort-c-quadsort-h">
<h2>QuadSort (<cite>quadsort.c</cite> / <cite>quadsort.h</cite>)<a class="headerlink" href="#quadsort-quadsort-c-quadsort-h" title="Link to this heading"></a></h2>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aaf6c489ad646fbb126bd2e10aed622de"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">parity_swap_four</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a1683bfdb842747e1bb86954d56105e1e"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">parity_swap_five</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a906d34112af90f28fde25d1a77998eea"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">parity_swap_six</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a56a1a35259060fa0aceb88958bfa62fb"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">parity_swap_seven</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a8de75cfb88b7fd4188f2519d7f06acda"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">tiny_sort</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aa0f55e042cf55de1688cca76bfd2c726"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">parity_merge</span> <span class="pre">(VAR</span> <span class="pre">*dest,</span> <span class="pre">VAR</span> <span class="pre">*from,</span> <span class="pre">size_t</span> <span class="pre">left,</span> <span class="pre">size_t</span> <span class="pre">right,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a308506295c7d8da06a51992de19e6f09"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">tail_swap</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a1e140347950c804d563970e013c53c09"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">quad_reversal</span> <span class="pre">(VAR</span> <span class="pre">*pta,</span> <span class="pre">VAR</span> <span class="pre">*ptz)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a4df18ce4001175200456119338102bb4"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">quad_swap_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a1faf9fe60029c9b35829380246a7c9c0"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">tail_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a7847a941c08687d04250e1c8b888d676"></span><span class="sig-name descname"><span class="pre">size_t</span> <span class="pre">FUNC</span> <span class="pre">quad_swap</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1af0762f96d6be7411a0682f05566b1b5e"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">cross_merge</span> <span class="pre">(VAR</span> <span class="pre">*dest,</span> <span class="pre">VAR</span> <span class="pre">*from,</span> <span class="pre">size_t</span> <span class="pre">left,</span> <span class="pre">size_t</span> <span class="pre">right,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a3c00a182a5eb686b363925d9606aefaf"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">quad_merge_block</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a04cd7859b65748d27888fdcb81496193"></span><span class="sig-name descname"><span class="pre">size_t</span> <span class="pre">FUNC</span> <span class="pre">quad_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a86733ffd7b99bed2e8807c39a886693f"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">partial_forward_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1ab74e338b9f7ec2be8dff9c76eeff6593"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">partial_backward_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a717c9e5080a87f50bc798d4a7a81050e"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">trinity_rotation</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">left)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1afb437edcda9e31ec48ea7dfe4dc58dad"></span><span class="sig-name descname"><span class="pre">size_t</span> <span class="pre">FUNC</span> <span class="pre">monobound_binary_first</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*value,</span> <span class="pre">size_t</span> <span class="pre">top,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a3d7112c345cdface000842be8a7f7db6"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">rotate_merge_block</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">lblock,</span> <span class="pre">size_t</span> <span class="pre">right,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aed11ea4bc07147c788f84d3c925e448c"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">rotate_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aa5334589d2edfc8333aa1bbcc21c5d6d"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">quadsort</span> <span class="pre">(void</span> <span class="pre">*array,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a66aa00e2f61089472e3a4048b49677b1"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC</span> <span class="pre">quadsort_swap</span> <span class="pre">(void</span> <span class="pre">*array,</span> <span class="pre">void</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.QUAD_CACHE">
<span class="target" id="quadsort_8h_1a5e74d02deddf7e39e4e23bd350a50773"></span><span class="sig-name descname"><span class="n"><span class="pre">QUAD_CACHE</span></span></span><a class="headerlink" href="#c.QUAD_CACHE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.head_branchless_merge">
<span class="target" id="quadsort_8h_1ab6a4ef28dc5a924a56ee49f610f60578"></span><span class="sig-name descname"><span class="n"><span class="pre">head_branchless_merge</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">ptd</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">ptl</span></span>, <span class="n"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.head_branchless_merge" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.tail_branchless_merge">
<span class="target" id="quadsort_8h_1ac93a172d9b80327b049c81a45ff6325d"></span><span class="sig-name descname"><span class="n"><span class="pre">tail_branchless_merge</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">tpd</span></span>, <span class="n"><span class="pre">y</span></span>, <span class="n"><span class="pre">tpl</span></span>, <span class="n"><span class="pre">tpr</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tail_branchless_merge" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.parity_merge_two">
<span class="target" id="quadsort_8h_1aa6068467d1b678d3fc4daf57cd643d0e"></span><span class="sig-name descname"><span class="n"><span class="pre">parity_merge_two</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">array</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">ptl</span></span>, <span class="n"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">pts</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.parity_merge_two" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.parity_merge_four">
<span class="target" id="quadsort_8h_1ae3a40694defd9ba8c8bd0b1bf9f47f59"></span><span class="sig-name descname"><span class="n"><span class="pre">parity_merge_four</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">array</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">ptl</span></span>, <span class="n"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">pts</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.parity_merge_four" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.branchless_swap">
<span class="target" id="quadsort_8h_1a2e149c1034b17cf86ed6aa380edbcb96"></span><span class="sig-name descname"><span class="n"><span class="pre">branchless_swap</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">pta</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.branchless_swap" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.swap_branchless">
<span class="target" id="quadsort_8h_1aaa3a20d3df36aa27c32d87e9b3ae91da"></span><span class="sig-name descname"><span class="n"><span class="pre">swap_branchless</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">pta</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">y</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.swap_branchless" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.VAR">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><a class="headerlink" href="#c.VAR" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.FUNC">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.FUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cmp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cmp" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a5e74d02deddf7e39e4e23bd350a50773"></span><span class="sig-name descname"><span class="n"><span class="pre">QUAD_CACHE</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv47CMPFUNC">
<span class="target" id="quadsort_8h_1ac0b079b59789af14bcd472eacba7bf45"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CMPFUNC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48quadsortPv6size_t6size_tP7CMPFUNC">
<span class="target" id="quadsort_8h_1a88f1effb04be822e96af463ae2d7d14e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv47CMPFUNC" title="CMPFUNC"><span class="n"><span class="pre">CMPFUNC</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48quadsortPv6size_t6size_tP7CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413quadsort_primPv6size_t6size_t">
<span class="target" id="quadsort_8h_1ae826b3391cde8bae02bd83c1e551ab60"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_prim</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413quadsort_primPv6size_t6size_t" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413quadsort_sizePv6size_t6size_tP7CMPFUNC">
<span class="target" id="quadsort_8h_1a4d8d3d5451af089533bb46bbbdf5630b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv47CMPFUNC" title="CMPFUNC"><span class="n"><span class="pre">CMPFUNC</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413quadsort_sizePv6size_t6size_tP7CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../data_flow/index.html" class="btn btn-neutral float-left" title="Data and Results Flow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../python_api/index.html" class="btn btn-neutral float-right" title="Python API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kris Sigurdson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>