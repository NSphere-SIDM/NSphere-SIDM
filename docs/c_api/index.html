

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>C API Reference &mdash; NSphere  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
      <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Python API Reference" href="../python_api/index.html" />
    <link rel="prev" title="Data and Results Flow" href="../data_flow/index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            NSphere
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../command_line/index.html">Command-Line Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_flow/index.html">Data and Results Flow</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">C API Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#nsphere-core-nsphere-c">NSphere Core (<cite>nsphere.c</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.MYBINIO_H"><code class="docutils literal notranslate"><span class="pre">MYBINIO_H</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CLEAN_EXIT"><code class="docutils literal notranslate"><span class="pre">CLEAN_EXIT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.imin"><code class="docutils literal notranslate"><span class="pre">imin</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DEBUG"><code class="docutils literal notranslate"><span class="pre">IF_DEBUG</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DYNPSI"><code class="docutils literal notranslate"><span class="pre">IF_DYNPSI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_DYNRANK"><code class="docutils literal notranslate"><span class="pre">IF_DYNRANK</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.IF_ALL_PART"><code class="docutils literal notranslate"><span class="pre">IF_ALL_PART</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.PI"><code class="docutils literal notranslate"><span class="pre">PI</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.G_CONST"><code class="docutils literal notranslate"><span class="pre">G_CONST</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.RC"><code class="docutils literal notranslate"><span class="pre">RC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.sqr"><code class="docutils literal notranslate"><span class="pre">sqr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.cube"><code class="docutils literal notranslate"><span class="pre">cube</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.kmsec_to_kpcmyr"><code class="docutils literal notranslate"><span class="pre">kmsec_to_kpcmyr</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.HALO_MASS"><code class="docutils literal notranslate"><span class="pre">HALO_MASS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.VEL_CONV_SQ"><code class="docutils literal notranslate"><span class="pre">VEL_CONV_SQ</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.CLEAN_LOCAL_EXIT"><code class="docutils literal notranslate"><span class="pre">CLEAN_LOCAL_EXIT</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.DEBUG_PARTICLE_ID"><code class="docutils literal notranslate"><span class="pre">DEBUG_PARTICLE_ID</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.DEBUG_MAX_STEPS"><code class="docutils literal notranslate"><span class="pre">DEBUG_MAX_STEPS</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv421get_suffixed_filenamePKciPc6size_t"><code class="docutils literal notranslate"><span class="pre">get_suffixed_filename()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411log_messagePKcPKcz"><code class="docutils literal notranslate"><span class="pre">log_message()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416format_file_sizelPc6size_t"><code class="docutils literal notranslate"><span class="pre">format_file_size()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411fprintf_binP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fprintf_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410fscanf_binP4FILEPKcz"><code class="docutils literal notranslate"><span class="pre">fscanf_bin()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425cleanup_all_particle_datav"><code class="docutils literal notranslate"><span class="pre">cleanup_all_particle_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422free_local_snap_arraysv"><code class="docutils literal notranslate"><span class="pre">free_local_snap_arrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419gravitational_forcediidd"><code class="docutils literal notranslate"><span class="pre">gravitational_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423effective_angular_forcedd"><code class="docutils literal notranslate"><span class="pre">effective_angular_force()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv425gravitational_force_rho_vdiidd"><code class="docutils literal notranslate"><span class="pre">gravitational_force_rho_v()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv429effective_angular_force_rho_vdd"><code class="docutils literal notranslate"><span class="pre">effective_angular_force_rho_v()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419store_debug_approxEidd"><code class="docutils literal notranslate"><span class="pre">store_debug_approxE()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427store_debug_dynE_componentsiddddd"><code class="docutils literal notranslate"><span class="pre">store_debug_dynE_components()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428finalize_debug_energy_outputv"><code class="docutils literal notranslate"><span class="pre">finalize_debug_energy_output()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410double_cmpPKvPKv"><code class="docutils literal notranslate"><span class="pre">double_cmp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417compare_particlesPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414sort_particlesPPdi"><code class="docutils literal notranslate"><span class="pre">sort_particles()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423sort_particles_with_algPPdiPKc"><code class="docutils literal notranslate"><span class="pre">sort_particles_with_alg()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418sort_rr_psi_arraysPdPdi"><code class="docutils literal notranslate"><span class="pre">sort_rr_psi_arrays()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413massintegranddPv"><code class="docutils literal notranslate"><span class="pre">massintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46drhodrd"><code class="docutils literal notranslate"><span class="pre">drhodr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412PsiintegranddPv"><code class="docutils literal notranslate"><span class="pre">Psiintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld"><code class="docutils literal notranslate"><span class="pre">evaluatespline()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411fEintegranddPv"><code class="docutils literal notranslate"><span class="pre">fEintegrand()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47cmp_LAIPKvPKv"><code class="docutils literal notranslate"><span class="pre">cmp_LAI()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49isIntegerPKc"><code class="docutils literal notranslate"><span class="pre">isInteger()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47isFloatPKc"><code class="docutils literal notranslate"><span class="pre">isFloat()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410printUsagePKc"><code class="docutils literal notranslate"><span class="pre">printUsage()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv412errorAndExitPKcPKcPKc"><code class="docutils literal notranslate"><span class="pre">errorAndExit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411sort_by_radP8PartDatai"><code class="docutils literal notranslate"><span class="pre">sort_by_rad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf"><code class="docutils literal notranslate"><span class="pre">append_all_particle_data_chunk_to_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf"><code class="docutils literal notranslate"><span class="pre">retrieve_all_particle_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417adjust_ntimestepsiii"><code class="docutils literal notranslate"><span class="pre">adjust_ntimesteps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415doMicroLeapfrogiiddddiidPdPd"><code class="docutils literal notranslate"><span class="pre">doMicroLeapfrog()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418doAdaptiveFullLeapiiddddddidiPdPd"><code class="docutils literal notranslate"><span class="pre">doAdaptiveFullLeap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411dRhoDtaufundd"><code class="docutils literal notranslate"><span class="pre">dRhoDtaufun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410forceLCfuniidddd"><code class="docutils literal notranslate"><span class="pre">forceLCfun()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420doLeviCivitaLeapfrogiiddddidPdPd"><code class="docutils literal notranslate"><span class="pre">doLeviCivitaLeapfrog()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417doMicroLeviCivitaiidddidddPdPdPd"><code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd"><code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd"><code class="docutils literal notranslate"><span class="pre">doAdaptiveFullLeviCivita()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424write_initial_conditionsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">write_initial_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423read_initial_conditionsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">read_initial_conditions()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420get_sort_descriptionPKc"><code class="docutils literal notranslate"><span class="pre">get_sort_description()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413parseSaveArgsiA_PcPi"><code class="docutils literal notranslate"><span class="pre">parseSaveArgs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427reassign_orig_ids_with_rankPdi"><code class="docutils literal notranslate"><span class="pre">reassign_orig_ids_with_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424fft_gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv427direct_gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420gaussian_convolutionPKdiPKddPd"><code class="docutils literal notranslate"><span class="pre">gaussian_convolution()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv428find_last_processed_snapshotPii"><code class="docutils literal notranslate"><span class="pre">find_last_processed_snapshot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv44mainiA_Pc"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv414insertion_sortPPdi"><code class="docutils literal notranslate"><span class="pre">insertion_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420stdlib_qsort_wrapperPPdi"><code class="docutils literal notranslate"><span class="pre">stdlib_qsort_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416quadsort_wrapperPPdi"><code class="docutils literal notranslate"><span class="pre">quadsort_wrapper()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418insertion_sort_subPPdii"><code class="docutils literal notranslate"><span class="pre">insertion_sort_sub()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423insertion_parallel_sortPPdi"><code class="docutils literal notranslate"><span class="pre">insertion_parallel_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv422quadsort_parallel_sortPPdi"><code class="docutils literal notranslate"><span class="pre">quadsort_parallel_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419verify_sort_resultsPPdiPKc"><code class="docutils literal notranslate"><span class="pre">verify_sort_results()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423compare_partdata_by_radPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_partdata_by_rad()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413compare_by_rrPKvPKv"><code class="docutils literal notranslate"><span class="pre">compare_by_rr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413g_file_suffix"><code class="docutils literal notranslate"><span class="pre">g_file_suffix</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_enable_logging"><code class="docutils literal notranslate"><span class="pre">g_enable_logging</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49g_doDebug"><code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410g_doDynPsi"><code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_doDynRank"><code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv419g_doAllParticleData"><code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411g_doRestart"><code class="docutils literal notranslate"><span class="pre">g_doRestart</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416skip_file_writes"><code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv424debug_direct_convolution"><code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv423use_closest_to_Lcompare"><code class="docutils literal notranslate"><span class="pre">use_closest_to_Lcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48Lcompare"><code class="docutils literal notranslate"><span class="pre">Lcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418Rank_partdata_snap"><code class="docutils literal notranslate"><span class="pre">Rank_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415R_partdata_snap"><code class="docutils literal notranslate"><span class="pre">R_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418Vrad_partdata_snap"><code class="docutils literal notranslate"><span class="pre">Vrad_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415L_partdata_snap"><code class="docutils literal notranslate"><span class="pre">L_partdata_snap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47L_block"><code class="docutils literal notranslate"><span class="pre">L_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410Rank_block"><code class="docutils literal notranslate"><span class="pre">Rank_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47R_block"><code class="docutils literal notranslate"><span class="pre">R_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410Vrad_block"><code class="docutils literal notranslate"><span class="pre">Vrad_block</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47nlowest"><code class="docutils literal notranslate"><span class="pre">nlowest</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv46chosen"><code class="docutils literal notranslate"><span class="pre">chosen</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49lowestL_r"><code class="docutils literal notranslate"><span class="pre">lowestL_r</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49lowestL_E"><code class="docutils literal notranslate"><span class="pre">lowestL_E</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49lowestL_L"><code class="docutils literal notranslate"><span class="pre">lowestL_L</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420use_identity_gravity"><code class="docutils literal notranslate"><span class="pre">use_identity_gravity</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411dbg_approxE"><code class="docutils literal notranslate"><span class="pre">dbg_approxE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_dynE"><code class="docutils literal notranslate"><span class="pre">dbg_dynE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_kinE"><code class="docutils literal notranslate"><span class="pre">dbg_kinE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_potE"><code class="docutils literal notranslate"><span class="pre">dbg_potE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48dbg_time"><code class="docutils literal notranslate"><span class="pre">dbg_time</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410dbg_radius"><code class="docutils literal notranslate"><span class="pre">dbg_radius</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49dbg_count"><code class="docutils literal notranslate"><span class="pre">dbg_count</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413normalization"><code class="docutils literal notranslate"><span class="pre">normalization</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv410doReadInit"><code class="docutils literal notranslate"><span class="pre">doReadInit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv411doWriteInit"><code class="docutils literal notranslate"><span class="pre">doWriteInit</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416readInitFilename"><code class="docutils literal notranslate"><span class="pre">readInitFilename</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417writeInitFilename"><code class="docutils literal notranslate"><span class="pre">writeInitFilename</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416g_defaultSortAlg"><code class="docutils literal notranslate"><span class="pre">g_defaultSortAlg</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv417num_sort_sections"><code class="docutils literal notranslate"><span class="pre">num_sort_sections</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv415overlap_divisor"><code class="docutils literal notranslate"><span class="pre">overlap_divisor</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv416min_seam_overlap"><code class="docutils literal notranslate"><span class="pre">min_seam_overlap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv418fEintegrand_params"><code class="docutils literal notranslate"><span class="pre">fEintegrand_params</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params1EE"><code class="docutils literal notranslate"><span class="pre">E</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params9splinePsiE"><code class="docutils literal notranslate"><span class="pre">splinePsi</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params10splinemassE"><code class="docutils literal notranslate"><span class="pre">splinemass</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params11rofPsiarrayE"><code class="docutils literal notranslate"><span class="pre">rofPsiarray</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N18fEintegrand_params9massarrayE"><code class="docutils literal notranslate"><span class="pre">massarray</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49LAndIndex"><code class="docutils literal notranslate"><span class="pre">LAndIndex</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex1LE"><code class="docutils literal notranslate"><span class="pre">L</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex3idxE"><code class="docutils literal notranslate"><span class="pre">idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9LAndIndex4signE"><code class="docutils literal notranslate"><span class="pre">sign</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48PartData"><code class="docutils literal notranslate"><span class="pre">PartData</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData4rankE"><code class="docutils literal notranslate"><span class="pre">rank</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData3radE"><code class="docutils literal notranslate"><span class="pre">rad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData4vradE"><code class="docutils literal notranslate"><span class="pre">vrad</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData6angmomE"><code class="docutils literal notranslate"><span class="pre">angmom</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N8PartData14original_indexE"><code class="docutils literal notranslate"><span class="pre">original_index</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv49RrPsiPair"><code class="docutils literal notranslate"><span class="pre">RrPsiPair</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9RrPsiPair2rrE"><code class="docutils literal notranslate"><span class="pre">rr</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N9RrPsiPair3psiE"><code class="docutils literal notranslate"><span class="pre">psi</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nsphere-sort-nsphere-sort-h">NSphere Sort (<cite>nsphere_sort.h</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_array"><code class="docutils literal notranslate"><span class="pre">ns_sort_array</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_prim"><code class="docutils literal notranslate"><span class="pre">ns_sort_prim</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_size"><code class="docutils literal notranslate"><span class="pre">ns_sort_size</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.ns_sort_extended"><code class="docutils literal notranslate"><span class="pre">ns_sort_extended</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv420ns_quadsort_extendedPv6size_t6size_tP7CMPFUNC"><code class="docutils literal notranslate"><span class="pre">ns_quadsort_extended()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quadsort-quadsort-c-quadsort-h">QuadSort (<cite>quadsort.c</cite> / <cite>quadsort.h</cite>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#c.QUAD_CACHE"><code class="docutils literal notranslate"><span class="pre">QUAD_CACHE</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.head_branchless_merge"><code class="docutils literal notranslate"><span class="pre">head_branchless_merge</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.tail_branchless_merge"><code class="docutils literal notranslate"><span class="pre">tail_branchless_merge</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.parity_merge_two"><code class="docutils literal notranslate"><span class="pre">parity_merge_two</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.parity_merge_four"><code class="docutils literal notranslate"><span class="pre">parity_merge_four</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.branchless_swap"><code class="docutils literal notranslate"><span class="pre">branchless_swap</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.swap_branchless"><code class="docutils literal notranslate"><span class="pre">swap_branchless</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.VAR"><code class="docutils literal notranslate"><span class="pre">VAR</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.FUNC"><code class="docutils literal notranslate"><span class="pre">FUNC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#c.cmp"><code class="docutils literal notranslate"><span class="pre">cmp</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv47CMPFUNC"><code class="docutils literal notranslate"><span class="pre">CMPFUNC</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv48quadsortPv6size_t6size_tP7CMPFUNC"><code class="docutils literal notranslate"><span class="pre">quadsort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413quadsort_primPv6size_t6size_t"><code class="docutils literal notranslate"><span class="pre">quadsort_prim()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv413quadsort_sizePv6size_t6size_tP7CMPFUNC"><code class="docutils literal notranslate"><span class="pre">quadsort_size()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../python_api/index.html">Python API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Examples</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NSphere</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">C API Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/c_api/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="c-api-reference">
<h1>C API Reference<a class="headerlink" href="#c-api-reference" title="Link to this heading"></a></h1>
<p>This section provides detailed documentation for the C components of NSphere, generated from source code comments using Doxygen and Breathe.</p>
<section id="nsphere-core-nsphere-c">
<h2>NSphere Core (<cite>nsphere.c</cite>)<a class="headerlink" href="#nsphere-core-nsphere-c" title="Link to this heading"></a></h2>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.MYBINIO_H">
<span class="target" id="nsphere_8c_1a8a7cdbd9f0c6050c69cf5edb33079101"></span><span class="sig-name descname"><span class="n"><span class="pre">MYBINIO_H</span></span></span><a class="headerlink" href="#c.MYBINIO_H" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CLEAN_EXIT">
<span class="target" id="nsphere_8c_1a67994ee785a0ae2ead6d236d19caeac5"></span><span class="sig-name descname"><span class="n"><span class="pre">CLEAN_EXIT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CLEAN_EXIT" title="Link to this definition"></a><br /></dt>
<dd><p>Thread-safe exit macro that properly cleans up allocated resources. </p>
<p>This macro ensures proper resource cleanup before program termination:<ul class="simple">
<li><p>Uses OpenMP critical section to ensure only one thread performs cleanup.</p></li>
<li><p>Calls <a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a> and <a class="reference internal" href="#nsphere_8c_1a4237306378c83f198a54fc2feac8e5eb"><span class="std std-ref">free_local_snap_arrays()</span></a> to free dynamically allocated memory.</p></li>
<li><p>Exits with the specified error code.</p></li>
</ul>
</p>
<p><dl>
<dt><strong>Example</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">error_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CLEAN_EXIT</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> – The exit code for the program.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.imin">
<span class="target" id="nsphere_8c_1a9e512761aee37544a1f18ee854407b87"></span><span class="sig-name descname"><span class="n"><span class="pre">imin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.imin" title="Link to this definition"></a><br /></dt>
<dd><section id="nsphere_8c_1autotoc_md7">
<h3>GLOBAL CONFIGURATION AND MACROS<a class="headerlink" href="#nsphere_8c_1autotoc_md7" title="Link to this heading"></a></h3>
<span class="target" id="nsphere_8c_1autotoc_md7"></span></section>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DEBUG">
<span class="target" id="nsphere_8c_1a084107b11a831e4b4bf3e83327b903b5"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DEBUG</span></span></span><a class="headerlink" href="#c.IF_DEBUG" title="Link to this definition"></a><br /></dt>
<dd><p>Conditional compilation macros for feature flags. </p>
<p>These macros provide a cleaner syntax for conditional code blocks that depend on the global feature flags.</p>
<p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DYNPSI">
<span class="target" id="nsphere_8c_1a293d1823eeb32494bd8d0dfb3152b004"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DYNPSI</span></span></span><a class="headerlink" href="#c.IF_DYNPSI" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_DYNRANK">
<span class="target" id="nsphere_8c_1a30d555dd887fc6c09e9d6cbb9accc0e5"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_DYNRANK</span></span></span><a class="headerlink" href="#c.IF_DYNRANK" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.IF_ALL_PART">
<span class="target" id="nsphere_8c_1ac2a7d072f22c12400574ce6ecec1b2f3"></span><span class="sig-name descname"><span class="n"><span class="pre">IF_ALL_PART</span></span></span><a class="headerlink" href="#c.IF_ALL_PART" title="Link to this definition"></a><br /></dt>
<dd><p>Macro for code blocks executed only if <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code> is true. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.PI">
<span class="target" id="nsphere_8c_1a598a3330b3c21701223ee0ca14316eca"></span><span class="sig-name descname"><span class="n"><span class="pre">PI</span></span></span><a class="headerlink" href="#c.PI" title="Link to this definition"></a><br /></dt>
<dd><p>Mathematical constant Pi. </p>
<section id="nsphere_8c_1autotoc_md9">
<h3>PHYSICAL CONSTANTS AND ASTROPHYSICAL PARAMETERS<a class="headerlink" href="#nsphere_8c_1autotoc_md9" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md9">Core constants and unit conversion factors for astrophysical calculations </p>
</section>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.G_CONST">
<span class="target" id="nsphere_8c_1ac4c50d2ec5229af74ea12911980e265a"></span><span class="sig-name descname"><span class="n"><span class="pre">G_CONST</span></span></span><a class="headerlink" href="#c.G_CONST" title="Link to this definition"></a><br /></dt>
<dd><p>Newton’s gravitational constant in kpc (km/sec)^2/Msun. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.RC">
<span class="target" id="nsphere_8c_1a9de40e06982123e40c3c92b5db6d7640"></span><span class="sig-name descname"><span class="n"><span class="pre">RC</span></span></span><a class="headerlink" href="#c.RC" title="Link to this definition"></a><br /></dt>
<dd><p>Core radius in kpc. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.sqr">
<span class="target" id="nsphere_8c_1adee8c6d2fc20a1194cf64c481e7b6353"></span><span class="sig-name descname"><span class="n"><span class="pre">sqr</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.sqr" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cube">
<span class="target" id="nsphere_8c_1a8368822f21884eec2e99ce31c08b0df4"></span><span class="sig-name descname"><span class="n"><span class="pre">cube</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cube" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.kmsec_to_kpcmyr">
<span class="target" id="nsphere_8c_1a27bf9b96269ee7511a077c4c908a37c0"></span><span class="sig-name descname"><span class="n"><span class="pre">kmsec_to_kpcmyr</span></span></span><a class="headerlink" href="#c.kmsec_to_kpcmyr" title="Link to this definition"></a><br /></dt>
<dd><p>Conversion factor: km/s to kpc/Myr. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.HALO_MASS">
<span class="target" id="nsphere_8c_1a6dfa358045ebb8fb55bbef34f5151786"></span><span class="sig-name descname"><span class="n"><span class="pre">HALO_MASS</span></span></span><a class="headerlink" href="#c.HALO_MASS" title="Link to this definition"></a><br /></dt>
<dd><p>Default halo mass in solar masses (Msun). </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.VEL_CONV_SQ">
<span class="target" id="nsphere_8c_1ac95cb8dbb481dff84064cae250b647ef"></span><span class="sig-name descname"><span class="n"><span class="pre">VEL_CONV_SQ</span></span></span><a class="headerlink" href="#c.VEL_CONV_SQ" title="Link to this definition"></a><br /></dt>
<dd><p>Velocity conversion squared (kpc/Myr)^2 per (km/s)^2. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.CLEAN_LOCAL_EXIT">
<span class="target" id="nsphere_8c_1ab44d6b36e8f42f8d0abbb57735dae501"></span><span class="sig-name descname"><span class="n"><span class="pre">CLEAN_LOCAL_EXIT</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">code</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.CLEAN_LOCAL_EXIT" title="Link to this definition"></a><br /></dt>
<dd><p>Non-thread-safe exit macro for cleanup and termination. </p>
<p>Performs cleanup and exits in single-threaded contexts:<ul class="simple">
<li><p>Frees local snapshot arrays via <a class="reference internal" href="#nsphere_8c_1a4237306378c83f198a54fc2feac8e5eb"><span class="std std-ref">free_local_snap_arrays()</span></a>.</p></li>
<li><p>Cleans up all global particle data arrays via <a class="reference internal" href="#nsphere_8c_1a7aee25e5421122109daf373663e3735e"><span class="std std-ref">cleanup_all_particle_data()</span></a>.</p></li>
<li><p>Exits with the specified error code.</p></li>
</ul>
</p>
<p><dl>
<dt><strong>Example</strong></dt><dd><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="n">error_condition</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">CLEAN_LOCAL_EXIT</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd>
</dl>
</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Not thread-safe. Use only in single-threaded contexts or where thread safety is guaranteed by other means.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>code</strong> – The exit code for the program.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.DEBUG_PARTICLE_ID">
<span class="target" id="nsphere_8c_1ad93df23038c4de269c9c6b66dc4a3f56"></span><span class="sig-name descname"><span class="n"><span class="pre">DEBUG_PARTICLE_ID</span></span></span><a class="headerlink" href="#c.DEBUG_PARTICLE_ID" title="Link to this definition"></a><br /></dt>
<dd><section id="nsphere_8c_1autotoc_md21">
<h3>Energy Debugging and Validation Subsystem<a class="headerlink" href="#nsphere_8c_1autotoc_md21" title="Link to this heading"></a></h3>
<span class="target" id="nsphere_8c_1autotoc_md21"></span></section>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.DEBUG_MAX_STEPS">
<span class="target" id="nsphere_8c_1a85a9270015b4ab8087c007d98dd57808"></span><span class="sig-name descname"><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span></span><a class="headerlink" href="#c.DEBUG_MAX_STEPS" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1a415c6d1c558074ad329697f2c01820fc"></span><span class="sig-name descname"><span class="pre">static</span> <span class="pre">int</span> <span class="pre">__attribute__</span> <span class="pre">((unused))</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv421get_suffixed_filenamePKciPc6size_t">
<span class="target" id="nsphere_8c_1a4757da672d57dda1b6f4114423850503"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_suffixed_filename</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">base_filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">with_suffix</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bufsize</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv421get_suffixed_filenamePKciPc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Applies the global suffix to a filename. </p>
<p>For .dat files, inserts suffix before the extension. For other files, appends suffix to the end of filename.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411log_messagePKcPKcz">
<span class="target" id="nsphere_8c_1a569e4ea9a45d9d1ed9d3c34d40b0da44"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">log_message</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">level</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411log_messagePKcPKcz" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416format_file_sizelPc6size_t">
<span class="target" id="nsphere_8c_1a83a2e63c11c141847a52cf72209bdf96"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">format_file_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">long</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size_in_bytes</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">buffer</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">buffer_size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416format_file_sizelPc6size_t" title="Link to this definition"></a><br /></dt>
<dd><p>Formats a byte count into a human-readable string with appropriate units. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411fprintf_binP4FILEPKcz">
<span class="target" id="nsphere_8c_1a43386b4e33cce0ad200f33114481d9e5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fprintf_bin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411fprintf_binP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Binary file I/O function declarations. </p>
<p>Writes binary data to a file using a printf-like format string.</p>
<p>These functions provide platform-independent binary file I/O operations similar to fprintf and fscanf, but ensure consistent binary format regardless of host architecture.</p>
<section id="nsphere_8c_1autotoc_md83">
<h3>BINARY FILE I/O UTILITIES<a class="headerlink" href="#nsphere_8c_1autotoc_md83" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md83">Parses a format string containing simplified specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Writes corresponding arguments from the variadic list (<code class="docutils literal notranslate"><span class="pre">...</span></code>) as binary data. Integer types (<code class="docutils literal notranslate"><span class="pre">d</span></code>) are written as <code class="docutils literal notranslate"><span class="pre">int</span></code>. Floating-point types (<code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">double</span></code> from args but written as <code class="docutils literal notranslate"><span class="pre">float</span></code> to the file for storage efficiency.</p>
<section id="nsphere_8c_1autotoc_md84">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md84" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md84">fp : FILE* File pointer to write to (must be opened in binary mode). format : const char* Format string with specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Other characters are ignored. … : Variable arguments matching the format specifiers.</p>
</section>
<section id="nsphere_8c_1autotoc_md85">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md85" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md85">int The number of items successfully written according to the format string.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"><span class="std std-ref">fscanf_bin</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Skips optional width/precision specifiers in the format string. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410fscanf_binP4FILEPKcz">
<span class="target" id="nsphere_8c_1ab7d8496e8c1e4de4ea717fa4f31afbe7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fscanf_bin</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">FILE</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fp</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">format</span></span>, <span class="p"><span class="pre">...</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410fscanf_binP4FILEPKcz" title="Link to this definition"></a><br /></dt>
<dd><p>Reads binary data from a file using a scanf-like format string. </p>
<p>Parses a format string containing simplified specifiers (<code class="docutils literal notranslate"><span class="pre">d</span></code>, <code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>). Reads corresponding binary data from the file and stores it in the pointer arguments provided in the variadic list (<code class="docutils literal notranslate"><span class="pre">...</span></code>). Integer types (<code class="docutils literal notranslate"><span class="pre">d</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">int</span></code>. Floating-point types (<code class="docutils literal notranslate"><span class="pre">f</span></code>, <code class="docutils literal notranslate"><span class="pre">g</span></code>, <code class="docutils literal notranslate"><span class="pre">e</span></code>) are read as <code class="docutils literal notranslate"><span class="pre">float</span></code> from the file but stored into <code class="docutils literal notranslate"><span class="pre">double*</span></code> arguments provided by the caller.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425cleanup_all_particle_datav">
<span class="target" id="nsphere_8c_1a7aee25e5421122109daf373663e3735e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cleanup_all_particle_data</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425cleanup_all_particle_datav" title="Link to this definition"></a><br /></dt>
<dd><p>Frees all global arrays used for particle data processing. </p>
<p>Frees L_block, Rank_block, R_block, Vrad_block, and chosen. Does NOT free lowestL_* arrays as they are handled elsewhere. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422free_local_snap_arraysv">
<span class="target" id="nsphere_8c_1a4237306378c83f198a54fc2feac8e5eb"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">free_local_snap_arrays</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422free_local_snap_arraysv" title="Link to this definition"></a><br /></dt>
<dd><p>Frees local arrays used for snapshot processing. </p>
<p>Frees Rank_partdata_snap, R_partdata_snap, Vrad_partdata_snap, L_partdata_snap. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419gravitational_forcediidd">
<span class="target" id="nsphere_8c_1a90e8d2ddbd4ea35b65f3232fdb0056f2"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravitational_force</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_rank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">G_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419gravitational_forcediidd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates gravitational acceleration at a given radius. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423effective_angular_forcedd">
<span class="target" id="nsphere_8c_1a53ca1607d27fe1cffaabec48d29910e9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">effective_angular_force</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423effective_angular_forcedd" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the effective centrifugal acceleration due to angular momentum. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv425gravitational_force_rho_vdiidd">
<span class="target" id="nsphere_8c_1a302b3d50ea55f625e4f840e8515a5c79"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gravitational_force_rho_v</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">current_rank</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">G_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">halo_mass_value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv425gravitational_force_rho_vdiidd" title="Link to this definition"></a><br /></dt>
<dd><p>Alternative gravitational force calculation using transformed coordinates. </p>
<p>Used in the Levi-Civita regularization scheme. Calculates F/m in rho coordinates.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv429effective_angular_force_rho_vdd">
<span class="target" id="nsphere_8c_1a9f030528565015911482c8584285839f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">effective_angular_force_rho_v</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv429effective_angular_force_rho_vdd" title="Link to this definition"></a><br /></dt>
<dd><p>Computes effective centrifugal acceleration in transformed coordinates. </p>
<p>Used in the Levi-Civita regularization scheme. Calculates L^2/r^3 in rho coordinates.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419store_debug_approxEidd">
<span class="target" id="nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">store_debug_approxE</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapIndex</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">E_value</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time_val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419store_debug_approxEidd" title="Link to this definition"></a><br /></dt>
<dd><p>Records the theoretical model energy for a debug snapshot. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427store_debug_dynE_componentsiddddd">
<span class="target" id="nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">store_debug_dynE_components</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snapIndex</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">totalE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">kinE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">potE</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">time_val</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_val</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427store_debug_dynE_componentsiddddd" title="Link to this definition"></a><br /></dt>
<dd><p>Records the actual dynamical energy and its components for a debug snapshot. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428finalize_debug_energy_outputv">
<span class="target" id="nsphere_8c_1a1219b4779e99559d4045950efce1739a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize_debug_energy_output</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428finalize_debug_energy_outputv" title="Link to this definition"></a><br /></dt>
<dd><p>Writes the collected debug energy comparison data to a file. </p>
<p>This function is called at the end of the simulation if debug mode (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>) is enabled. It iterates through the stored debug snapshots collected during the simulation and post-processing, writing the following data for the tracked particle (DEBUG_PARTICLE_ID) to <code class="docutils literal notranslate"><span class="pre">data/debug_energy_compare.dat</span></code> (with the appropriate file suffix applied):<ul class="simple">
<li><p>Snapshot index</p></li>
<li><p>Simulation time (Myr)</p></li>
<li><p>Particle radius (kpc)</p></li>
<li><p>Approximate (theoretical) energy (per unit mass)</p></li>
<li><p>Dynamic (calculated) energy (per unit mass)</p></li>
<li><p>Difference between dynamic and approximate energy</p></li>
<li><p>Kinetic energy component (per unit mass)</p></li>
<li><p>Potential energy component (per unit mass)</p></li>
</ul>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1adef2f9531e962161d53d3fc99b65927a"><span class="std std-ref">store_debug_approxE</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad40892ed49edca6d5fa783ac66f163bf"><span class="std std-ref">store_debug_dynE_components</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The file writing operation is skipped if the simulation is in restart mode and file writes are disabled (<code class="docutils literal notranslate"><span class="pre">skip_file_writes</span></code> is true).</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410double_cmpPKvPKv">
<span class="target" id="nsphere_8c_1aaedb17f00b23fc8b1250f6f76611eb83"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">double_cmp</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410double_cmpPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting double values (ascending order). </p>
<p>Used with qsort and other standard library sorting functions.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417compare_particlesPKvPKv">
<span class="target" id="nsphere_8c_1af2ff6db0e6e59733fd0fbc5470849b68"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_particles</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417compare_particlesPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for qsort to order particles based on radius. </p>
<p>Compares two particle entries for sorting based on the first column value.</p>
<section id="nsphere_8c_1autotoc_md31">
<h3>PARTICLE SORTING AND ORDERING OPERATIONS<a class="headerlink" href="#nsphere_8c_1autotoc_md31" title="Link to this heading"></a></h3>
<section id="nsphere_8c_1autotoc_md32">
<span id="nsphere_8c_1autotoc_md31"></span><h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md32" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md32">a : const void* Pointer to the first particle data array (double**). b : const void* Pointer to the second particle data array (double**).</p>
</section>
<section id="nsphere_8c_1autotoc_md33">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md33" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md33">int Integer less than, equal to, or greater than zero if the radius (first element) of particle <code class="docutils literal notranslate"><span class="pre">a</span></code> is found, respectively, to be less than, to match, or be greater than the radius of particle <code class="docutils literal notranslate"><span class="pre">b</span></code>.</p>
<p>
Used as a comparison function for qsort, quadsort, and other sorting algorithms. Particles with smaller values in column 0 will be sorted before those with larger values.</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compares based on the first element (index 0) of the column data, which represents the radius.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assumes the particle data is structured as [particle_index][component_index] when passed via <code class="docutils literal notranslate"><span class="pre">columns</span></code> array in sorting functions, and compares <code class="docutils literal notranslate"><span class="pre">columns[i][0]</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Pointer to the first particle entry (as void pointer, expected double**). </p></li>
<li><p><strong>b</strong> – Pointer to the second particle entry (as void pointer, expected double**). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>-1 if a&lt;b, 1 if a&gt;b, 0 if equal based on the first column value (radius).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414sort_particlesPPdi">
<span class="target" id="nsphere_8c_1ac80dacfe069ec441f196ff860e1e1455"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_particles</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414sort_particlesPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data using the default sorting algorithm (g_defaultSortAlg). </p>
<p>Convenience wrapper function for sorting particles with the default algorithm.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423sort_particles_with_algPPdiPKc">
<span class="target" id="nsphere_8c_1a5a75c173db8a8ac46fd63b324b865771"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_particles_with_alg</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sortAlg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423sort_particles_with_algPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data using the specified sorting algorithm. </p>
<p>Main function for sorting particle data using a specified algorithm.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418sort_rr_psi_arraysPdPdi">
<span class="target" id="nsphere_8c_1ae161185b8c5832ffaf4c6a6c3b87bbbb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_rr_psi_arrays</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rrA_spline</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">psiAarr_spline</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418sort_rr_psi_arraysPdPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts radius and psi arrays in tandem based on radius values. </p>
<p>Sorts radius and potential arrays simultaneously to maintain correspondence.</p>
<p>Ensures that the correspondence between radius and potential values is maintained after sorting, which is necessary for spline creation.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413massintegranddPv">
<span class="target" id="nsphere_8c_1a486e09e9ff56866413bdfb973b8172ce"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">massintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413massintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for calculating enclosed mass: <code class="docutils literal notranslate"><span class="pre">r^2</span> <span class="pre">*</span> <span class="pre">rho(r)</span></code>. </p>
<section id="nsphere_8c_1autotoc_md41">
<h3>PHYSICS CALCULATION FUNCTIONS<a class="headerlink" href="#nsphere_8c_1autotoc_md41" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md41">Used in GSL integration routines to compute M(r).</p>
<section id="nsphere_8c_1autotoc_md42">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md42" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md42">r : double Radial coordinate (kpc). params : void* Integration parameters (unused here, but required by GSL).</p>
</section>
<section id="nsphere_8c_1autotoc_md43">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md43" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md43">double Value of the mass integrand <code class="docutils literal notranslate"><span class="pre">r^2</span> <span class="pre">*</span> <span class="pre">rho(r)</span></code> at radius <code class="docutils literal notranslate"><span class="pre">r</span></code>.</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assumes a density profile <code class="docutils literal notranslate"><span class="pre">rho(r)</span></code> proportional to <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">/</span> <span class="pre">(1</span> <span class="pre">+</span> <span class="pre">(r/RC)^2)^3</span></code>. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv46drhodrd">
<span class="target" id="nsphere_8c_1a8e43116b27062f239c75f9e228f3420b"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">drhodr</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv46drhodrd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the derivative of the density profile with respect to radius. </p>
<p>Calculates the derivative of density with respect to radius.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412PsiintegranddPv">
<span class="target" id="nsphere_8c_1af5fd16c6b624d8d23a609134ed75bb0a"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Psiintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rp</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412PsiintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for calculating gravitational potential: <code class="docutils literal notranslate"><span class="pre">massintegrand(r)</span> <span class="pre">/</span> <span class="pre">r</span></code>. </p>
<p>Calculates the gravitational potential integrand for a given radius.</p>
<p>Used in GSL integration routines to compute Psi(r) via integral from r to infinity.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld">
<span class="target" id="nsphere_8c_1ad07d4bc0d7acda78ba6f3b8864d936f8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">evaluatespline</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">spline</span></span>, <span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">acc</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414evaluatesplineP10gsl_splineP16gsl_interp_acceld" title="Link to this definition"></a><br /></dt>
<dd><p>Evaluates a GSL spline at a given value with bounds checking. </p>
<p>Safely evaluates a GSL spline at a given value with robust bounds checking.</p>
<p>Safely evaluates the spline, clamping the input value to the spline’s defined range if necessary to prevent GSL errors.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411fEintegranddPv">
<span class="target" id="nsphere_8c_1aa5158e3d100422d6fe97a7914289bfe0"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">params</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411fEintegranddPv" title="Link to this definition"></a><br /></dt>
<dd><p>Integrand for energy distribution function <code class="docutils literal notranslate"><span class="pre">f(E)</span></code> calculation using Eddington’s formula. </p>
<p>Calculates the integrand for the distribution function calculation.</p>
<p>Computes <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">*</span> <span class="pre">drho/dpsi</span></code> as a function of <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">sqrt(E</span> <span class="pre">-</span> <span class="pre">Psi_min)</span></code>. Used in GSL integration to find the inner integral in Eddington’s formula.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47cmp_LAIPKvPKv">
<span class="target" id="nsphere_8c_1a131102931747b4519a71bdb613523776"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cmp_LAI</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47cmp_LAIPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting <a class="reference internal" href="#structLAndIndex"><span class="std std-ref">LAndIndex</span></a> structures by the <code class="docutils literal notranslate"><span class="pre">L</span></code> member (ascending). </p>
<p>Comparison function for sorting <a class="reference internal" href="#structLAndIndex"><span class="std std-ref">LAndIndex</span></a> structures by angular momentum.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv49isIntegerPKc">
<span class="target" id="nsphere_8c_1a42b67ba97407675434b2e4a94e733f62"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isInteger</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">str</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv49isIntegerPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a string represents a valid integer. </p>
<p>Allows an optional leading ‘+’ or ‘-’ sign. Checks if all subsequent characters are digits. Returns false for empty strings or strings containing only a sign.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv47isFloatPKc">
<span class="target" id="nsphere_8c_1a5b75ba4813fc53f0e959c9f67795a3b9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">isFloat</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">str</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47isFloatPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Checks if a string is a valid floating point number. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>str</strong> – The string to check </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>1 if string is a valid float, 0 otherwise </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410printUsagePKc">
<span class="target" id="nsphere_8c_1a85fda61d19f17f9567ee500e54d7e78e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">printUsage</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prog</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410printUsagePKc" title="Link to this definition"></a><br /></dt>
<dd><p>Displays detailed usage information for command-line arguments. </p>
<section id="nsphere_8c_1autotoc_md57">
<h3>COMMAND LINE ARGUMENT PROCESSING<a class="headerlink" href="#nsphere_8c_1autotoc_md57" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md57">Prints a comprehensive help message to stderr showing all available command-line options, their default values, and brief descriptions. Includes information about integration methods, sorting algorithms, data saving modes, and basic usage examples.</p>
<section id="nsphere_8c_1autotoc_md58">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md58" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md58">prog : const char* The program name to display in the usage message (typically argv[0]).</p>
</section>
<section id="nsphere_8c_1autotoc_md59">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md59" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md59">None (prints to stderr).</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Called when the user specifies &amp;#8212;help or when errors occur during argument parsing. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv412errorAndExitPKcPKcPKc">
<span class="target" id="nsphere_8c_1acc053c8a565be9074d3a4abefc609b3f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">errorAndExit</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">msg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">arg</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">prog</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv412errorAndExitPKcPKcPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Displays an error message, suggests &amp;#8212;help, and terminates the program. </p>
<p>Formats and prints an error message to stderr, includes a suggestion to use the &amp;#8212;help flag for usage information, performs necessary cleanup of allocated resources, and then exits with a non-zero status.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411sort_by_radP8PartDatai">
<span class="target" id="nsphere_8c_1aa18960860d11c051e4088aac179282a7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sort_by_rad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv48PartData" title="PartData"><span class="n"><span class="pre">PartData</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411sort_by_radP8PartDatai" title="Link to this definition"></a><br /></dt>
<dd><p>Sorts particle data in ascending order by radial position. </p>
<p>Sorts an array of <a class="reference internal" href="#structPartData"><span class="std std-ref">PartData</span></a> structures by their radius value.</p>
<p>Performs a quick sort of the particle data structure array, using the radial position as the primary sorting key. Preserves the original indices to allow tracking particles across time steps.</p>
<p>
Includes safety checks for NULL array and invalid counts before proceeding with the sort operation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>array</strong> – Array of particle data structures to be sorted </p></li>
<li><p><strong>npts</strong> – Number of particles in the array</p></li>
<li><p><strong>array</strong> – Array of <a class="reference internal" href="#structPartData"><span class="std std-ref">PartData</span></a> structures to sort </p></li>
<li><p><strong>npts</strong> – Number of elements in the array </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf">
<span class="target" id="nsphere_8c_1acf35e9a785fb4599bd9de42d4d36b58c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">append_all_particle_data_chunk_to_file</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">L_block</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Rank_block</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">R_block</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Vrad_block</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv438append_all_particle_data_chunk_to_filePKciiPfPiPfPf" title="Link to this definition"></a><br /></dt>
<dd><p>Appends a block of particle data to an output file. </p>
<p>Writes particle data (rank, radius, velocity, angular momentum) in step-major order, where all particles for a single time step are stored contiguously. This layout enables efficient seeking to specific snapshots during post-processing and visualization phases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – Path to the output file </p></li>
<li><p><strong>npts</strong> – Number of particles </p></li>
<li><p><strong>block_size</strong> – Number of time steps in this block </p></li>
<li><p><strong>L_block</strong> – Angular momentum data block (npts * block_size) </p></li>
<li><p><strong>Rank_block</strong> – Particle rank data block (npts * block_size) </p></li>
<li><p><strong>R_block</strong> – Radial position data block (npts * block_size) </p></li>
<li><p><strong>Vrad_block</strong> – Radial velocity data block (npts * block_size) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf">
<span class="target" id="nsphere_8c_1acce6775e508269e301b9fdc90f71babf"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">retrieve_all_particle_snapshot</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">snap</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">L_out</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Rank_out</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">R_out</span></span>, <span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">Vrad_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv430retrieve_all_particle_snapshotPKciiiPfPiPfPf" title="Link to this definition"></a><br /></dt>
<dd><p>Retrieves particle data for a specific snapshot from a binary file. </p>
<p>This function reads particle data (rank, radius, velocity, angular momentum) for a specific snapshot number from a binary file (<code class="docutils literal notranslate"><span class="pre">all_particle_data.dat</span></code>). It allocates temporary thread-local buffers to avoid race conditions when called in parallel. File I/O (seeking and reading) is performed within an OpenMP critical section (<code class="docutils literal notranslate"><span class="pre">file_access</span></code>) to ensure thread safety. After reading, the data is copied from the local buffers to the output arrays provided by the caller.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> – Path to the binary data file </p></li>
<li><p><strong>snap</strong> – Snapshot number to retrieve </p></li>
<li><p><strong>npts</strong> – Number of particles </p></li>
<li><p><strong>block_size</strong> – Number of snapshots per block in the file </p></li>
<li><p><strong>L_out</strong> – Output buffer for angular momentum values </p></li>
<li><p><strong>Rank_out</strong> – Output buffer for particle ranks </p></li>
<li><p><strong>R_out</strong> – Output buffer for radial positions </p></li>
<li><p><strong>Vrad_out</strong> – Output buffer for radial velocities </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417adjust_ntimestepsiii">
<span class="target" id="nsphere_8c_1a42bd334c6038615033c8df68f17aed7b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">adjust_ntimesteps</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">Ntimes_initial</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nout</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dtwrite</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417adjust_ntimestepsiii" title="Link to this definition"></a><br /></dt>
<dd><p>Adjusts the number of timesteps to ensure proper alignment with output intervals. </p>
<p>This function calculates an adjusted number of timesteps (N<code class="docutils literal notranslate"><span class="pre">)</span> <span class="pre">such</span> <span class="pre">that</span> <span class="pre">it</span> <span class="pre">is</span> <span class="pre">at</span> <span class="pre">least</span> <span class="pre">the</span> <span class="pre">requested</span> <span class="pre">initial</span> <span class="pre">value</span> <span class="pre">(</span></code>N) and satisfies the constraint: (N - 1) = (M - 1) * k * p for some integer k &gt;= 1, where M (<code class="docutils literal notranslate"><span class="pre">nout</span></code>) is the number of snapshots, and p (<code class="docutils literal notranslate"><span class="pre">dtwrite</span></code>) is the write interval.</p>
<p>This ensures that the simulation will produce exactly M output snapshots at intervals of approximately k*p timesteps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Ntimes_initial</strong> – Initially requested number of timesteps (N) </p></li>
<li><p><strong>nout</strong> – Number of output snapshots needed (M) </p></li>
<li><p><strong>dtwrite</strong> – Write interval in timesteps (p) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Adjusted number of timesteps (N’) satisfying the constraint </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv415doMicroLeapfrogiiddddiidPdPd">
<span class="target" id="nsphere_8c_1a31ec81f5740bfad5a550b8c27f5777f1"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doMicroLeapfrog</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subSteps</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv415doMicroLeapfrogiiddddiidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a micro-subdivided leapfrog step. </p>
<section id="nsphere_8c_1autotoc_md65">
<h3>ADAPTIVE FULL LEAPFROG STEP: r(n), v(n) –&gt; r(n+1), v(n+1)<a class="headerlink" href="#nsphere_8c_1autotoc_md65" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md65">Physics-based time integration method with adaptive step refinement:<ul>
<li><p>Subdivide the time step h = ΔT in powers-of-2 “micro-steps”</p></li>
<li><p>Compare a (2N+1)-step “coarse” vs. a (4N+1)-step “fine” integration</p></li>
<li><p>If within tolerance, return one of {coarse, fine, rich (Richardson extrapolation)}</p></li>
<li><p>Otherwise, double N and repeat until convergence or max subdivision reached</p>
<p>This helper function implements the leapfrog integration using a fixed number of micro-steps (<code class="docutils literal notranslate"><span class="pre">subSteps</span></code>, either 2N+1 for coarse or 4N+1 for fine). It takes the current radius and velocity (<code class="docutils literal notranslate"><span class="pre">r_in</span></code>, <code class="docutils literal notranslate"><span class="pre">v_in</span></code>) and applies a Kick-Drift-Kick sequence:</p>
</li>
</ul>
<ol class="loweralpha simple">
<li><p>Initial half-kick using <code class="docutils literal notranslate"><span class="pre">halfKick</span></code> timestep.</p></li>
<li><p>A sequence of <code class="docutils literal notranslate"><span class="pre">(subSteps</span> <span class="pre">-</span> <span class="pre">1)</span> <span class="pre">/</span> <span class="pre">2</span> <span class="pre">-</span> <span class="pre">1</span></code> full Drift-Kick pairs using <code class="docutils literal notranslate"><span class="pre">midStep</span></code> timestep.</p></li>
<li><p>Final full Drift using <code class="docutils literal notranslate"><span class="pre">midStep</span></code>.</p></li>
<li><p>Final half-kick using <code class="docutils literal notranslate"><span class="pre">halfKick</span></code>. The timestep sizes <code class="docutils literal notranslate"><span class="pre">halfKick</span></code> and <code class="docutils literal notranslate"><span class="pre">midStep</span></code> depend on whether it’s a coarse (<code class="docutils literal notranslate"><span class="pre">h/(2N)</span></code> and <code class="docutils literal notranslate"><span class="pre">h/N</span></code>) or fine (<code class="docutils literal notranslate"><span class="pre">h/(4N)</span></code> and <code class="docutils literal notranslate"><span class="pre">h/(2N)</span></code>) integration sequence. The function returns the new radius and velocity (<code class="docutils literal notranslate"><span class="pre">r_out</span></code>, <code class="docutils literal notranslate"><span class="pre">v_out</span></code>).</p></li>
</ol>
</p>
<p></p>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Particle index (used for rank in gravitational force). </p></li>
<li><p><strong>npts</strong> – Total number of particles. </p></li>
<li><p><strong>r_in</strong> – Input radius. </p></li>
<li><p><strong>v_in</strong> – Input velocity. </p></li>
<li><p><strong>ell</strong> – Angular momentum. </p></li>
<li><p><strong>h</strong> – Total timestep size for the full adaptive step (ΔT). </p></li>
<li><p><strong>N</strong> – Base subdivision factor for this micro-step sequence. </p></li>
<li><p><strong>subSteps</strong> – Number of substeps (either 2N+1 or 4N+1). </p></li>
<li><p><strong>grav</strong> – Gravitational constant value. </p></li>
<li><p><strong>r_out</strong> – Pointer to store the output radius. </p></li>
<li><p><strong>v_out</strong> – Pointer to store the output velocity. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418doAdaptiveFullLeapiiddddddidiPdPd">
<span class="target" id="nsphere_8c_1aaeff56e8db1ae13e4536e2be4e53830e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doAdaptiveFullLeap</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418doAdaptiveFullLeapiiddddddidiPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs an adaptive full leapfrog step with error control. </p>
<p>This function implements the adaptive leapfrog algorithm to advance a particle’s state (r, v) over a full timestep <code class="docutils literal notranslate"><span class="pre">h</span></code> (ΔT). It iteratively refines the integration by comparing coarse (2N+1 substeps) and fine (4N+1 substeps) integrations performed via <code class="docutils literal notranslate"><span class="pre">doMicroLeapfrog</span></code>. The process starts with subdivision factor N=1. In each iteration:<ol class="loweralpha simple">
<li><p>A “coarse” pass using 2N+1 micro-steps is performed.</p></li>
<li><p>A “fine” pass using 4N+1 micro-steps is performed.</p></li>
<li><p>The relative differences between the final radius and velocity from the coarse and fine passes are compared against <code class="docutils literal notranslate"><span class="pre">radius_tol</span></code> and <code class="docutils literal notranslate"><span class="pre">velocity_tol</span></code>.</p></li>
<li><p>If both tolerances are met, the integration has converged. The final state (<code class="docutils literal notranslate"><span class="pre">r_out</span></code>, <code class="docutils literal notranslate"><span class="pre">v_out</span></code>) is determined based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code>:<ul class="simple">
<li><p>0: Use the coarse result.</p></li>
<li><p>1: Use the fine result.</p></li>
<li><p>2: Use Richardson extrapolation (<code class="docutils literal notranslate"><span class="pre">4*fine</span> <span class="pre">-</span> <span class="pre">3*coarse</span></code>) for a potentially higher-order result.</p></li>
</ul>
</p></li>
<li><p>If tolerances are not met, the subdivision factor N is doubled (<code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*=</span> <span class="pre">2</span></code>), and the process repeats, up to a maximum subdivision factor <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>. If convergence is not achieved within <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>, the function returns the result from the highest N iteration based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.</p></li>
</ol>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a31ec81f5740bfad5a550b8c27f5777f1"><span class="std std-ref">doMicroLeapfrog</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Particle index (for rank in force computation). </p></li>
<li><p><strong>npts</strong> – Total number of particles. </p></li>
<li><p><strong>r_in</strong> – Input radius at the start of the step. </p></li>
<li><p><strong>v_in</strong> – Input velocity at the start of the step. </p></li>
<li><p><strong>ell</strong> – Angular momentum (conserved). </p></li>
<li><p><strong>h</strong> – Full physical timestep size ΔT. </p></li>
<li><p><strong>radius_tol</strong> – Relative convergence tolerance for radius. </p></li>
<li><p><strong>velocity_tol</strong> – Relative convergence tolerance for velocity. </p></li>
<li><p><strong>max_subdiv</strong> – Maximum subdivision factor N allowed. </p></li>
<li><p><strong>grav</strong> – Gravitational constant value. </p></li>
<li><p><strong>out_type</strong> – Result selection: 0=coarse, 1=fine, 2=Richardson extrapolation. </p></li>
<li><p><strong>r_out</strong> – Pointer to store the final radius. </p></li>
<li><p><strong>v_out</strong> – Pointer to store the final velocity.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv411dRhoDtaufundd">
<span class="target" id="nsphere_8c_1a8de62bf1b56586a24266b2c9788f2995"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dRhoDtaufun</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rhoVal</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">vVal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv411dRhoDtaufundd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the derivative of rho with respect to the fictitious time tau. </p>
<section id="nsphere_8c_1autotoc_md67">
<h3>LEVI-CIVITA REGULARIZATION<a class="headerlink" href="#nsphere_8c_1autotoc_md67" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md67">Physics-based regularized time integration method:<ul class="simple">
<li><p>Transforms coordinates (r -&gt; ρ = √r) to handle close encounters</p></li>
<li><p>Uses fictitious time τ to integrate equations of motion</p></li>
<li><p>Maps back to physical coordinates and time after integration</p></li>
<li><p>Provides enhanced stability for high-eccentricity orbits Part of the Levi-Civita regularization transformation.</p></li>
</ul>
</p>
<p></p>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rhoVal</strong> – The transformed radial coordinate ρ = √r </p></li>
<li><p><strong>vVal</strong> – The velocity in transformed coordinates </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dρ/dτ = 0.5 * ρ * v </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv410forceLCfuniidddd">
<span class="target" id="nsphere_8c_1ad782ca225e103de69acd7a2ed0b6e9d9"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">forceLCfun</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">totalmass</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rhoVal</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv410forceLCfuniidddd" title="Link to this definition"></a><br /></dt>
<dd><p>Calculates the total force acting on a particle in Levi-Civita transformed coordinates. </p>
<p>This function combines the gravitational and angular components of force in the ρ (rho) coordinate system which is the square root transformation of radius.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Particle index for force computation </p></li>
<li><p><strong>npts</strong> – Total number of particles </p></li>
<li><p><strong>totalmass</strong> – Total mass of the system including dark matter halo </p></li>
<li><p><strong>grav</strong> – Gravitational constant </p></li>
<li><p><strong>ell</strong> – Angular momentum </p></li>
<li><p><strong>rhoVal</strong> – Current value of ρ = √r in Levi-Civita coordinates </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Total force in transformed coordinates </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420doLeviCivitaLeapfrogiiddddidPdPd">
<span class="target" id="nsphere_8c_1a1c23d0d0cc2cf5901b9016ccd1c52b55"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doLeviCivitaLeapfrog</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N_taumin</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420doLeviCivitaLeapfrogiiddddidPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs integration of particle motion using Levi-Civita regularization. </p>
<p>This function implements the Levi-Civita leapfrog integration algorithm to advance a particle’s state over a physical time step <code class="docutils literal notranslate"><span class="pre">dt</span></code>.<ol class="loweralpha simple">
<li><p>Transforms coordinates from physical <code class="docutils literal notranslate"><span class="pre">r_in</span></code> to regularized <code class="docutils literal notranslate"><span class="pre">rho</span> <span class="pre">=</span> <span class="pre">sqrt(r_in)</span></code>.</p></li>
<li><p>Estimates an initial fictitious time step <code class="docutils literal notranslate"><span class="pre">deltaTau</span></code> aiming for roughly <code class="docutils literal notranslate"><span class="pre">N_taumin</span></code> steps within the physical interval <code class="docutils literal notranslate"><span class="pre">dt</span></code>.</p></li>
<li><p>Integrates the equations of motion in <code class="docutils literal notranslate"><span class="pre">(rho,</span> <span class="pre">v_rad,</span> <span class="pre">t_phys)</span></code> using a leapfrog scheme in fictitious time <code class="docutils literal notranslate"><span class="pre">tau</span></code>:<ul class="simple">
<li><p>Compute force <code class="docutils literal notranslate"><span class="pre">fval</span></code> at <code class="docutils literal notranslate"><span class="pre">rho_cur</span></code>.</p></li>
<li><p>Half-kick velocity: <code class="docutils literal notranslate"><span class="pre">v_half</span> <span class="pre">=</span> <span class="pre">v_cur</span> <span class="pre">+</span> <span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">deltaTau</span> <span class="pre">*</span> <span class="pre">fval</span></code>.</p></li>
<li><p>Drift rho: <code class="docutils literal notranslate"><span class="pre">rho_next</span> <span class="pre">=</span> <span class="pre">rho_cur</span> <span class="pre">+</span> <span class="pre">deltaTau</span> <span class="pre">*</span> <span class="pre">dRhoDtaufun(rho_cur,</span> <span class="pre">v_half)</span></code>.</p></li>
<li><p>Compute force <code class="docutils literal notranslate"><span class="pre">fval2</span></code> at <code class="docutils literal notranslate"><span class="pre">rho_next</span></code>.</p></li>
<li><p>Second half-kick velocity: <code class="docutils literal notranslate"><span class="pre">v_next</span> <span class="pre">=</span> <span class="pre">v_half</span> <span class="pre">+</span> <span class="pre">0.5</span> <span class="pre">*</span> <span class="pre">deltaTau</span> <span class="pre">*</span> <span class="pre">fval2</span></code>.</p></li>
<li><p>Update physical time <code class="docutils literal notranslate"><span class="pre">t_phys</span></code> using the midpoint rho: <code class="docutils literal notranslate"><span class="pre">t_next</span> <span class="pre">=</span> <span class="pre">t_phys</span> <span class="pre">+</span> <span class="pre">deltaTau</span> <span class="pre">*</span> <span class="pre">rho_mid^2</span></code>.</p></li>
</ul>
</p></li>
<li><p>The loop continues until <code class="docutils literal notranslate"><span class="pre">t_phys</span> <span class="pre">&gt;=</span> <span class="pre">dt</span></code>.</p></li>
<li><p>If a step overshoots <code class="docutils literal notranslate"><span class="pre">dt</span></code> (<code class="docutils literal notranslate"><span class="pre">t_next</span> <span class="pre">&gt;</span> <span class="pre">dt</span></code>), the final state <code class="docutils literal notranslate"><span class="pre">(rho_f,</span> <span class="pre">v_f)</span></code> at exactly <code class="docutils literal notranslate"><span class="pre">t_phys</span> <span class="pre">=</span> <span class="pre">dt</span></code> is found using linear interpolation between the state before and after the overshoot step.</p></li>
<li><p>Transforms the final regularized state <code class="docutils literal notranslate"><span class="pre">(rho_f,</span> <span class="pre">v_f)</span></code> back to physical coordinates <code class="docutils literal notranslate"><span class="pre">r_out</span> <span class="pre">=</span> <span class="pre">rho_f^2</span></code> and <code class="docutils literal notranslate"><span class="pre">v_out</span> <span class="pre">=</span> <span class="pre">v_f</span></code>. Includes a maximum step count to prevent infinite loops.</p></li>
</ol>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad782ca225e103de69acd7a2ed0b6e9d9"><span class="std std-ref">forceLCfun</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a8de62bf1b56586a24266b2c9788f2995"><span class="std std-ref">dRhoDtaufun</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Particle index (for rank in force calculation). </p></li>
<li><p><strong>npts</strong> – Total number of particles. </p></li>
<li><p><strong>r_in</strong> – Initial physical radius at time t_i. </p></li>
<li><p><strong>v_in</strong> – Initial physical radial velocity at time t_i. </p></li>
<li><p><strong>ell</strong> – Angular momentum for the force law. </p></li>
<li><p><strong>dt</strong> – Physical time step ΔT to advance. </p></li>
<li><p><strong>N_taumin</strong> – Target number of tau-steps (influences <code class="docutils literal notranslate"><span class="pre">deltaTau</span></code> guess). </p></li>
<li><p><strong>grav</strong> – Gravitational constant value. </p></li>
<li><p><strong>r_out</strong> – Pointer to store the final physical radius at time t_i + ΔT. </p></li>
<li><p><strong>v_out</strong> – Pointer to store the final physical velocity at time t_i + ΔT.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417doMicroLeviCivitaiidddidddPdPdPd">
<span class="target" id="nsphere_8c_1a43b4fbd8f6dec345978f0bcc2e7d3b9d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doMicroLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_in</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">subSteps</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h_tau</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rho_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417doMicroLeviCivitaiidddidddPdPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs Levi-Civita regularized integration for a fixed number of micro-steps. </p>
<section id="nsphere_8c_1autotoc_md69">
<h3>ADAPTIVE FULL LEVI-CIVITA REGULARIZATION<a class="headerlink" href="#nsphere_8c_1autotoc_md69" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md69">Enhanced regularization scheme that combines adaptive step sizing with Levi-Civita coordinate transformation for optimal performance near the coordinate origin.</p>
<p>Integrates the equations of motion in (rho, v, t) using fictitious time tau for a specified number of <code class="docutils literal notranslate"><span class="pre">subSteps</span></code>. This is a helper function used by <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code>.</p>
<section id="nsphere_8c_1autotoc_md70">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md70" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md70">i : int Particle index (for rank in force calculation). npts : int Total number of particles in the simulation. rho_in : double Initial rho = sqrt(r) at the start of the tau interval <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. v_in : double Initial radial velocity at the start of the tau interval. t_in : double Initial physical time at the start of the tau interval. subSteps : int Number of micro-steps to perform (e.g., 2N+1 or 4N+1). h_tau : double Total fictitious time interval (Delta tau) for this integration sequence. grav : double Gravitational constant value (e.g., G_CONST). ell : double Angular momentum per unit mass (conserved). rho_out : double* Pointer to store the final rho value after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. v_out : double* Pointer to store the final velocity after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>. t_out : double* Pointer to store the final physical time after <code class="docutils literal notranslate"><span class="pre">h_tau</span></code>.</p>
</section>
<section id="nsphere_8c_1autotoc_md71">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md71" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md71">None (results are returned via rho_out, v_out, t_out pointers).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a5b4db770ebecaeb708ae7b16a73d3e37"><span class="std std-ref">doSingleTauStepAdaptiveLeviCivita</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ad782ca225e103de69acd7a2ed0b6e9d9"><span class="std std-ref">forceLCfun</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a8de62bf1b56586a24266b2c9788f2995"><span class="std std-ref">dRhoDtaufun</span></a></p>
</div>
</p>
</section>
</section>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd">
<span class="target" id="nsphere_8c_1a5b4db770ebecaeb708ae7b16a73d3e37"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rho_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">t_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">h_guess</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">rho_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">t_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv433doSingleTauStepAdaptiveLeviCivitaiiddddddiddiPdPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs a single adaptive step in Levi-Civita coordinates with error control. </p>
<p>Integrates over a proposed fictitious time step <code class="docutils literal notranslate"><span class="pre">h_guess</span></code> (Δτ) using adaptive refinement. It compares coarse (2N+1 substeps) and fine (4N+1 substeps) integrations via <code class="docutils literal notranslate"><span class="pre">doMicroLeviCivita</span></code>. The process starts with N=1. In each iteration:<ol class="loweralpha simple">
<li><p>Perform coarse integration (2N+1 substeps) to get <code class="docutils literal notranslate"><span class="pre">(rhoC,</span> <span class="pre">vC,</span> <span class="pre">tC)</span></code>.</p></li>
<li><p>Perform fine integration (4N+1 substeps) to get <code class="docutils literal notranslate"><span class="pre">(rhoF,</span> <span class="pre">vF,</span> <span class="pre">tF)</span></code>.</p></li>
<li><p>Compare relative differences in <code class="docutils literal notranslate"><span class="pre">rho</span></code> and <code class="docutils literal notranslate"><span class="pre">v</span></code> against tolerances.</p></li>
<li><p>If converged: Return result <code class="docutils literal notranslate"><span class="pre">(rho_out,</span> <span class="pre">v_out,</span> <span class="pre">t_out)</span></code> based on <code class="docutils literal notranslate"><span class="pre">out_type</span></code>.<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">out_type=0</span></code>: Coarse result <code class="docutils literal notranslate"><span class="pre">(rhoC,</span> <span class="pre">vC,</span> <span class="pre">tC)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">out_type=1</span></code>: Fine result <code class="docutils literal notranslate"><span class="pre">(rhoF,</span> <span class="pre">vF,</span> <span class="pre">tF)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">out_type=2</span></code>: Richardson extrapolation result (<code class="docutils literal notranslate"><span class="pre">4*fine</span> <span class="pre">-</span> <span class="pre">3*coarse</span></code>) applied to rho, v, and t for a higher-order estimate. A floor of 0.0 is applied to the extrapolated rho.</p></li>
</ul>
</p></li>
<li><p>If not converged: Double N (<code class="docutils literal notranslate"><span class="pre">N</span> <span class="pre">*=</span> <span class="pre">2</span></code>) and repeat, up to <code class="docutils literal notranslate"><span class="pre">max_subdiv</span></code>. If convergence is not achieved, the result from the highest <code class="docutils literal notranslate"><span class="pre">N</span></code> fine step (<code class="docutils literal notranslate"><span class="pre">4*N+1</span></code> substeps) is calculated and returned.</p></li>
</ol>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a43b4fbd8f6dec345978f0bcc2e7d3b9d"><span class="std std-ref">doMicroLeviCivita</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Particle index (for rank in force calculation). </p></li>
<li><p><strong>npts</strong> – Total number of particles. </p></li>
<li><p><strong>rho_in</strong> – Initial rho = sqrt(r) at the start of this adaptive tau step. </p></li>
<li><p><strong>v_in</strong> – Initial radial velocity at the start of this step. </p></li>
<li><p><strong>t_in</strong> – Initial physical time at the start of this step. </p></li>
<li><p><strong>h_guess</strong> – Proposed fictitious time step (Δτ guess) for this adaptive step. </p></li>
<li><p><strong>radius_tol</strong> – Relative convergence tolerance for rho comparison. </p></li>
<li><p><strong>velocity_tol</strong> – Relative convergence tolerance for velocity comparison. </p></li>
<li><p><strong>max_subdiv</strong> – Maximum allowed value for the subdivision factor <code class="docutils literal notranslate"><span class="pre">N</span></code>. </p></li>
<li><p><strong>grav</strong> – Gravitational constant value (e.g., G_CONST). </p></li>
<li><p><strong>ell</strong> – Angular momentum per unit mass (conserved). </p></li>
<li><p><strong>out_type</strong> – Result selection mode: 0=coarse, 1=fine, 2=Richardson extrapolation. </p></li>
<li><p><strong>rho_out</strong> – Pointer to store the final rho value after the adaptive step. </p></li>
<li><p><strong>v_out</strong> – Pointer to store the final velocity after the adaptive step. </p></li>
<li><p><strong>t_out</strong> – Pointer to store the final physical time after the adaptive step.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (results are returned via rho_out, v_out, t_out pointers).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd">
<span class="target" id="nsphere_8c_1a4d600bde20d7b1720839965824a8f800"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doAdaptiveFullLeviCivita</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">v_in</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ell</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dt</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">N_taumin</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">radius_tol</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">velocity_tol</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_subdiv</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grav</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">out_type</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">r_out</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">v_out</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424doAdaptiveFullLeviCivitaiiddddiddidiPdPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs an adaptive full Levi-Civita regularized leapfrog step over physical time dt. </p>
<p>Integrates particle motion over a physical time step <code class="docutils literal notranslate"><span class="pre">dt</span></code> (ΔT) using the adaptive Levi-Civita scheme. It takes multiple adaptive <code class="docutils literal notranslate"><span class="pre">tau</span></code> steps (using <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code>) until the accumulated physical time <code class="docutils literal notranslate"><span class="pre">t_cur</span></code> reaches or exceeds <code class="docutils literal notranslate"><span class="pre">dt</span></code>.<ol class="loweralpha simple">
<li><p>Handles the edge case of near-zero initial radius <code class="docutils literal notranslate"><span class="pre">r_in</span></code> by returning immediately.</p></li>
<li><p>Transforms initial physical state <code class="docutils literal notranslate"><span class="pre">(r_in,</span> <span class="pre">v_in)</span></code> to regularized <code class="docutils literal notranslate"><span class="pre">(rho_current,</span> <span class="pre">v_current)</span></code>.</p></li>
<li><p>Estimates an initial fictitious time step <code class="docutils literal notranslate"><span class="pre">deltaTau</span></code> based on <code class="docutils literal notranslate"><span class="pre">r_in</span></code> and <code class="docutils literal notranslate"><span class="pre">N_taumin</span></code>.</p></li>
<li><p>Enters a loop that continues as long as <code class="docutils literal notranslate"><span class="pre">t_cur</span> <span class="pre">&lt;</span> <span class="pre">dt</span></code>: a. Calls <code class="docutils literal notranslate"><span class="pre">doSingleTauStepAdaptiveLeviCivita</span></code> to perform one adaptive τ-step, advancing the state to <code class="docutils literal notranslate"><span class="pre">(rho_next,</span> <span class="pre">v_next,</span> <span class="pre">t_next)</span></code>. b. Checks if the step overshot the target time (<code class="docutils literal notranslate"><span class="pre">t_next</span> <span class="pre">&gt;</span> <span class="pre">dt</span></code>). c. If overshoot: Performs linear interpolation between the state before (<code class="docutils literal notranslate"><span class="pre">rho_current</span></code>, <code class="docutils literal notranslate"><span class="pre">v_current</span></code>, <code class="docutils literal notranslate"><span class="pre">t_cur</span></code>) and after (<code class="docutils literal notranslate"><span class="pre">rho_next</span></code>, <code class="docutils literal notranslate"><span class="pre">v_next</span></code>, <code class="docutils literal notranslate"><span class="pre">t_next</span></code>) the step to find the state <code class="docutils literal notranslate"><span class="pre">(rho_final,</span> <span class="pre">v_final)</span></code> exactly at <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">dt</span></code>. Transforms back to physical <code class="docutils literal notranslate"><span class="pre">(r_out,</span> <span class="pre">v_out)</span></code> and returns. d. If no overshoot: Updates the current state (<code class="docutils literal notranslate"><span class="pre">rho_current</span> <span class="pre">=</span> <span class="pre">rho_next</span></code>, etc.) and continues the loop.</p></li>
<li><p>Includes a maximum step count (<code class="docutils literal notranslate"><span class="pre">stepMax</span></code>) as a safety measure against infinite loops.</p></li>
<li><p>If the loop completes normally (e.g., <code class="docutils literal notranslate"><span class="pre">t_cur</span></code> exactly equals <code class="docutils literal notranslate"><span class="pre">dt</span></code> on step acceptance, or if the overshoot check somehow fails), it transforms the final state <code class="docutils literal notranslate"><span class="pre">(rho_current,</span> <span class="pre">v_current)</span></code> back to physical coordinates <code class="docutils literal notranslate"><span class="pre">(r_out,</span> <span class="pre">v_out)</span></code>.</p></li>
</ol>
</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a5b4db770ebecaeb708ae7b16a73d3e37"><span class="std std-ref">doSingleTauStepAdaptiveLeviCivita</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>i</strong> – Particle index (for rank in force calculation). </p></li>
<li><p><strong>npts</strong> – Total number of particles. </p></li>
<li><p><strong>r_in</strong> – Initial physical radius at the start of the physical step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_in</strong> – Initial physical radial velocity at the start of the step <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>ell</strong> – Angular momentum per unit mass (conserved). </p></li>
<li><p><strong>dt</strong> – Physical time step (ΔT) to advance. </p></li>
<li><p><strong>N_taumin</strong> – Target number of tau-steps (influences <code class="docutils literal notranslate"><span class="pre">deltaTau</span></code> guess). </p></li>
<li><p><strong>radius_tol</strong> – Relative convergence tolerance for rho comparison (passed to substep function). </p></li>
<li><p><strong>velocity_tol</strong> – Relative convergence tolerance for velocity comparison (passed to substep function). </p></li>
<li><p><strong>max_subdiv</strong> – Maximum allowed value for the subdivision factor <code class="docutils literal notranslate"><span class="pre">N</span></code> (passed to substep function). </p></li>
<li><p><strong>grav</strong> – Gravitational constant value (e.g., G_CONST). </p></li>
<li><p><strong>out_type</strong> – Result selection mode for substeps: 0=coarse, 1=fine, 2=Richardson. </p></li>
<li><p><strong>r_out</strong> – Pointer to store the final physical radius after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>. </p></li>
<li><p><strong>v_out</strong> – Pointer to store the final physical velocity after time <code class="docutils literal notranslate"><span class="pre">dt</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None (results are returned via r_out, v_out pointers).</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424write_initial_conditionsPPdiPKc">
<span class="target" id="nsphere_8c_1aca344a26cf5ac4e75f3e48f402260df8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">write_initial_conditions</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424write_initial_conditionsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Writes particle initial conditions to a binary file. </p>
<section id="nsphere_8c_1autotoc_md75">
<h3>INITIAL CONDITION FILE I/O FUNCTIONS<a class="headerlink" href="#nsphere_8c_1autotoc_md75" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md75">Stores the complete initial particle state (radius, velocity, angular momentum, original index, orientation parameter mu) and the particle count (<code class="docutils literal notranslate"><span class="pre">npts</span></code>) to a binary file for later retrieval via <code class="docutils literal notranslate"><span class="pre">read_initial_conditions</span></code>. Opens the file in write binary mode (“wb”). First writes the integer <code class="docutils literal notranslate"><span class="pre">npts</span></code>, then writes the 5 double-precision values for each particle sequentially.</p>
<section id="nsphere_8c_1autotoc_md76">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md76" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md76">particles : double** 2D array containing particle properties [component][particle_index]. Expected components: 0=rad, 1=vel, 2=angmom, 3=orig_idx, 4=mu. npts : int Number of particles to write. filename : const char* Path to the output binary file.</p>
</section>
<section id="nsphere_8c_1autotoc_md77">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md77" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md77">None</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a5dd148939766228831427e02bb7e122d"><span class="std std-ref">read_initial_conditions</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The binary file format is: <code class="docutils literal notranslate"><span class="pre">npts</span></code> (int32), followed by <code class="docutils literal notranslate"><span class="pre">npts</span></code> records, each consisting of 5 <code class="docutils literal notranslate"><span class="pre">double</span></code> values (radius, velocity, ang. mom., orig. index, mu). </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints an error to stderr if the file cannot be opened.</p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423read_initial_conditionsPPdiPKc">
<span class="target" id="nsphere_8c_1a5dd148939766228831427e02bb7e122d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">read_initial_conditions</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">particles</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">npts</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">filename</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423read_initial_conditionsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Reads particle initial conditions from a binary file. </p>
<p>Loads the complete particle state (radius, velocity, angular momentum, original index, orientation parameter mu) from a binary file previously created by <code class="docutils literal notranslate"><span class="pre">write_initial_conditions</span></code>. Verifies that the number of particles read from the file matches the expected count <code class="docutils literal notranslate"><span class="pre">npts</span></code>. Opens the file in read binary mode (“rb”).</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420get_sort_descriptionPKc">
<span class="target" id="nsphere_8c_1a2ae9c69e89df65eb9ddc9c3edd6e2422"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">get_sort_description</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">sort_alg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420get_sort_descriptionPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Returns a human-readable description for a sort algorithm identifier string. </p>
<p>Maps internal sort algorithm identifiers to user-friendly descriptive names. Supported algorithms: quadsort_parallel, quadsort, insertion_parallel, insertion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>sort_alg</strong> – The internal algorithm identifier string (e.g., “quadsort_parallel”) </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A descriptive name for the algorithm (e.g., “Parallel Quadsort”), or the input string itself if no match is found </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413parseSaveArgsiA_PcPi">
<span class="target" id="nsphere_8c_1a344694a6ad4d30409cb375f274e47199"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parseSaveArgs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">argc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">argv</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pIndex</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413parseSaveArgsiA_PcPi" title="Link to this definition"></a><br /></dt>
<dd><p>Parses sub-arguments for the “–save” command-line option. </p>
<p>Reads subsequent arguments after “–save” (until another option starting with ‘-’ is encountered) and sets global data output flags (<code class="docutils literal notranslate"><span class="pre">g_doDebug</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynPsi</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doDynRank</span></code>, <code class="docutils literal notranslate"><span class="pre">g_doAllParticleData</span></code>) based on the highest priority sub-argument found. Valid sub-arguments: “raw-data”, “psi-snaps”, “full-snaps”, “debug-energy”, “all”.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427reassign_orig_ids_with_rankPdi">
<span class="target" id="nsphere_8c_1aa4b092fc3980d0bddf5571fb4e2ea26c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reassign_orig_ids_with_rank</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">orig_ids</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427reassign_orig_ids_with_rankPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Remaps original particle IDs to their rank (0…n-1) among the final set. </p>
<p>Takes an array of potentially non-contiguous original particle IDs (stored as doubles) and replaces each ID with its zero-based rank within the sorted sequence of those IDs. This effectively transforms arbitrary ID values into a contiguous sequence [0, n-1]. Used after tidal stripping.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424fft_gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1a00dc1a204635107066a592e8e1dc8753"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fft_gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424fft_gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Applies Gaussian smoothing using FFT-based convolution (thread-safe via critical section). </p>
<section id="nsphere_8c_1autotoc_md93">
<h3>SIGNAL PROCESSING AND FILTERING UTILITIES<a class="headerlink" href="#nsphere_8c_1autotoc_md93" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md93">Advanced numerical processing utilities for density field handling including:<ul class="simple">
<li><p>FFT-based convolution for density smoothing</p></li>
<li><p>Direct Gaussian convolution for smaller datasets</p></li>
<li><p>Signal filtering and processing functions</p></li>
</ul>
</p>
</section>
<section id="nsphere_8c_1autotoc_md95">
<h3>FFT METHODS AND CONVOLUTION IMPLEMENTATIONS<a class="headerlink" href="#nsphere_8c_1autotoc_md95" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md95">Smooths a density field defined on a potentially non-uniform grid (<code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>) using FFT convolution with a Gaussian kernel of width <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code> (defined in log-space). Uses zero-padding to avoid wrap-around artifacts. This is generally faster than direct convolution for large <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>. Assumes log_r_grid is uniformly spaced.</p>
<section id="nsphere_8c_1autotoc_md96">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md96" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md96">density_grid : const double* Input density grid array (values corresponding to <code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>). grid_size : int Number of points in the input grid and density arrays. log_r_grid : const double* Array of logarithmic radial grid coordinates (log10(r)). Must be uniformly spaced. sigma_log : double Width (standard deviation) of the Gaussian kernel in log10-space. result : double* Output array (pre-allocated, size <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>) for the smoothed density field.</p>
</section>
<section id="nsphere_8c_1autotoc_md97">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md97" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md97">None (populates the <code class="docutils literal notranslate"><span class="pre">result</span></code> array).</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"><span class="std std-ref">direct_gaussian_convolution</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses FFTW library for Fast Fourier Transforms (<code class="docutils literal notranslate"><span class="pre">fftw_malloc</span></code>, <code class="docutils literal notranslate"><span class="pre">fftw_plan_dft_r2c_1d</span></code>, etc.). Requires FFTW to be installed. FFTW operations are protected by <code class="docutils literal notranslate"><span class="pre">omp</span> <span class="pre">critical(fftw)</span></code>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Resulting smoothed density is clamped to a minimum value of 1e-10. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints errors to stderr and returns early on memory allocation failures or FFTW plan creation failures. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv427direct_gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1ae6262b059e0f4eda9ff1f30a3fa38d04"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">direct_gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv427direct_gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Applies Gaussian smoothing using direct convolution. </p>
<p>Smooths a density field defined on a potentially non-uniform grid (<code class="docutils literal notranslate"><span class="pre">log_r_grid</span></code>) using direct spatial convolution with a Gaussian kernel of width <code class="docutils literal notranslate"><span class="pre">sigma_log</span></code> (defined in log-space). For each point <code class="docutils literal notranslate"><span class="pre">i</span></code> in the output <code class="docutils literal notranslate"><span class="pre">result</span></code> array, it computes a weighted sum of the input <code class="docutils literal notranslate"><span class="pre">density_grid</span></code> values: <code class="docutils literal notranslate"><span class="pre">result[i]</span> <span class="pre">=</span> <span class="pre">sum(density_grid[j]</span> <span class="pre">*</span> <span class="pre">kernel(log_r_grid[i]</span> <span class="pre">-</span> <span class="pre">log_r_grid[j]))</span> <span class="pre">/</span> <span class="pre">sum(kernel(...))</span></code> where the <code class="docutils literal notranslate"><span class="pre">kernel</span></code> is a Gaussian function <code class="docutils literal notranslate"><span class="pre">G(x)</span> <span class="pre">=</span> <span class="pre">(1/(σ√2π))</span> <span class="pre">*</span> <span class="pre">exp(-0.5*(x/σ)²)</span></code>, with <code class="docutils literal notranslate"><span class="pre">x</span></code> being the distance <code class="docutils literal notranslate"><span class="pre">log_r_grid[i]</span> <span class="pre">-</span> <span class="pre">log_r_grid[j]</span></code> and <code class="docutils literal notranslate"><span class="pre">σ</span> <span class="pre">=</span> <span class="pre">sigma_log</span></code>. This method is generally more accurate than FFT-based convolution, especially for non-uniform grids or near boundaries, but has a higher computational cost (O(N²)) which makes it slower for large <code class="docutils literal notranslate"><span class="pre">grid_size</span></code>.</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420gaussian_convolutionPKdiPKddPd">
<span class="target" id="nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">gaussian_convolution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">density_grid</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">grid_size</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">log_r_grid</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sigma_log</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">result</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420gaussian_convolutionPKdiPKddPd" title="Link to this definition"></a><br /></dt>
<dd><p>Performs Gaussian smoothing by selecting the appropriate convolution method. </p>
<p>Acts as a routing function that delegates density smoothing to either <code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution</span></code> or <code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution</span></code> based on the value of the global <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> flag.<ul class="simple">
<li><p>If <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> is non-zero, <code class="docutils literal notranslate"><span class="pre">direct_gaussian_convolution</span></code> is called (more accurate, O(N²) complexity, suitable for smaller or non-uniform grids).</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">debug_direct_convolution</span></code> is zero (default), <code class="docutils literal notranslate"><span class="pre">fft_gaussian_convolution</span></code> is called (faster for large grids, O(N log N) complexity, requires uniformly spaced logarithmic grid).</p></li>
</ul>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428find_last_processed_snapshotPii">
<span class="target" id="nsphere_8c_1a8f1878f89cdeb5134aa413a021e301ec"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">find_last_processed_snapshot</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">snapshot_steps</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">noutsnaps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428find_last_processed_snapshotPii" title="Link to this definition"></a><br /></dt>
<dd><p>Finds the index of the last successfully processed snapshot in restart mode. </p>
<section id="nsphere_8c_1autotoc_md103">
<h3>RESTART AND RECOVERY MANAGEMENT<a class="headerlink" href="#nsphere_8c_1autotoc_md103" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md103">Checks for the existence and basic validity (non-zero size, consistent size compared to snapshot 0) of expected output data files (unsorted and sorted Rank/Mass/Rad/Vrad files) for each snapshot step defined in <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code>. Used to determine where to resume processing when the <code class="docutils literal notranslate"><span class="pre">--restart</span></code> flag is enabled.</p>
<section id="nsphere_8c_1autotoc_md104">
<h4>Parameters<a class="headerlink" href="#nsphere_8c_1autotoc_md104" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md104">snapshot_steps : int* Array containing the step numbers (indices) of the snapshots that were <em>supposed</em> to be written during the simulation. noutsnaps : int Total number of snapshot indices in the <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code> array.</p>
</section>
<section id="nsphere_8c_1autotoc_md105">
<h4>Returns<a class="headerlink" href="#nsphere_8c_1autotoc_md105" title="Link to this heading"></a></h4>
<p id="nsphere_8c_1autotoc_md105">int<ul class="simple">
<li><p>The index <code class="docutils literal notranslate"><span class="pre">s</span></code> in <code class="docutils literal notranslate"><span class="pre">snapshot_steps</span></code> corresponding to the <em>next</em> snapshot that needs processing (i.e., <code class="docutils literal notranslate"><span class="pre">last_valid_index</span> <span class="pre">+</span> <span class="pre">1</span></code>).</p></li>
<li><p>Returns -1 if no valid snapshot files are found (start from beginning).</p></li>
<li><p>Returns -2 if <em>all</em> expected snapshot files exist and appear valid (nothing to do).</p></li>
</ul>
</p>
<p></p>
</section>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Compares file sizes against the first snapshot’s files as a reference, allowing for a +/- 5% tolerance. Assumes <code class="docutils literal notranslate"><span class="pre">g_file_suffix</span></code> is set correctly. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Prints status messages and warnings/errors to stdout/log. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv44mainiA_Pc">
<span class="target" id="nsphere_8c_1a0ddf1224851353fc92bfbff6f499fa97"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">main</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">argc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">argv</span></span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv44mainiA_Pc" title="Link to this definition"></a><br /></dt>
<dd><p>Main entry point for the n-sphere dark matter simulation program. </p>
<p>Orchestrates the overall simulation workflow:<ol class="loweralpha simple">
<li><p>Parses command-line arguments using a flexible option system</p></li>
<li><p>Sets up initial conditions (particle distribution, system parameters)</p></li>
<li><p>Executes the selected integration method for trajectory evolution</p></li>
<li><p>Outputs data products (particle states, phase diagrams, energy tracking)</p></li>
<li><p>Handles restart/resume functionality when requested</p></li>
</ol>
</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="nsphere_8c_1a66edb3d9254e7075824efdfeb375175a"></span><span class="sig-name descname"><span class="pre">double</span> <span class="pre">massintegrand</span> <span class="pre">(double</span> <span class="pre">r,</span> <span class="pre">void</span> <span class="pre">*params</span> <span class="pre">__attribute__((unused)))</span></span></dt>
<dd><p>Calculates the mass integrand for a given radius using a density profile. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>r</strong> – Radius value </p></li>
<li><p><strong>params</strong> – Unused parameter (with compiler attribute to prevent warnings) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Mass integrand value at the specified radius </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv414insertion_sortPPdi">
<span class="target" id="nsphere_8c_1a9f764a3b15f188a11747c55c91e3fea6"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv414insertion_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Implementation of classic insertion sort algorithm for particle data. </p>
<p>Sorts an array of particle data using the insertion sort algorithm. While not the fastest algorithm for large datasets, it is stable and works well for small arrays or nearly sorted data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> – Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420stdlib_qsort_wrapperPPdi">
<span class="target" id="nsphere_8c_1a5054402587a6df1b0a3eaf1b197fee26"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">stdlib_qsort_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420stdlib_qsort_wrapperPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper for the standard C library quicksort function. </p>
<p>Provides a consistent interface to the standard library <code class="docutils literal notranslate"><span class="pre">qsort</span></code> function using the <code class="docutils literal notranslate"><span class="pre">compare_particles</span></code> function as the comparison callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data to be sorted (passed as <code class="docutils literal notranslate"><span class="pre">double**</span></code>). </p></li>
<li><p><strong>n</strong> – Number of elements (particles) to sort. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv416quadsort_wrapperPPdi">
<span class="target" id="nsphere_8c_1ae61a8488ea1cc6e78d15b9a6412a7ac4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_wrapper</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv416quadsort_wrapperPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Wrapper for the external quadsort algorithm. </p>
<p>Provides a consistent interface to the external quadsort function, which is typically faster than standard quicksort for many distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> – Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv418insertion_sort_subPPdii">
<span class="target" id="nsphere_8c_1ad333571f8f209b19896bc93e94643a61"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_sort_sub</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">start</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">end</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv418insertion_sort_subPPdii" title="Link to this definition"></a><br /></dt>
<dd><p>Helper function that performs insertion sort on a subarray of particle data. </p>
<p>Similar to <code class="docutils literal notranslate"><span class="pre">insertion_sort</span></code> but operates on a specific range <code class="docutils literal notranslate"><span class="pre">[start..end]</span></code> inclusive. Used by the parallel sorting algorithms to sort individual chunks and seam regions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data containing the target subarray (<code class="docutils literal notranslate"><span class="pre">double**</span></code>). </p></li>
<li><p><strong>start</strong> – Starting index of the subarray (inclusive). </p></li>
<li><p><strong>end</strong> – Ending index of the subarray (inclusive). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423insertion_parallel_sortPPdi">
<span class="target" id="nsphere_8c_1a333ac7a494bba72619fb98750fe69634"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insertion_parallel_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423insertion_parallel_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Parallel insertion sort implementation using chunk-based approach with overlap. </p>
<p>Divides the data into num_sort_sections chunks, sorts each chunk in parallel, then fixes the boundaries between chunks by re-sorting overlap regions. This approach balances parallelism with the need to ensure properly sorted output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> – Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422quadsort_parallel_sortPPdi">
<span class="target" id="nsphere_8c_1af20d2b892dfa310cbf845403a905796e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_parallel_sort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422quadsort_parallel_sortPPdi" title="Link to this definition"></a><br /></dt>
<dd><p>Parallel quadsort implementation using chunk-based approach with overlap. </p>
<p>Similar to insertion_parallel_sort but uses the quadsort algorithm for both the initial chunk sorting and the seam fixing. Quadsort is generally faster than insertion sort for larger datasets while maintaining stability.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data to be sorted </p></li>
<li><p><strong>n</strong> – Number of elements to sort </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419verify_sort_resultsPPdiPKc">
<span class="target" id="nsphere_8c_1a7569fb12f08ce841608a7c3e54a0ad19"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">verify_sort_results</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">columns</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">label</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419verify_sort_resultsPPdiPKc" title="Link to this definition"></a><br /></dt>
<dd><p>Validates sorting results by comparing with standard qsort. </p>
<p>Creates a copy of the input array, sorts it with standard qsort, then compares the results element by element to verify that the sorting algorithm produced the expected ordering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>columns</strong> – 2D array of particle data that has been sorted </p></li>
<li><p><strong>n</strong> – Number of elements in the array </p></li>
<li><p><strong>label</strong> – Name of the sorting algorithm for diagnostic output </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv423compare_partdata_by_radPKvPKv">
<span class="target" id="nsphere_8c_1a894769c574fe85ecef41c7741e2a1a55"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_partdata_by_rad</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv423compare_partdata_by_radPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting <a class="reference internal" href="#structPartData"><span class="std std-ref">PartData</span></a> structures by radius value. </p>
<p>Provides a robust comparison that handles NULL pointers and NaN values, ensuring stable sorting behavior even with potentially problematic data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Pointer to the first <a class="reference internal" href="#structPartData"><span class="std std-ref">PartData</span></a> structure (as void pointer) </p></li>
<li><p><strong>b</strong> – Pointer to the second <a class="reference internal" href="#structPartData"><span class="std std-ref">PartData</span></a> structure (as void pointer) </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>-1 if a&lt;b, 1 if a&gt;b, 0 if equal </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413compare_by_rrPKvPKv">
<span class="target" id="nsphere_8c_1a56d40dff8c3bb82e43ca11c357d1a572"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compare_by_rr</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413compare_by_rrPKvPKv" title="Link to this definition"></a><br /></dt>
<dd><p>Comparison function for sorting <a class="reference internal" href="#structRrPsiPair"><span class="std std-ref">RrPsiPair</span></a> structures by radius (<code class="docutils literal notranslate"><span class="pre">rr</span></code>). </p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#structRrPsiPair"><span class="std std-ref">RrPsiPair</span></a></p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1ae161185b8c5832ffaf4c6a6c3b87bbbb"><span class="std std-ref">sort_rr_psi_arrays</span></a></p>
</div>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – Pointer to the first <a class="reference internal" href="#structRrPsiPair"><span class="std std-ref">RrPsiPair</span></a> structure (as void pointer). </p></li>
<li><p><strong>b</strong> – Pointer to the second <a class="reference internal" href="#structRrPsiPair"><span class="std std-ref">RrPsiPair</span></a> structure (as void pointer). </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>-1 if a-&gt;rr &lt; b-&gt;rr, 1 if a-&gt;rr &gt; b-&gt;rr, 0 if equal.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-variables">Variables</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413g_file_suffix">
<span class="target" id="nsphere_8c_1a2849b95526a209a1c2bef7450ec4fb6e"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_file_suffix</span></span></span><span class="p"><span class="pre">[</span></span><span class="m"><span class="pre">256</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;&quot;</span></span><a class="headerlink" href="#_CPPv413g_file_suffix" title="Link to this definition"></a><br /></dt>
<dd><p>Global file suffix string. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_enable_logging">
<span class="target" id="nsphere_8c_1ae577daedc1b00c1bb2e11dba4f69a64c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_enable_logging</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416g_enable_logging" title="Link to this definition"></a><br /></dt>
<dd><p>Writes a formatted message to the log file with timestamp and severity level. </p>
<p>Enable logging to file (controlled by &amp;#8212;enable-log flag).</p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49g_doDebug">
<span class="target" id="nsphere_8c_1a2763bb9f0f7f79afffeac48905e799fb"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDebug</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv49g_doDebug" title="Link to this definition"></a><br /></dt>
<dd><p>Global simulation feature flags. </p>
<p>These control various optional behaviors and optimizations in the simulation. Each flag can be set via command line arguments. Enable detailed debug output. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410g_doDynPsi">
<span class="target" id="nsphere_8c_1ac14e6ad00493002d0af407252f07f3b1"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDynPsi</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv410g_doDynPsi" title="Link to this definition"></a><br /></dt>
<dd><p>Enable dynamic potential recalculation. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_doDynRank">
<span class="target" id="nsphere_8c_1a8b153c5c0087d5c9f2330cc7ada744e7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doDynRank</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411g_doDynRank" title="Link to this definition"></a><br /></dt>
<dd><p>Enable dynamic rank calculation per step. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv419g_doAllParticleData">
<span class="target" id="nsphere_8c_1a90ac17f8099c6a91249c330a7a45dcb5"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doAllParticleData</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv419g_doAllParticleData" title="Link to this definition"></a><br /></dt>
<dd><p>Save complete particle evolution history. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411g_doRestart">
<span class="target" id="nsphere_8c_1a74aece53e0af69f9a5537f139fa24f08"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">g_doRestart</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411g_doRestart" title="Link to this definition"></a><br /></dt>
<dd><p>Enable simulation restart from checkpoint. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416skip_file_writes">
<span class="target" id="nsphere_8c_1acc92b9579ff43b04dd2277bf7d34dcdf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">skip_file_writes</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv416skip_file_writes" title="Link to this definition"></a><br /></dt>
<dd><p>Skip file writes during simulation restart. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv424debug_direct_convolution">
<span class="target" id="nsphere_8c_1a4a1f369af4feb2852a5bddbace1948b9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">debug_direct_convolution</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv424debug_direct_convolution" title="Link to this definition"></a><br /></dt>
<dd><p>Convolution method selection for density smoothing. </p>
<p>Controls the convolution method selection for density smoothing.</p>
<p>0 = FFT-based convolution (default, faster for large datasets). 1 = Direct spatial convolution (more accurate but slower).</p>
<p>Global flag that determines whether to use direct convolution (1) or FFT-based convolution (0). Direct convolution is more accurate but slower for large grids, while FFT-based convolution is faster but may introduce artifacts.</p>
<p><div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="#nsphere_8c_1a36451b2e5e6867cdf1609523c40181cf"><span class="std std-ref">gaussian_convolution</span></a></p>
</div>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>External declaration, defined elsewhere. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv423use_closest_to_Lcompare">
<span class="target" id="nsphere_8c_1aac9606b439f76709f7fe911236c020c0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_closest_to_Lcompare</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><a class="headerlink" href="#_CPPv423use_closest_to_Lcompare" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum selection configuration for particle filtering. </p>
<p>Mode 0: Select particles with the 5 lowest L values. Mode 1: Select particles with L values closest to Lcompare. Mode selector (0 or 1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48Lcompare">
<span class="target" id="nsphere_8c_1acf387feb573420c5639256a2e7485a52"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Lcompare</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0.05</span></span><a class="headerlink" href="#_CPPv48Lcompare" title="Link to this definition"></a><br /></dt>
<dd><p>Reference L value for closest-match mode (Mode 1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418Rank_partdata_snap">
<span class="target" id="nsphere_8c_1a4114fc7f42bb6b1fc93edb9833bcb6ce"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Rank_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv418Rank_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Global particle data arrays for snapshot processing. </p>
<section id="nsphere_8c_1autotoc_md11">
<h3>GLOBAL PARTICLE DATA ARRAYS<a class="headerlink" href="#nsphere_8c_1autotoc_md11" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md11">Particle rank (sorted position) data for a snapshot. </p>
</section>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415R_partdata_snap">
<span class="target" id="nsphere_8c_1a310bb3684fede6f13355b46e3940116f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">R_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415R_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Radial position data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv418Vrad_partdata_snap">
<span class="target" id="nsphere_8c_1aa3a563971e30d251652519c4cb948b4b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Vrad_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv418Vrad_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Radial velocity data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415L_partdata_snap">
<span class="target" id="nsphere_8c_1ad4dd74edba84fea4874fa24d76d1911d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">L_partdata_snap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv415L_partdata_snap" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum data for a snapshot. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47L_block">
<span class="target" id="nsphere_8c_1ae2cf810c54ba0f579886bc7fa34e2a80"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">L_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47L_block" title="Link to this definition"></a><br /></dt>
<dd><p>Global arrays for particle data processing (block storage). </p>
<p>Angular momentum block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410Rank_block">
<span class="target" id="nsphere_8c_1aaead4d7d454a66bd595ee20411721b3a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Rank_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410Rank_block" title="Link to this definition"></a><br /></dt>
<dd><p>Particle rank (sorted position) block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47R_block">
<span class="target" id="nsphere_8c_1aac6f0b01f5fd9b6ae62ff0dcee03df09"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">R_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv47R_block" title="Link to this definition"></a><br /></dt>
<dd><p>Radial position block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410Vrad_block">
<span class="target" id="nsphere_8c_1ac2d702a2edcaf84b4f5ad4195e676b5d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">Vrad_block</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv410Vrad_block" title="Link to this definition"></a><br /></dt>
<dd><p>Radial velocity block. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv47nlowest">
<span class="target" id="nsphere_8c_1ae89d6fccec017254c845f6c6e6e78d3b"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nlowest</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">5</span></span><a class="headerlink" href="#_CPPv47nlowest" title="Link to this definition"></a><br /></dt>
<dd><p>Variables for tracking low angular momentum particles. </p>
<p>Number of lowest angular momentum particles to track. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv46chosen">
<span class="target" id="nsphere_8c_1a01d2e68fbc1f506be8cc06e896b620e0"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">chosen</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv46chosen" title="Link to this definition"></a><br /></dt>
<dd><p>Array of indices (original IDs) for selected low-L particles. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49lowestL_r">
<span class="target" id="nsphere_8c_1aef51927bdcad0e918d125ade409c9135"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">lowestL_r</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49lowestL_r" title="Link to this definition"></a><br /></dt>
<dd><p>Radial positions of tracked low-L particles over time [particle][time_step]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49lowestL_E">
<span class="target" id="nsphere_8c_1a0365bb5a431c80f22090421f87ae2b6d"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">lowestL_E</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49lowestL_E" title="Link to this definition"></a><br /></dt>
<dd><p>Energy values of tracked low-L particles over time [particle][time_step]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49lowestL_L">
<span class="target" id="nsphere_8c_1aeb007f684444f9ecf355459c3516fec8"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">lowestL_L</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv49lowestL_L" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momenta of tracked low-L particles over time [particle][time_step]. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv420use_identity_gravity">
<span class="target" id="nsphere_8c_1a6936a69fecabe2fdcb93993ef527ba44"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">use_identity_gravity</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv420use_identity_gravity" title="Link to this definition"></a><br /></dt>
<dd><p>Gravitational force calculation control flag. </p>
<p>Used for testing and debugging orbital dynamics:<ul class="simple">
<li><p>0 = Normal gravitational force calculation (default).</p></li>
<li><p>1 = Zero gravity (particles move in straight lines).</p></li>
</ul>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting this to 1 is useful for validating the integration scheme independent of gravitational physics. </p>
</div>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411dbg_approxE">
<span class="target" id="nsphere_8c_1a5bb6373db7244f6d2891a3221d366785"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_approxE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv411dbg_approxE" title="Link to this definition"></a><br /></dt>
<dd><p>Arrays for tracking energy components through simulation for debugging. </p>
<p>Theoretical model energy (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_dynE">
<span class="target" id="nsphere_8c_1ac9cbd2043d21d1cc89ff1fc00d2a1460"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_dynE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_dynE" title="Link to this definition"></a><br /></dt>
<dd><p>Actual dynamical energy (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_kinE">
<span class="target" id="nsphere_8c_1a88f1da0ce13577814bbeb1e1fc08feb4"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_kinE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_kinE" title="Link to this definition"></a><br /></dt>
<dd><p>Kinetic energy component (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_potE">
<span class="target" id="nsphere_8c_1a05fb53ef0323425e63e369bb5bf02d37"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_potE</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_potE" title="Link to this definition"></a><br /></dt>
<dd><p>Potential energy component (per unit mass). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv48dbg_time">
<span class="target" id="nsphere_8c_1a5b8302c505609113d15735532f252bb5"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_time</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv48dbg_time" title="Link to this definition"></a><br /></dt>
<dd><p>Simulation time at each snapshot (Myr). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410dbg_radius">
<span class="target" id="nsphere_8c_1a3aa1bbdbd292c666a49c2c0414639c3a"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_radius</span></span></span><span class="p"><span class="pre">[</span></span><span class="n"><span class="pre">DEBUG_MAX_STEPS</span></span><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#_CPPv410dbg_radius" title="Link to this definition"></a><br /></dt>
<dd><p>Particle radius at each snapshot (kpc). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv49dbg_count">
<span class="target" id="nsphere_8c_1aa7285a020bc6f18e415d9537d2cdcfbe"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dbg_count</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv49dbg_count" title="Link to this definition"></a><br /></dt>
<dd><p>Number of debug snapshots recorded. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv413normalization">
<span class="target" id="nsphere_8c_1af30d254aedaf222a8f93118afc67a556"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">normalization</span></span></span><a class="headerlink" href="#_CPPv413normalization" title="Link to this definition"></a><br /></dt>
<dd><p>Mass normalization factor for energy calculations. Calculated based on the integral of the density profile. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv410doReadInit">
<span class="target" id="nsphere_8c_1a65de5bd03df8f31858db0a013fac2455"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doReadInit</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv410doReadInit" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating whether to read initial conditions from file (1=yes, 0=no). </p>
<section id="nsphere_8c_1autotoc_md73">
<h3>FILE I/O AND DATA MANAGEMENT SUBSYSTEM<a class="headerlink" href="#nsphere_8c_1autotoc_md73" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md73">Functions for saving, loading, and managing simulation data including:<ul class="simple">
<li><p>Initial condition generation and I/O</p></li>
<li><p>Snapshot file management</p></li>
<li><p>Binary file format utilities </p></li>
</ul>
</p>
</section>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv411doWriteInit">
<span class="target" id="nsphere_8c_1ad09412fe58e3233624b7877a2cb392fd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">doWriteInit</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">0</span></span><a class="headerlink" href="#_CPPv411doWriteInit" title="Link to this definition"></a><br /></dt>
<dd><p>Flag indicating whether to write initial conditions to file (1=yes, 0=no). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416readInitFilename">
<span class="target" id="nsphere_8c_1a1a5e6187e6eed2330e7c5c2b12ed2104"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">readInitFilename</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv416readInitFilename" title="Link to this definition"></a><br /></dt>
<dd><p>Filename to read initial conditions from (if doReadInit=1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417writeInitFilename">
<span class="target" id="nsphere_8c_1a83025b3961bbc4fee6db755755cd892c"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">writeInitFilename</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">NULL</span></span><a class="headerlink" href="#_CPPv417writeInitFilename" title="Link to this definition"></a><br /></dt>
<dd><p>Filename to write initial conditions to (if doWriteInit=1). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416g_defaultSortAlg">
<span class="target" id="nsphere_8c_1a6941efb3580a570bda2e5720545c0293"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">g_defaultSortAlg</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;quadsort_parallel&quot;</span></span><a class="headerlink" href="#_CPPv416g_defaultSortAlg" title="Link to this definition"></a><br /></dt>
<dd><p>&lt; Default sorting algorithm identifier string. Set based on command-line options. </p>
<section id="nsphere_8c_1autotoc_md81">
<h3>SORTING ALGORITHM CONFIGURATION<a class="headerlink" href="#nsphere_8c_1autotoc_md81" title="Link to this heading"></a></h3>
<span class="target" id="nsphere_8c_1autotoc_md81"></span></section>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv417num_sort_sections">
<span class="target" id="nsphere_8c_1ab7df3ddcd8bf98e2ef09b314afe88eef"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_sort_sections</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">24</span></span><a class="headerlink" href="#_CPPv417num_sort_sections" title="Link to this definition"></a><br /></dt>
<dd><p>Constants and functions controlling the parallel sorting algorithm behavior. </p>
<section id="nsphere_8c_1autotoc_md119">
<h3>PARALLEL SORTING ALGORITHM CONSTANTS AND FUNCTIONS<a class="headerlink" href="#nsphere_8c_1autotoc_md119" title="Link to this heading"></a></h3>
<p id="nsphere_8c_1autotoc_md119">The sorting implementation uses a parallel chunk-based approach with overlapping regions between chunks to ensure correct ordering at chunk boundaries. Number of parallel chunks for sorting. </p>
</section>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv415overlap_divisor">
<span class="target" id="nsphere_8c_1ac3f23a9d96f4a51fd310aa247cbd899f"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">overlap_divisor</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">8</span></span><a class="headerlink" href="#_CPPv415overlap_divisor" title="Link to this definition"></a><br /></dt>
<dd><p>Overlap factor: Overlap = section_size / overlap_divisor. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv416min_seam_overlap">
<span class="target" id="nsphere_8c_1a6c2f5aca324b497e6976ede709e1cf58"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">min_seam_overlap</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">50</span></span><a class="headerlink" href="#_CPPv416min_seam_overlap" title="Link to this definition"></a><br /></dt>
<dd><p>Minimum overlap region size between chunks. </p>
</dd></dl>

</div>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv418fEintegrand_params">
<span class="target" id="structfEintegrand__params"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fEintegrand_params</span></span></span><a class="headerlink" href="#_CPPv418fEintegrand_params" title="Link to this definition"></a><br /></dt>
<dd><p>Parameters for energy integration calculations. </p>
<section id="structfEintegrand__params_1autotoc_md27">
<h3>ENERGY CALCULATION AND INTEGRATION STRUCTURES<a class="headerlink" href="#structfEintegrand__params_1autotoc_md27" title="Link to this heading"></a></h3>
<p id="structfEintegrand__params_1autotoc_md27">Used as <code class="docutils literal notranslate"><span class="pre">void*</span> <span class="pre">params</span></code> argument in GSL integration routines, specifically for distribution function calculations (<code class="docutils literal notranslate"><span class="pre">fEintegrand</span></code>). </p>
</section>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params1EE">
<span class="target" id="structfEintegrand__params_1a8148bf8c4b22bbfd93f59103abc163d6"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params1EE" title="Link to this definition"></a><br /></dt>
<dd><p>Energy value (relative energy). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params9splinePsiE">
<span class="target" id="structfEintegrand__params_1ac2b33746e579217236e1dd75c998c7f2"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">splinePsi</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params9splinePsiE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolation spline for potential Psi(r). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params10splinemassE">
<span class="target" id="structfEintegrand__params_1a08bb5a8a8de6922b3e77425fb03266c9"></span><span class="n"><span class="pre">gsl_spline</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">splinemass</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params10splinemassE" title="Link to this definition"></a><br /></dt>
<dd><p>Interpolation spline for enclosed mass M(r). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params11rofPsiarrayE">
<span class="target" id="structfEintegrand__params_1a1760a14a28a84477a7a3444759efc592"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">rofPsiarray</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params11rofPsiarrayE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for radius lookup from potential r(Psi). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N18fEintegrand_params9massarrayE">
<span class="target" id="structfEintegrand__params_1a45ce775bb086d45e113c2c7106884ace"></span><span class="n"><span class="pre">gsl_interp_accel</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">massarray</span></span></span><a class="headerlink" href="#_CPPv4N18fEintegrand_params9massarrayE" title="Link to this definition"></a><br /></dt>
<dd><p>Accelerator for mass lookups M(r). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49LAndIndex">
<span class="target" id="structLAndIndex"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">LAndIndex</span></span></span><a class="headerlink" href="#_CPPv49LAndIndex" title="Link to this definition"></a><br /></dt>
<dd><p>Structure to track angular momentum with particle index and direction. </p>
<p>Used in sorting and selection of particles by angular momentum, especially when finding particles closest to a reference L. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex1LE">
<span class="target" id="structLAndIndex_1a60d9f7a202ef0503d1115c40b58709da"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">L</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex1LE" title="Link to this definition"></a><br /></dt>
<dd><p>Angular momentum value (or squared difference from Lcompare). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex3idxE">
<span class="target" id="structLAndIndex_1a6138ce671f1ee01ee02e5a498daefddf"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">idx</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex3idxE" title="Link to this definition"></a><br /></dt>
<dd><p>Original particle index (before sorting by L). </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9LAndIndex4signE">
<span class="target" id="structLAndIndex_1a9ca1d244ef4fbe305a2abc2ee9b85f72"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sign</span></span></span><a class="headerlink" href="#_CPPv4N9LAndIndex4signE" title="Link to this definition"></a><br /></dt>
<dd><p>Direction indicator (+1 or -1) or sign of (L - Lcompare). </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv48PartData">
<span class="target" id="structPartData"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">PartData</span></span></span><a class="headerlink" href="#_CPPv48PartData" title="Link to this definition"></a><br /></dt>
<dd><p>Compact data structure for particle properties used in sorting and analysis. </p>
<section id="structPartData_1autotoc_md63">
<h3>PARTICLE DATA STRUCTURES AND OPERATIONS<a class="headerlink" href="#structPartData_1autotoc_md63" title="Link to this heading"></a></h3>
<p id="structPartData_1autotoc_md63">Contains essential physical properties (radial position, velocity, angular momentum) and tracking metadata (rank, original index) for each particle in the simulation. Used extensively for sorting, file I/O, and data analysis operations.</p>
<p></p>
</section>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Uses compact <code class="docutils literal notranslate"><span class="pre">float</span></code> types for physical quantities to reduce memory usage when processing large particle counts. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">rank</span></code> field is assigned during radial sorting, while <code class="docutils literal notranslate"><span class="pre">original_index</span></code> preserves the initial array position for tracking particles across snapshots. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData4rankE">
<span class="target" id="structPartData_1aceb7fe5a7c0942f79e068ce54ee91dcd"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rank</span></span></span><a class="headerlink" href="#_CPPv4N8PartData4rankE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData3radE">
<span class="target" id="structPartData_1a378b215a66fde62b868dbaa582b7e0e2"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rad</span></span></span><a class="headerlink" href="#_CPPv4N8PartData3radE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData4vradE">
<span class="target" id="structPartData_1a9fb91714a8d216cfa0bc8527bc2d24c7"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vrad</span></span></span><a class="headerlink" href="#_CPPv4N8PartData4vradE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData6angmomE">
<span class="target" id="structPartData_1a19c621246e1220d18589f0fc3405bc80"></span><span class="kt"><span class="pre">float</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">angmom</span></span></span><a class="headerlink" href="#_CPPv4N8PartData6angmomE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N8PartData14original_indexE">
<span class="target" id="structPartData_1a03b0004349d68fcc4cf0fa32dace0d98"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">original_index</span></span></span><a class="headerlink" href="#_CPPv4N8PartData14original_indexE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv49RrPsiPair">
<span class="target" id="structRrPsiPair"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RrPsiPair</span></span></span><a class="headerlink" href="#_CPPv49RrPsiPair" title="Link to this definition"></a><br /></dt>
<dd><p>Utility functions and structures for sorting spline data arrays. </p>
<section id="structRrPsiPair_1autotoc_md121">
<h3>SPLINE DATA SORTING UTILITIES<a class="headerlink" href="#structRrPsiPair_1autotoc_md121" title="Link to this heading"></a></h3>
<p id="structRrPsiPair_1autotoc_md121">Provides mechanisms to sort arrays used for GSL spline creation (like radius <code class="docutils literal notranslate"><span class="pre">r</span></code> and potential <code class="docutils literal notranslate"><span class="pre">Psi</span></code>) while maintaining the correct correspondence between paired values after sorting based on one of the arrays (typically radius).</p>
<p>Structure for pairing radius and potential values during sorting.</p>
<p>Used as a temporary structure within <code class="docutils literal notranslate"><span class="pre">sort_rr_psi_arrays</span></code> to maintain the correspondence between radius and potential values when sorting by radius. </p>
</section>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9RrPsiPair2rrE">
<span class="target" id="structRrPsiPair_1ab8518b2772c88f6bafef91f3d8b1bdf8"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rr</span></span></span><a class="headerlink" href="#_CPPv4N9RrPsiPair2rrE" title="Link to this definition"></a><br /></dt>
<dd><p>Radius value. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N9RrPsiPair3psiE">
<span class="target" id="structRrPsiPair_1aee931f7363bc481421578669c2d5663c"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">psi</span></span></span><a class="headerlink" href="#_CPPv4N9RrPsiPair3psiE" title="Link to this definition"></a><br /></dt>
<dd><p>Corresponding potential value. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="nsphere-sort-nsphere-sort-h">
<h2>NSphere Sort (<cite>nsphere_sort.h</cite>)<a class="headerlink" href="#nsphere-sort-nsphere-sort-h" title="Link to this heading"></a></h2>
<p>Clean wrapper for quadsort to suppress warnings and add support for doubles. </p>
<p>This header provides a clean interface to quadsort by:<ol class="arabic simple">
<li><p>Containing all warnings through pragma directives</p></li>
<li><p>Adding support for double and long double types</p></li>
<li><p>Keeping the original quadsort implementation pristine</p></li>
</ol>
</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This wrapper is specifically designed for the NSphere simulation system to ensure consistent sorting behavior across all numerical types. </p>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_array">
<span class="target" id="nsphere__sort_8h_1a3db7cbccd3725443ff37873bc5e9aa70"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_array</span></span></span><a class="headerlink" href="#c.ns_sort_array" title="Link to this definition"></a><br /></dt>
<dd><p>Restore warning settings to their previous state. </p>
<p>Pops the diagnostic pragma stack to restore compiler warning settings that were modified earlier in this header.</p>
<p>Define clean aliases to quadsort functions with zero overhead</p>
<p>These macros provide a consistent naming convention for sorting functions in the NSphere codebase, making it clear which functions are part of the NSphere API rather than direct quadsort calls. </p>
</dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_prim">
<span class="target" id="nsphere__sort_8h_1aaef0e0b6d9656a716d4cbae7855d445b"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_prim</span></span></span><a class="headerlink" href="#c.ns_sort_prim" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_size">
<span class="target" id="nsphere__sort_8h_1afeb553496649ee2b0aebd6068a386c61"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_size</span></span></span><a class="headerlink" href="#c.ns_sort_size" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.ns_sort_extended">
<span class="target" id="nsphere__sort_8h_1a28e85ab689573d5651876f06a1f63b58"></span><span class="sig-name descname"><span class="n"><span class="pre">ns_sort_extended</span></span></span><a class="headerlink" href="#c.ns_sort_extended" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420ns_quadsort_extendedPv6size_t6size_tP7CMPFUNC">
<span class="target" id="nsphere__sort_8h_1a9e16bdd3460662f1127056b02a6a30dd"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ns_quadsort_extended</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv47CMPFUNC" title="CMPFUNC"><span class="n"><span class="pre">CMPFUNC</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420ns_quadsort_extendedPv6size_t6size_tP7CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd><p>Push current warning state and disable specific warnings. </p>
<p>These pragma directives are used to suppress compiler warnings that would otherwise be generated by the quadsort implementation. This allows us to use the original quadsort code without modification.</p>
<p>NSphere extensions to quadsort - Support for double and long double types</p>
<p>These extensions add specialized sorting implementations for floating-point types that may not be efficiently handled by the standard quadsort. They are conditionally compiled based on compiler support.</p>
<p>Extended quadsort function with support for double and long double types</p>
<p>This function extends the standard quadsort implementation to handle double and long double types with specialized implementations. For other types, it falls back to the standard quadsort. This provides optimal performance for all data types used in the NSphere simulation system.</p>
</dd></dl>

</div>
</section>
<section id="quadsort-quadsort-c-quadsort-h">
<h2>QuadSort (<cite>quadsort.c</cite> / <cite>quadsort.h</cite>)<a class="headerlink" href="#quadsort-quadsort-c-quadsort-h" title="Link to this heading"></a></h2>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a2fd687917a3e4713b4f8c60a31340d96"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">parity_swap_four</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1ae04214c8442910e0309cd90f34564dca"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">parity_swap_five</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1ac3d7834d6ed6e05366e5b00b9816609d"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">parity_swap_six</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a0f85d34497fbd00d69a29abb8f5a188b"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">parity_swap_seven</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a7e1fbb09579f1ce378ca88adc7a29bfc"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">tiny_sort</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1ac344843bae446146a03df3d5e6cf8301"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">parity_merge</span> <span class="pre">(VAR</span> <span class="pre">*dest,</span> <span class="pre">VAR</span> <span class="pre">*from,</span> <span class="pre">size_t</span> <span class="pre">left,</span> <span class="pre">size_t</span> <span class="pre">right,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a5ba85012bfbf643882b0fcf6a95b7c44"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">tail_swap</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a66c4d2962268ee0b37159e9546500c88"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">quad_reversal</span> <span class="pre">(VAR</span> <span class="pre">*pta,</span> <span class="pre">VAR</span> <span class="pre">*ptz)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aa6aa4cf127570444335a70ef5debfbea"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">quad_swap_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a84457e61be443f41f95f1d026dda1d8b"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">tail_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aeb473ff051833d4c63444bf20964beed"></span><span class="sig-name descname"><span class="pre">size_t</span> <span class="pre">FUNC()</span> <span class="pre">quad_swap</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a577c5438a6e0a2ef93bd5a82e6bbfba3"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">cross_merge</span> <span class="pre">(VAR</span> <span class="pre">*dest,</span> <span class="pre">VAR</span> <span class="pre">*from,</span> <span class="pre">size_t</span> <span class="pre">left,</span> <span class="pre">size_t</span> <span class="pre">right,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a07922a85919b73c6bcf7312a41f8bd9d"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">quad_merge_block</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a0f803eb494f500429c5a4489088fd7b6"></span><span class="sig-name descname"><span class="pre">size_t</span> <span class="pre">FUNC()</span> <span class="pre">quad_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1ae6531dc89490c2f9b69d82b3e942e248"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">partial_forward_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a2293a35d7265c3ba9d31861213a40202"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">partial_backward_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a7e6e5b2a3d2581d5163540606ea2a9d2"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">trinity_rotation</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">left)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1af3c154a7d3a66d2d834da0b7e38bff6e"></span><span class="sig-name descname"><span class="pre">size_t</span> <span class="pre">FUNC()</span> <span class="pre">monobound_binary_first</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*value,</span> <span class="pre">size_t</span> <span class="pre">top,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a15c434f1a86e0d79e5ec526e707ff236"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">rotate_merge_block</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">lblock,</span> <span class="pre">size_t</span> <span class="pre">right,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a1cd4452fb2b805a636edb1d9d6cefac7"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">rotate_merge</span> <span class="pre">(VAR</span> <span class="pre">*array,</span> <span class="pre">VAR</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">size_t</span> <span class="pre">block,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1a272e6dedcd0e61d12f0567780a3a7097"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">quadsort</span> <span class="pre">(void</span> <span class="pre">*array,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8c_1aa2158e04c3ee1689c224559d35616f54"></span><span class="sig-name descname"><span class="pre">void</span> <span class="pre">FUNC()</span> <span class="pre">quadsort_swap</span> <span class="pre">(void</span> <span class="pre">*array,</span> <span class="pre">void</span> <span class="pre">*swap,</span> <span class="pre">size_t</span> <span class="pre">swap_size,</span> <span class="pre">size_t</span> <span class="pre">nmemb,</span> <span class="pre">CMPFUNC</span> <span class="pre">*cmp)</span></span></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-defines">Defines</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.QUAD_CACHE">
<span class="target" id="quadsort_8h_1a5e74d02deddf7e39e4e23bd350a50773"></span><span class="sig-name descname"><span class="n"><span class="pre">QUAD_CACHE</span></span></span><a class="headerlink" href="#c.QUAD_CACHE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.head_branchless_merge">
<span class="target" id="quadsort_8h_1ab6a4ef28dc5a924a56ee49f610f60578"></span><span class="sig-name descname"><span class="n"><span class="pre">head_branchless_merge</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">ptd</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">ptl</span></span>, <span class="n"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.head_branchless_merge" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.tail_branchless_merge">
<span class="target" id="quadsort_8h_1ac93a172d9b80327b049c81a45ff6325d"></span><span class="sig-name descname"><span class="n"><span class="pre">tail_branchless_merge</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">tpd</span></span>, <span class="n"><span class="pre">y</span></span>, <span class="n"><span class="pre">tpl</span></span>, <span class="n"><span class="pre">tpr</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.tail_branchless_merge" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.parity_merge_two">
<span class="target" id="quadsort_8h_1aa6068467d1b678d3fc4daf57cd643d0e"></span><span class="sig-name descname"><span class="n"><span class="pre">parity_merge_two</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">array</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">ptl</span></span>, <span class="n"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">pts</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.parity_merge_two" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.parity_merge_four">
<span class="target" id="quadsort_8h_1ae3a40694defd9ba8c8bd0b1bf9f47f59"></span><span class="sig-name descname"><span class="n"><span class="pre">parity_merge_four</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">array</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">ptl</span></span>, <span class="n"><span class="pre">ptr</span></span>, <span class="n"><span class="pre">pts</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.parity_merge_four" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.branchless_swap">
<span class="target" id="quadsort_8h_1a2e149c1034b17cf86ed6aa380edbcb96"></span><span class="sig-name descname"><span class="n"><span class="pre">branchless_swap</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">pta</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.branchless_swap" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.swap_branchless">
<span class="target" id="quadsort_8h_1aaa3a20d3df36aa27c32d87e9b3ae91da"></span><span class="sig-name descname"><span class="n"><span class="pre">swap_branchless</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">pta</span></span>, <span class="n"><span class="pre">swap</span></span>, <span class="n"><span class="pre">x</span></span>, <span class="n"><span class="pre">y</span></span>, <span class="n"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.swap_branchless" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.VAR">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><a class="headerlink" href="#c.VAR" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.FUNC">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.FUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp" id="c.cmp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#c.cmp" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a795a8d54876a4363815217ccbf17e2e1"></span><span class="sig-name descname"><span class="n"><span class="pre">cmp</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">a</span></span>, <span class="n"><span class="pre">b</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a5e74d02deddf7e39e4e23bd350a50773"></span><span class="sig-name descname"><span class="n"><span class="pre">QUAD_CACHE</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1abca8dfa78652bc61165262af4fade766"></span><span class="sig-name descname"><span class="n"><span class="pre">VAR</span></span></span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="target" id="quadsort_8h_1a03e0ba20d5ba7c302cc74a126d4c805b"></span><span class="sig-name descname"><span class="n"><span class="pre">FUNC</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">NAME</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-typedefs">Typedefs</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv47CMPFUNC">
<span class="target" id="quadsort_8h_1ac0b079b59789af14bcd472eacba7bf45"></span><span class="k"><span class="pre">typedef</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">CMPFUNC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv47CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv48quadsortPv6size_t6size_tP7CMPFUNC">
<span class="target" id="quadsort_8h_1a88f1effb04be822e96af463ae2d7d14e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv47CMPFUNC" title="CMPFUNC"><span class="n"><span class="pre">CMPFUNC</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv48quadsortPv6size_t6size_tP7CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413quadsort_primPv6size_t6size_t">
<span class="target" id="quadsort_8h_1ae826b3391cde8bae02bd83c1e551ab60"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_prim</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413quadsort_primPv6size_t6size_t" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv413quadsort_sizePv6size_t6size_tP7CMPFUNC">
<span class="target" id="quadsort_8h_1a4d8d3d5451af089533bb46bbbdf5630b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">quadsort_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">array</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">nmemb</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">size</span></span>, <a class="reference internal" href="#_CPPv47CMPFUNC" title="CMPFUNC"><span class="n"><span class="pre">CMPFUNC</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">cmp</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv413quadsort_sizePv6size_t6size_tP7CMPFUNC" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../data_flow/index.html" class="btn btn-neutral float-left" title="Data and Results Flow" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../python_api/index.html" class="btn btn-neutral float-right" title="Python API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Kris Sigurdson.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>